import{a as Dt,b as Et}from"./chunk-7X72VBHV.js";import{a as He,b as Qe,c as Ge,d as bt,e as Pt,f as St,g as yt,h as It}from"./chunk-FEXUPZQG.js";import{a as Tt}from"./chunk-GTLMDP7R.js";import{a as Ot}from"./chunk-LZDPGLQC.js";import{a as Ft}from"./chunk-VE7E4CMI.js";import{a as kt}from"./chunk-RQELFUR7.js";import{h as Mt,i as ke}from"./chunk-ZFOFE4YQ.js";import"./chunk-LUY36RVE.js";import{a as L,b as A,c as le,d as he,e as N,f as _e,g as R,h as Ye,i as we,j as ve}from"./chunk-INS7BFHF.js";import{a as Ke}from"./chunk-H4J6WUUW.js";import{a as Je,b as Xe}from"./chunk-7KCNP7I7.js";import{a as Fe}from"./chunk-MOY26VGU.js";import"./chunk-AJP6ELTP.js";import{a as We}from"./chunk-6WBH7IPC.js";import{b as gt}from"./chunk-EVH4XK5I.js";import{a as ft,c as wt}from"./chunk-LDB6UGBE.js";import{a as xt,b as fe}from"./chunk-YQT2ZH4O.js";import{j as E}from"./chunk-3PMNG65X.js";import{a as G,b as ae,g as W,h as Oe,i as Y,j as J}from"./chunk-4P6JCT6G.js";import{B as Q,C as ge,b as z,d as T,f as F,g as U,h as Se,i as re,j as k,k as se,l as H,m as ht,n as je,o as Be,p as _t,q as vt,r as ze,v as Ct,w as de,x as ye,y as ue,z as Ue}from"./chunk-ESTKDGOR.js";import"./chunk-HU7WFQWJ.js";import{a as D,b as O}from"./chunk-QCGIDFDQ.js";import{a as b,b as ut,c as pe,d as v}from"./chunk-RA5YA7SP.js";import{O as dt}from"./chunk-AE4C5XQ6.js";import{a as qe}from"./chunk-C5RMYWSX.js";import"./chunk-P4ZELJWN.js";import{b as ce,c as ct,d as q,e as ne,f as pt,i as ie}from"./chunk-CG5ODPV4.js";import"./chunk-OQ23N4OO.js";import"./chunk-MB2EZ7OD.js";import{$ as Ve,$a as me,C as et,Ca as it,Db as Me,Eb as be,Fa as Ce,G as ot,Ib as d,Ob as M,P as Ee,Pb as Pe,Rb as X,Sb as Z,T as nt,Tb as n,Ub as i,Vb as m,Xb as P,Zb as g,_b as c,bb as $e,bc as at,cb as l,db as h,dc as ee,ec as te,fa as f,fc as oe,ic as j,jc as s,kc as B,l as Ze,lc as $,ma as w,na as x,pb as _,qc as lt,r as Te,rb as rt,rc as mt,tb as I,wb as C,xb as st}from"./chunk-UUT3EF6T.js";var Lt=(()=>{class o{constructor(){this.snsHttp=f(We),this.userService=f(Fe),this.BASE_URL="/posts/feed",this.loadDate=new Date,this.lastUpdateDate=this.loadDate,this.view="top",this.top=Ce([]),this.top$=this.top.asReadonly(),this.latest=Ce([]),this.latest$=this.latest.asReadonly(),this.follows=Ce([]),this.follows$=this.follows.asReadonly(),this.newTop=Ce([]),this.newTop$=this.newTop.asReadonly(),this.newLatest=Ce([]),this.newLatest$=this.newLatest.asReadonly(),this.newFollows=Ce([]),this.newFollows$=this.newFollows.asReadonly(),this.pages={top:0,latest:0,follows:0},this.scrolls={top:0,latest:0,follows:0},this.loading={top:!1,latest:!1,follows:!1},this.subs=[],this.loading.top=!0,this.loading.latest=!0,this.loading.follows=!0,this.getTop({before:this.loadDate,page:0}).subscribe(e=>{this.top.set(e),this.pages.top=1}).add(()=>this.loading.top=!1),this.getLatest({before:this.loadDate,page:0}).subscribe(e=>{this.latest.set(e),this.pages.latest=1}).add(()=>this.loading.latest=!1),this.getFollows({before:this.loadDate,page:0}).subscribe(e=>{this.follows.set(e),this.pages.follows=1}).add(()=>this.loading.follows=!1)}ngOnDestroy(){for(let e of this.subs)e.unsubscribe()}setView(e){this.view=e}get currentView(){return this.view}loadMore(e){if(!this.loading[e]){var t;switch(e){case"top":t=this.getTop({before:this.loadDate,page:this.pages[e]});break;case"latest":t=this.getLatest({before:this.loadDate,page:this.pages[e]});break;case"follows":t=this.getFollows({before:this.loadDate,page:this.pages[e]});break}this.handleRequest(t,e)}}checkForUpdates(){this.getNewTop({after:this.lastUpdateDate,page:0}).subscribe(e=>{e.length>0&&this.newTop.update(t=>[...e,...t])}),this.getNewLatest({after:this.lastUpdateDate,page:0}).subscribe(e=>{e.length>0&&this.newLatest.update(t=>[...e,...t])}),this.getNewFollows({after:this.lastUpdateDate,page:0}).subscribe(e=>{e.length>0&&this.newFollows.update(t=>[...e,...t])}),this.lastUpdateDate=new Date}showNewPosts(e){switch(e){case"top":this.top.update(t=>[...this.newTop(),...t]),this.newTop.set([]);break;case"latest":this.latest.update(t=>[...this.newLatest(),...t]),this.newLatest.set([]);break;case"follows":this.follows.update(t=>[...this.newFollows(),...t]),this.newFollows.set([]);break}}updateScroll(e,t){switch(e){case"top":this.scrolls[e]=t;break;case"latest":this.scrolls[e]=t;break;case"follows":this.scrolls[e]=t;break}}getScroll(e){switch(e){case"top":return this.scrolls[e];case"latest":return this.scrolls[e];case"follows":return this.scrolls[e]}return 0}getTop(e){return this.get(`${this.BASE_URL}/top?${this.params(e)}`)}getLatest(e){return this.get(`${this.BASE_URL}/latest?${this.params(e)}`)}getFollows(e){return this.get(`${this.BASE_URL}/follows?${this.params(e)}`)}getNewTop(e){return this.get(`${this.BASE_URL}/top/new?${this.params(e)}`)}getNewLatest(e){return this.get(`${this.BASE_URL}/latest/new?${this.params(e)}`)}getNewFollows(e){return this.get(`${this.BASE_URL}/follows/new?${this.params(e)}`)}handleRequest(e,t){let r=this.pages[t];this.loading[t]=!0,e.subscribe({next:a=>{switch(this.pages[t]=r+1,t){case"top":this.top.update(u=>this.appendMorePosts(u,a));break;case"latest":this.latest.update(u=>this.appendMorePosts(u,a));break;case"follows":this.follows.update(u=>this.appendMorePosts(u,a));break}},error:a=>{console.log(a)}}).add(()=>this.loading[t]=!1)}appendMorePosts(e,t){let r=[...e];for(let a of t)r.findIndex(S=>S.id==a.id)<0&&r.push(a);return r}params(e){var t=[];return e.before&&t.push(`before=${e.before}`),e.after&&t.push(`after=${e.after}`),t.push(`page=${e.page}`),t.join("&")}get(e){return this.snsHttp.get$(e)}post(e,t){return this.snsHttp.post$(e,t)}delete(e){return this.snsHttp.delete$(e)}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275prov=Ve({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var tt=(o,p)=>p.id,to=()=>[import("./chunk-45ZZAHW4.js").then(o=>o.AnnouncementComponent),import("./chunk-IHYDWV6G.js").then(o=>o.ArticleComponent),import("./chunk-O4B3Y72W.js").then(o=>o.PictorialComponent),import("./chunk-YAA4BCNK.js").then(o=>o.CommentComponent),import("./chunk-FXNR6NGN.js").then(o=>o.BasicPostComponent)];function oo(o,p){if(o&1){let e=P();n(0,"div",9),g("click",function(){w(e);let r=c(2);return x(r.showNewPosts("top"))}),n(1,"span"),s(2),i()()}if(o&2){let e=c(2);l(2),B("Show "+e.newTop().length+" New Posts")}}function no(o,p){if(o&1&&m(0,"sns-basic-post",10),o&2){let e=c().$implicit,t=c(2);d("post",e)("user",t.me())}}function io(o,p){if(o&1&&m(0,"sns-basic-post",10),o&2){let e=c().$implicit,t=c(2);d("post",e)("user",t.me())}}function ro(o,p){if(o&1&&m(0,"sns-announcement",10),o&2){let e=c().$implicit,t=c(2);d("post",t.announcement(e))("user",t.me())}}function so(o,p){if(o&1&&m(0,"sns-comment",10),o&2){let e=c().$implicit,t=c(2);d("post",t.comment(e))("user",t.me())}}function ao(o,p){if(o&1&&m(0,"sns-pictorial",10),o&2){let e=c().$implicit,t=c(2);d("post",t.pictorial(e))("user",t.me())}}function lo(o,p){if(o&1&&m(0,"sns-article",10),o&2){let e=c().$implicit,t=c(2);d("post",t.article(e))("user",t.me())}}function mo(o,p){if(o&1&&C(0,no,1,2,"sns-basic-post",10)(1,io,1,2,"sns-basic-post",10)(2,ro,1,2,"sns-announcement",10)(3,so,1,2,"sns-comment",10)(4,ao,1,2,"sns-pictorial",10)(5,lo,1,2,"sns-article",10),o&2){let e,t=p.$implicit;M((e=t.type)==="basic"?0:e==="post"?1:e==="announcement"?2:e==="comment"?3:e==="pictorial"?4:e==="article"?5:-1)}}function co(o,p){if(o&1){let e=P();n(0,"div",9),g("click",function(){w(e);let r=c(2);return x(r.showNewPosts("latest"))}),n(1,"span"),s(2),i()()}if(o&2){let e=c(2);l(2),B("Show "+e.newLatest().length+" New Posts")}}function po(o,p){if(o&1&&m(0,"sns-basic-post",10),o&2){let e=c().$implicit,t=c(2);d("post",e)("user",t.me())}}function uo(o,p){if(o&1&&m(0,"sns-basic-post",10),o&2){let e=c().$implicit,t=c(2);d("post",e)("user",t.me())}}function go(o,p){if(o&1&&m(0,"sns-announcement",10),o&2){let e=c().$implicit,t=c(2);d("post",t.announcement(e))("user",t.me())}}function fo(o,p){if(o&1&&m(0,"sns-comment",10),o&2){let e=c().$implicit,t=c(2);d("post",t.comment(e))("user",t.me())}}function ho(o,p){if(o&1&&m(0,"sns-pictorial",10),o&2){let e=c().$implicit,t=c(2);d("post",t.pictorial(e))("user",t.me())}}function _o(o,p){if(o&1&&m(0,"sns-article",10),o&2){let e=c().$implicit,t=c(2);d("post",t.article(e))("user",t.me())}}function vo(o,p){if(o&1&&C(0,po,1,2,"sns-basic-post",10)(1,uo,1,2,"sns-basic-post",10)(2,go,1,2,"sns-announcement",10)(3,fo,1,2,"sns-comment",10)(4,ho,1,2,"sns-pictorial",10)(5,_o,1,2,"sns-article",10),o&2){let e,t=p.$implicit;M((e=t.type)==="basic"?0:e==="post"?1:e==="announcement"?2:e==="comment"?3:e==="pictorial"?4:e==="article"?5:-1)}}function Co(o,p){if(o&1){let e=P();n(0,"div",9),g("click",function(){w(e);let r=c(2);return x(r.showNewPosts("follows"))}),n(1,"span"),s(2),i()()}if(o&2){let e=c(2);l(2),B("Show "+e.newFollows().length+" New Posts")}}function wo(o,p){if(o&1&&m(0,"sns-basic-post",10),o&2){let e=c().$implicit,t=c(2);d("post",e)("user",t.me())}}function xo(o,p){if(o&1&&m(0,"sns-basic-post",10),o&2){let e=c().$implicit,t=c(2);d("post",e)("user",t.me())}}function Mo(o,p){if(o&1&&m(0,"sns-announcement",10),o&2){let e=c().$implicit,t=c(2);d("post",t.announcement(e))("user",t.me())}}function bo(o,p){if(o&1&&m(0,"sns-comment",10),o&2){let e=c().$implicit,t=c(2);d("post",t.comment(e))("user",t.me())}}function Po(o,p){if(o&1&&m(0,"sns-pictorial",10),o&2){let e=c().$implicit,t=c(2);d("post",t.pictorial(e))("user",t.me())}}function So(o,p){if(o&1&&m(0,"sns-article",10),o&2){let e=c().$implicit,t=c(2);d("post",t.article(e))("user",t.me())}}function yo(o,p){if(o&1&&C(0,wo,1,2,"sns-basic-post",10)(1,xo,1,2,"sns-basic-post",10)(2,Mo,1,2,"sns-announcement",10)(3,bo,1,2,"sns-comment",10)(4,Po,1,2,"sns-pictorial",10)(5,So,1,2,"sns-article",10),o&2){let e,t=p.$implicit;M((e=t.type)==="basic"?0:e==="post"?1:e==="announcement"?2:e==="comment"?3:e==="pictorial"?4:e==="article"?5:-1)}}function Oo(o,p){if(o&1&&(n(0,"div",6),C(1,oo,3,1,"div",7),n(2,"div",8),X(3,mo,6,1,null,null,tt),i()(),n(5,"div",6),C(6,co,3,1,"div",7),n(7,"div",8),X(8,vo,6,1,null,null,tt),i()(),n(10,"div",6),C(11,Co,3,1,"div",7),n(12,"div",8),X(13,yo,6,1,null,null,tt),i()()),o&2){let e=c();d("hidden",e.feedView.value!="top"),l(),M(e.newTop().length>0?1:-1),l(2),Z(e.top()),l(2),d("hidden",e.feedView.value!="latest"),l(),M(e.newLatest().length>0?6:-1),l(2),Z(e.latest()),l(2),d("hidden",e.feedView.value!="follows"),l(),M(e.newFollows().length>0?11:-1),l(2),Z(e.follows())}}function Fo(o,p){o&1&&(n(0,"div",11),m(1,"mat-progress-spinner",12),i())}function ko(o,p){o&1&&(n(0,"div"),s(1,"Failed to load posts"),i())}var At=(()=>{class o{constructor(){this.userService=f(Fe),this.feedService=f(Lt),this.feedView=new k("top"),this.throttler=new wt,this.subs=[],this.announcement=bt,this.comment=Pt,this.pictorial=St,this.article=yt,this.me=this.userService.me$,this.top=this.feedService.top$,this.latest=this.feedService.latest$,this.follows=this.feedService.follows$,this.newTop=this.feedService.newTop$,this.newLatest=this.feedService.newLatest$,this.newFollows=this.feedService.newFollows$,this.feedView.setValue(this.feedService.currentView),this.updateChecks=setInterval(()=>{this.feedService.checkForUpdates()},6e4)}ngOnInit(){}ngOnDestroy(){for(let e of this.subs)e.unsubscribe();clearInterval(this.updateChecks)}switchView(e){let t=e.value;switch(t){case"top":this.feedService.setView(t);break;case"latest":this.feedService.setView(t);break;case"follows":this.feedService.setView(t);break}window.scrollTo({top:this.feedService.getScroll(t),behavior:"instant"})}showNewPosts(e){this.feedService.showNewPosts(e)}onScroll(){let e=window.document.documentElement,t=e.scrollHeight-(e.scrollTop+e.offsetHeight);this.feedService.updateScroll(this.feedView.value,e.scrollTop),t<Math.min(2e3,e.scrollHeight*.1)&&this.throttler.throttle(()=>{let r=this.feedView.value;this.feedService.loadMore(r)},3e3)}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275cmp=_({type:o,selectors:[["sns-feed"]],hostBindings:function(t,r){t&1&&g("scroll",function(){return r.onScroll()},!1,$e)},decls:13,vars:3,consts:[[1e3,null],["id","sns-feed"],["value","top",3,"change","formControl"],["value","top",3,"checked"],["value","latest"],["value","follows"],[3,"hidden"],[1,"view-new-posts"],[1,"post-feed"],[1,"view-new-posts",3,"click"],[3,"post","user"],[1,"loading"],["mode","indeterminate"]],template:function(t,r){t&1&&(n(0,"div",1)(1,"mat-button-toggle-group",2),g("change",function(u){return r.switchView(u)}),n(2,"mat-button-toggle",3),s(3,"Top"),i(),n(4,"mat-button-toggle",4),s(5,"Latest"),i(),n(6,"mat-button-toggle",5),s(7,"Follows"),i()(),C(8,Oo,15,6)(9,Fo,2,0)(10,ko,2,0),Me(11,8,to,9,null,10,0,null,st),i()),t&2&&(l(),d("formControl",r.feedView),l(),d("checked",!0),l(9),be(r.me))},dependencies:[O,Ge,He,Qe,v,ft,Mt,gt,ge,F,je],styles:["#sns-feed[_ngcontent-%COMP%]{flex:1;display:flex;flex-flow:column;gap:1rem}mat-button-toggle-group[_ngcontent-%COMP%]{position:sticky;top:0%;width:100%;padding-top:1rem;border:none;border-radius:0;background-color:var(--sns-bg-trans);z-index:100}mat-button-toggle[_ngcontent-%COMP%]{color:var(--sns-text-color);width:100%;border:none!important}.post-feed[_ngcontent-%COMP%]{display:flex;flex-flow:column;gap:1rem}.new-post[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;gap:1rem;align-items:center}.loading[_ngcontent-%COMP%]{flex:1;display:flex;justify-content:center;padding-top:10rem}.view-new-posts[_ngcontent-%COMP%]{font-size:1.1rem;padding:1rem;margin:1rem 0rem 2rem;border:1px solid var(--sns-show-posts-border-color);border-radius:3px}.view-new-posts[_ngcontent-%COMP%]:hover{cursor:pointer;background-color:var(--sns-hover-color)}"]})}}return o})();var Nt=(()=>{class o{constructor(){}ngOnInit(){}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275cmp=_({type:o,selectors:[["sns-home"]],decls:3,vars:0,consts:[["id","sns-home"],[1,"main-content"],[1,"side-content"]],template:function(t,r){t&1&&(n(0,"div",0),m(1,"sns-feed",1)(2,"sns-search",2),i())},dependencies:[At,It],styles:["#sns-home[_ngcontent-%COMP%]{position:relative;display:flex;flex-flow:row nowrap;justify-content:center;width:100%;max-height:100%}@media (max-width:1080px){.main-content[_ngcontent-%COMP%]{min-width:10rem;padding-right:1rem}.side-content[_ngcontent-%COMP%]{flex:0!important;width:0px!important;min-width:0px!important;visibility:collapse}}"]})}}return o})();var V=(()=>{class o{constructor(){this.resourceUrl="/auth",this.http=f(We)}login$(e,t){return this.http.get$(`${this.resourceUrl}/login?username=${e}&password=${t}`)}logout$(){return this.http.get$(`${this.resourceUrl}/logout`)}register$(e,t,r,a){let u={username:e,password:t,displayName:r,questions:a};return this.http.post$(`${this.resourceUrl}/register`,u)}isLoggedIn$(){return this.http.get$(`${this.resourceUrl}/isLoggedIn`).pipe(Te(e=>e.message=="true"))}forgotPassword$(e){return this.http.post$(`${this.resourceUrl}/password/forgot`,e)}resetPassword$(e,t,r,a){let u=this.questionsArrayToMap(a);return this.http.post$(`${this.resourceUrl}/password/reset`,{username:e,newPassword:t,confirmedPassword:r,questions:u})}refresh(){this.http.refreshCsrf()}questionsArrayToMap(e){return e.reduce((t,r)=>(t[r.question]=r.answer,t),{})}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275prov=Ve({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var Vt=(()=>{class o{constructor(e){this.eleRef=e}ngOnInit(){let e=this.eleRef.nativeElement;e.value=this.minNumber,console.log("her",this.minNumber)}onInput(e){let t=this.eleRef.nativeElement;t.value>this.maxNumber&&(t.value=this.maxNumber),t.value<this.minNumber&&(t.value=this.minNumber)}static{this.\u0275fac=function(t){return new(t||o)(h(it))}}static{this.\u0275dir=rt({type:o,selectors:[["","numberBounds",""]],hostBindings:function(t,r){t&1&&g("input",function(u){return r.onInput(u)})},inputs:{minNumber:"minNumber",maxNumber:"maxNumber"}})}}return o})();var Io=["postForm"];function Do(o,p){o&1&&(n(0,"mat-form-field",14)(1,"mat-label"),s(2,"Duration"),i(),m(3,"input",21,4),n(5,"mat-hint",16),s(6,"Number of days (1-180) before the announcement is removed"),i()()),o&2&&(l(3),d("minNumber",1)("maxNumber",180))}var $t=(()=>{class o extends ke{constructor(e,t){super(),this.data=e,this.dialogRef=t,this.announcementService=f(Ot),this.user=e.user}createPost(){let e=new Date,t=this.postForm.value.permanent=="true",r={permanent:t,duration:t?0:this.postForm.value.duration,id:"",title:this.postForm.value.title,content:this.postForm.value.content,author:this.user,views:0,likes:0,comments:0,created_on:e,last_updated_on:e,type:"announcement"};console.log(r);let a=new FormData;a.append("post",new Blob([JSON.stringify(r)],{type:"application/json"})),this.announcementService.newPost$(a).subscribe({next:u=>{console.log(u),this.dialogRef.close({hasPosted:!0,post:u})},error:u=>{console.log(u);let S=u.error.message;S.toLowerCase().includes("one permanent")&&this.toastService.show({type:"danger",source_feature:"sns",header:"Failed to post",body:"You may only have one permanent announcement at a time"}),S.toLowerCase().includes("two announcement")&&this.toastService.show({type:"danger",source_feature:"sns",header:"Failed to post",body:"You may only have two announcements at a time"})}})}close(){this.dialogRef.close({hasPosted:!0})}static{this.\u0275fac=function(t){return new(t||o)(h(A),h(L))}}static{this.\u0275cmp=_({type:o,selectors:[["compose-announcement"]],viewQuery:function(t,r){if(t&1&&ee(Io,5),t&2){let a;te(a=oe())&&(r.postForm=a.first)}},features:[I],decls:42,vars:8,consts:[["postForm","ngForm"],["title",""],["content",""],["permament",""],["duration",""],[1,"compose-post"],[1,"compose-header"],["mat-icon-button","","mat-dialog-close","",1,"compose-cancel"],["fontIcon","close"],[1,"compose-description"],[3,"submit"],[1,"create-post"],[1,"avatar-wrapper"],[1,"avatar",3,"title","src"],["appearance","outline",1,"compose-input"],["name","title","matInput","","ngModel","","maxlength","256","placeholder","Title...","minlength","8","cdkFocusInitial","","required",""],["align","end"],["name","content","rich-input","","matInput","","ngModel","","maxlength","512","placeholder","Announcement content...","required",""],["name","permanent","matSelect","","ngModel","","placeholder","Is Announcement Permament...","required",""],[3,"value"],["type","submit","mat-button","",3,"disabled"],["name","duration","type","number","numberBounds","","matInput","","ngModel","","max","180","placeholder","Duration...","required","",3,"minNumber","maxNumber"]],template:function(t,r){if(t&1){let a=P();n(0,"div",5)(1,"div",6)(2,"button",7),m(3,"mat-icon",8),i(),n(4,"div",9)(5,"span"),s(6,"Creating Announcement"),i()()(),n(7,"form",10,0),g("submit",function(){return w(a),x(r.createPost())}),n(9,"div",11)(10,"div",12),m(11,"img",13),i(),n(12,"mat-dialog-content")(13,"mat-form-field",14)(14,"mat-label"),s(15,"Title"),i(),m(16,"input",15,1),n(18,"mat-hint",16),s(19),i()(),n(20,"mat-form-field",14)(21,"mat-label"),s(22,"Content"),i(),m(23,"textarea",17,2),n(25,"mat-hint",16),s(26),i()(),n(27,"mat-form-field",14)(28,"mat-label"),s(29,"Is Announcement Permament?"),i(),n(30,"mat-select",18,3)(32,"mat-option",19),s(33,"No"),i(),n(34,"mat-option",19),s(35,"Yes"),i()(),n(36,"mat-hint",16),s(37,"You may only have one permament at a time"),i()(),C(38,Do,7,2,"mat-form-field",14),i()(),n(39,"mat-dialog-actions")(40,"button",20),s(41,"Done"),i()()()()}if(t&2){let a=j(8),u=j(17),S=j(24),Re=j(31);l(11),d("title","avatar")("src",r.user.avatar,me),l(8),$("",u.value.length," / 256 (Min: 8)"),l(7),$("",S.value.length," / 512"),l(6),d("value","false"),l(2),d("value","true"),l(4),M(Re.value=="false"?38:-1),l(2),d("disabled",a.invalid)}},dependencies:[Q,H,z,ht,F,U,de,ye,ue,Ct,se,re,Vt,J,Y,W,G,ae,fe,xt,dt,Oe,v,b,pe,O,D,R,he,_e,N],styles:["mat-card-actions[_ngcontent-%COMP%]{justify-content:end;gap:1rem;padding:0rem 1rem}.post[_ngcontent-%COMP%]{color:#000;border-color:var(--sns-post-border-color);border-radius:5px;overflow:hidden;background-color:var(--sns-post-bg-color)}.post[_ngcontent-%COMP%]:hover{cursor:pointer;background-color:var(--sns-hover-color)}.post-title[_ngcontent-%COMP%], .author-identification[_ngcontent-%COMP%], .post-date[_ngcontent-%COMP%], .post-content[_ngcontent-%COMP%], .post-summary[_ngcontent-%COMP%]{color:var(--sns-post-text-color)}.post-title[_ngcontent-%COMP%]{text-wrap:nowrap;text-overflow:ellipsis;overflow:hidden}.author-identification[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;gap:.5rem}.author-displayname[_ngcontent-%COMP%]{text-wrap:nowrap;text-overflow:ellipsis;overflow:hidden}.author-username[_ngcontent-%COMP%]{text-wrap:nowrap;color:var(--sns-username-color)}.post-media[_ngcontent-%COMP%]{max-height:700px;object-fit:cover}.post-action[_ngcontent-%COMP%]{height:1.75rem;box-shadow:none!important;background-color:transparent;color:var(--sns-post-text-color)}.post-action[_ngcontent-%COMP%]:hover{scale:1.05}.action-like[_ngcontent-%COMP%]{color:var(--sns-like-post-color)}.action-comment[_ngcontent-%COMP%]{color:var(--sns-comment-post-color)}.post-date[_ngcontent-%COMP%]{flex:1;justify-self:end;text-align:end;text-wrap:nowrap}.post-categories[_ngcontent-%COMP%]{flex:1;font-size:.9rem;display:flex;flex-flow:row nowrap;gap:.5rem;text-overflow:ellipsis}.post-categories[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.post-purpose[_ngcontent-%COMP%], .post-topic[_ngcontent-%COMP%], .post-mood[_ngcontent-%COMP%]{padding:.2rem;border:1px solid rgba(0,0,0,35%);border-radius:.3rem}.post-purpose[_ngcontent-%COMP%]{background-color:var(--sns-post-purpose-color)}.post-topic[_ngcontent-%COMP%]{background-color:var(--sns-post-topic-color)}.post-mood[_ngcontent-%COMP%]{background-color:var(--sns-post-mood-color)}.post-footer[_ngcontent-%COMP%]{padding-top:1rem;padding-bottom:.5rem}@media (max-width:1080px){.post-title[_ngcontent-%COMP%]{font-size:1.25rem}.author-identification[_ngcontent-%COMP%], .post-date[_ngcontent-%COMP%]{font-size:.9rem}.post-content[_ngcontent-%COMP%], .post-summary[_ngcontent-%COMP%]{font-size:1rem}.post-action[_ngcontent-%COMP%]{padding:.25rem}}.compose-post[_ngcontent-%COMP%]{--avatar-size: 3rem;min-width:30rem;border-radius:0rem!important}.compose-header[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;justify-content:space-between;align-items:center;padding:.1rem 0rem}.compose-cancel[_ngcontent-%COMP%]{margin:0rem .25rem}.compose-cancel[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-bottom:5px}.compose-description[_ngcontent-%COMP%]{margin:0rem 1rem}.create-post[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;gap:.5rem;align-items:start;padding:.5rem}.avatar-wrapper[_ngcontent-%COMP%]{position:relative;float:left;flex-shrink:0;width:var(--avatar-size);height:var(--avatar-size);margin-top:.75rem;border-radius:100%;overflow:hidden}.avatar[_ngcontent-%COMP%]{width:var(--avatar-size);height:var(--avatar-size);object-fit:cover}.compose-input[_ngcontent-%COMP%]{width:100%}.upload-media[_ngcontent-%COMP%]{position:relative;margin-right:auto}.add-file-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:0px;width:0px;overflow:hidden}.upload-label[_ngcontent-%COMP%]:hover{cursor:pointer;scale:1.05}.selected-media-list[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;gap:.5rem}.selected-media[_ngcontent-%COMP%]{position:relative}.selected-media-media[_ngcontent-%COMP%]{height:150px;border:1px solid;border-radius:3px}.remove-media[_ngcontent-%COMP%]{position:absolute;top:.1rem;right:.1rem;border-radius:100%;background-color:#00000080}.remove-media[_ngcontent-%COMP%]:hover{background-color:#00000059}.remove-media[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{color:red}mat-dialog-content[_ngcontent-%COMP%]{padding:1rem .75rem .25rem!important}mat-dialog-actions[_ngcontent-%COMP%]{padding-top:.25rem!important}@media (max-width:32rem){.compose-post[_ngcontent-%COMP%]{min-width:unset;width:400px}}"]})}}return o})();var To=["postForm"];function Eo(o,p){o&1&&(n(0,"div",14),s(1,"Pictorials require 1 or more media attachments"),i())}function Lo(o,p){if(o&1){let e=P();n(0,"div",16)(1,"div",22)(2,"button",23),g("click",function(){let r=w(e),a=r.$implicit,u=r.$index,S=c();return x(S.removeMedia(a,u))}),m(3,"mat-icon",5),i()(),m(4,"img",24),i()}if(o&2){let e=p.$implicit;l(4),d("src",e.data,me)}}var qt=(()=>{class o extends ke{constructor(e,t){super(),this.data=e,this.dialogRef=t,this.postService=f(Ft),this.user=e.user}createPost(){let e=new Date,t={id:"",title:this.postForm.value.title,content:this.postForm.value.content,author:this.user,views:0,likes:0,comments:0,created_on:e,last_updated_on:e,type:"pictorial"};console.log(t);let r=new FormData;r.append("post",new Blob([JSON.stringify(t)],{type:"application/json"}));for(let a of this.media)r.append("media",a);this.postService.newPost$(r).subscribe({next:a=>{console.log(a),this.dialogRef.close({hasPosted:!0,post:a})},error:a=>{console.log(a);let u=a.error.message;this.toastService.show({type:"danger",source_feature:"sns",header:"Failed to post"})}})}close(){this.dialogRef.close({hasPosted:!0})}get invalidMediaCount(){return this.media.length<1||9<this.media.length}static{this.\u0275fac=function(t){return new(t||o)(h(A),h(L))}}static{this.\u0275cmp=_({type:o,selectors:[["compose-pictorial"]],viewQuery:function(t,r){if(t&1&&ee(To,5),t&2){let a;te(a=oe())&&(r.postForm=a.first)}},features:[I],decls:31,vars:6,consts:[["postForm","ngForm"],["title",""],[1,"compose-post"],[1,"compose-header"],["mat-icon-button","","mat-dialog-close","",1,"compose-cancel"],["fontIcon","close"],[1,"compose-description"],[3,"submit"],[1,"create-post"],[1,"avatar-wrapper"],[1,"avatar",3,"title","src"],["appearance","outline",1,"compose-input"],["name","title","matInput","","ngModel","","maxlength","256","placeholder","Title...","minlength","8","cdkFocusInitial","","required",""],["align","end"],[1,"hint-error"],[1,"selected-media-list"],[1,"selected-media"],["title","Add Media",1,"upload-media"],["for","add-image"],["fontIcon","image",1,"upload-label"],["id","add-image","type","file",1,"add-file-image",3,"change","accept"],["type","submit","mat-button","",3,"disabled"],[1,"remove-media"],["mat-icon-button","","title","Remove Media",3,"click"],[1,"selected-media-media",3,"src"]],template:function(t,r){if(t&1){let a=P();n(0,"div",2)(1,"div",3)(2,"button",4),m(3,"mat-icon",5),i(),n(4,"div",6)(5,"span"),s(6,"Creating Pictorial"),i()()(),n(7,"form",7,0),g("submit",function(){return w(a),x(r.createPost())}),n(9,"div",8)(10,"div",9),m(11,"img",10),i(),n(12,"mat-dialog-content")(13,"mat-form-field",11)(14,"mat-label"),s(15,"Title"),i(),m(16,"input",12,1),n(18,"mat-hint",13),s(19),i()(),C(20,Eo,2,0,"div",14),n(21,"div",15),X(22,Lo,5,1,"div",16,Pe),i()()(),n(24,"mat-dialog-actions")(25,"div",17)(26,"label",18),m(27,"mat-icon",19),i(),n(28,"input",20),g("change",function(S){return w(a),x(r.addMedia(S))}),i()(),n(29,"button",21),s(30,"Done"),i()()()()}if(t&2){let a=j(8),u=j(17);l(11),d("title","avatar")("src",r.user.avatar,me),l(8),$("",u.value.length," / 256 (Min: 8)"),l(),M(r.invalidMediaCount?20:-1),l(2),Z(r.selectedMedia),l(6),d("accept",r.validMediaTypes),l(),d("disabled",a.invalid||r.invalidMediaCount)}},dependencies:[Q,H,z,F,U,de,ye,ue,se,re,J,Y,W,G,ae,fe,Oe,v,b,pe,O,D,R,he,_e,N],styles:["mat-card-actions[_ngcontent-%COMP%]{justify-content:end;gap:1rem;padding:0rem 1rem}.post[_ngcontent-%COMP%]{color:#000;border-color:var(--sns-post-border-color);border-radius:5px;overflow:hidden;background-color:var(--sns-post-bg-color)}.post[_ngcontent-%COMP%]:hover{cursor:pointer;background-color:var(--sns-hover-color)}.post-title[_ngcontent-%COMP%], .author-identification[_ngcontent-%COMP%], .post-date[_ngcontent-%COMP%], .post-content[_ngcontent-%COMP%], .post-summary[_ngcontent-%COMP%]{color:var(--sns-post-text-color)}.post-title[_ngcontent-%COMP%]{text-wrap:nowrap;text-overflow:ellipsis;overflow:hidden}.author-identification[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;gap:.5rem}.author-displayname[_ngcontent-%COMP%]{text-wrap:nowrap;text-overflow:ellipsis;overflow:hidden}.author-username[_ngcontent-%COMP%]{text-wrap:nowrap;color:var(--sns-username-color)}.post-media[_ngcontent-%COMP%]{max-height:700px;object-fit:cover}.post-action[_ngcontent-%COMP%]{height:1.75rem;box-shadow:none!important;background-color:transparent;color:var(--sns-post-text-color)}.post-action[_ngcontent-%COMP%]:hover{scale:1.05}.action-like[_ngcontent-%COMP%]{color:var(--sns-like-post-color)}.action-comment[_ngcontent-%COMP%]{color:var(--sns-comment-post-color)}.post-date[_ngcontent-%COMP%]{flex:1;justify-self:end;text-align:end;text-wrap:nowrap}.post-categories[_ngcontent-%COMP%]{flex:1;font-size:.9rem;display:flex;flex-flow:row nowrap;gap:.5rem;text-overflow:ellipsis}.post-categories[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.post-purpose[_ngcontent-%COMP%], .post-topic[_ngcontent-%COMP%], .post-mood[_ngcontent-%COMP%]{padding:.2rem;border:1px solid rgba(0,0,0,35%);border-radius:.3rem}.post-purpose[_ngcontent-%COMP%]{background-color:var(--sns-post-purpose-color)}.post-topic[_ngcontent-%COMP%]{background-color:var(--sns-post-topic-color)}.post-mood[_ngcontent-%COMP%]{background-color:var(--sns-post-mood-color)}.post-footer[_ngcontent-%COMP%]{padding-top:1rem;padding-bottom:.5rem}@media (max-width:1080px){.post-title[_ngcontent-%COMP%]{font-size:1.25rem}.author-identification[_ngcontent-%COMP%], .post-date[_ngcontent-%COMP%]{font-size:.9rem}.post-content[_ngcontent-%COMP%], .post-summary[_ngcontent-%COMP%]{font-size:1rem}.post-action[_ngcontent-%COMP%]{padding:.25rem}}.compose-post[_ngcontent-%COMP%]{--avatar-size: 3rem;min-width:30rem;border-radius:0rem!important}.compose-header[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;justify-content:space-between;align-items:center;padding:.1rem 0rem}.compose-cancel[_ngcontent-%COMP%]{margin:0rem .25rem}.compose-cancel[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-bottom:5px}.compose-description[_ngcontent-%COMP%]{margin:0rem 1rem}.create-post[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;gap:.5rem;align-items:start;padding:.5rem}.avatar-wrapper[_ngcontent-%COMP%]{position:relative;float:left;flex-shrink:0;width:var(--avatar-size);height:var(--avatar-size);margin-top:.75rem;border-radius:100%;overflow:hidden}.avatar[_ngcontent-%COMP%]{width:var(--avatar-size);height:var(--avatar-size);object-fit:cover}.compose-input[_ngcontent-%COMP%]{width:100%}.upload-media[_ngcontent-%COMP%]{position:relative;margin-right:auto}.add-file-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:0px;width:0px;overflow:hidden}.upload-label[_ngcontent-%COMP%]:hover{cursor:pointer;scale:1.05}.selected-media-list[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;gap:.5rem}.selected-media[_ngcontent-%COMP%]{position:relative}.selected-media-media[_ngcontent-%COMP%]{height:150px;border:1px solid;border-radius:3px}.remove-media[_ngcontent-%COMP%]{position:absolute;top:.1rem;right:.1rem;border-radius:100%;background-color:#00000080}.remove-media[_ngcontent-%COMP%]:hover{background-color:#00000059}.remove-media[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{color:red}mat-dialog-content[_ngcontent-%COMP%]{padding:1rem .75rem .25rem!important}mat-dialog-actions[_ngcontent-%COMP%]{padding-top:.25rem!important}@media (max-width:32rem){.compose-post[_ngcontent-%COMP%]{min-width:unset;width:400px}}.hint-error[_ngcontent-%COMP%]{color:red}"]})}}return o})();var Ao=["postForm"];function No(o,p){if(o&1){let e=P();n(0,"div",17)(1,"div",23)(2,"button",24),g("click",function(){let r=w(e),a=r.$implicit,u=r.$index,S=c();return x(S.removeMedia(a,u))}),m(3,"mat-icon",6),i()(),m(4,"img",25),i()}if(o&2){let e=p.$implicit;l(4),d("src",e.data,me)}}var jt=(()=>{class o extends ke{constructor(e,t){super(),this.data=e,this.dialogRef=t,this.postService=f(kt),this.user=e.user}createPost(){let e=new Date,t={id:"",title:this.postForm.value.title,content:this.postForm.value.content,author:this.user,views:0,likes:0,comments:0,created_on:e,last_updated_on:e,type:"post"};console.log(t);let r=new FormData;r.append("post",new Blob([JSON.stringify(t)],{type:"application/json"})),r.append("media",this.media[0]),this.postService.newPost$(r).subscribe({next:a=>{console.log(a),this.dialogRef.close({hasPosted:!0,post:a})},error:a=>{console.log(a);let u=a.error.message;this.toastService.show({type:"danger",source_feature:"sns",header:"Failed to post"})}})}addMedia(e){this.selectedMedia.length=0,this.media.length=0,super.addMedia(e)}close(){this.dialogRef.close({hasPosted:!0})}static{this.\u0275fac=function(t){return new(t||o)(h(A),h(L))}}static{this.\u0275cmp=_({type:o,selectors:[["compose-post"]],viewQuery:function(t,r){if(t&1&&ee(Ao,5),t&2){let a;te(a=oe())&&(r.postForm=a.first)}},features:[I],decls:37,vars:6,consts:[["postForm","ngForm"],["title",""],["content",""],[1,"compose-post"],[1,"compose-header"],["mat-icon-button","","mat-dialog-close","",1,"compose-cancel"],["fontIcon","close"],[1,"compose-description"],[3,"submit"],[1,"create-post"],[1,"avatar-wrapper"],[1,"avatar",3,"title","src"],["appearance","outline",1,"compose-input"],["name","title","matInput","","ngModel","","maxlength","256","placeholder","Title...","minlength","8","cdkFocusInitial","","required",""],["align","end"],["name","content","rich-input","","matInput","","ngModel","","maxlength","512","placeholder","Post content...","required",""],[1,"selected-media-list"],[1,"selected-media"],["title","Add Media",1,"upload-media"],["for","add-image"],["fontIcon","image",1,"upload-label"],["id","add-image","type","file",1,"add-file-image",3,"change","accept"],["type","submit","mat-button","",3,"disabled"],[1,"remove-media"],["mat-icon-button","","title","Remove Media",3,"click"],[1,"selected-media-media",3,"src"]],template:function(t,r){if(t&1){let a=P();n(0,"div",3)(1,"div",4)(2,"button",5),m(3,"mat-icon",6),i(),n(4,"div",7)(5,"span"),s(6,"Creating Post"),i()()(),n(7,"form",8,0),g("submit",function(){return w(a),x(r.createPost())}),n(9,"div",9)(10,"div",10),m(11,"img",11),i(),n(12,"mat-dialog-content")(13,"mat-form-field",12)(14,"mat-label"),s(15,"Title"),i(),m(16,"input",13,1),n(18,"mat-hint",14),s(19),i()(),n(20,"mat-form-field",12)(21,"mat-label"),s(22,"Content"),i(),m(23,"textarea",15,2),n(25,"mat-hint",14),s(26),i()(),n(27,"div",16),X(28,No,5,1,"div",17,Pe),i()()(),n(30,"mat-dialog-actions")(31,"div",18)(32,"label",19),m(33,"mat-icon",20),i(),n(34,"input",21),g("change",function(S){return w(a),x(r.addMedia(S))}),i()(),n(35,"button",22),s(36,"Done"),i()()()()}if(t&2){let a=j(8),u=j(17),S=j(24);l(11),d("title","avatar")("src",r.user.avatar,me),l(8),$("",u.value.length," / 256 (Min: 8)"),l(7),$("",S.value.length," / 512"),l(2),Z(r.selectedMedia),l(6),d("accept",r.validMediaTypes),l(),d("disabled",a.invalid)}},dependencies:[Q,H,z,F,U,de,ye,ue,se,re,J,Y,W,G,ae,fe,Oe,v,b,pe,O,D,R,he,_e,N],styles:["mat-card-actions[_ngcontent-%COMP%]{justify-content:end;gap:1rem;padding:0rem 1rem}.post[_ngcontent-%COMP%]{color:#000;border-color:var(--sns-post-border-color);border-radius:5px;overflow:hidden;background-color:var(--sns-post-bg-color)}.post[_ngcontent-%COMP%]:hover{cursor:pointer;background-color:var(--sns-hover-color)}.post-title[_ngcontent-%COMP%], .author-identification[_ngcontent-%COMP%], .post-date[_ngcontent-%COMP%], .post-content[_ngcontent-%COMP%], .post-summary[_ngcontent-%COMP%]{color:var(--sns-post-text-color)}.post-title[_ngcontent-%COMP%]{text-wrap:nowrap;text-overflow:ellipsis;overflow:hidden}.author-identification[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;gap:.5rem}.author-displayname[_ngcontent-%COMP%]{text-wrap:nowrap;text-overflow:ellipsis;overflow:hidden}.author-username[_ngcontent-%COMP%]{text-wrap:nowrap;color:var(--sns-username-color)}.post-media[_ngcontent-%COMP%]{max-height:700px;object-fit:cover}.post-action[_ngcontent-%COMP%]{height:1.75rem;box-shadow:none!important;background-color:transparent;color:var(--sns-post-text-color)}.post-action[_ngcontent-%COMP%]:hover{scale:1.05}.action-like[_ngcontent-%COMP%]{color:var(--sns-like-post-color)}.action-comment[_ngcontent-%COMP%]{color:var(--sns-comment-post-color)}.post-date[_ngcontent-%COMP%]{flex:1;justify-self:end;text-align:end;text-wrap:nowrap}.post-categories[_ngcontent-%COMP%]{flex:1;font-size:.9rem;display:flex;flex-flow:row nowrap;gap:.5rem;text-overflow:ellipsis}.post-categories[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.post-purpose[_ngcontent-%COMP%], .post-topic[_ngcontent-%COMP%], .post-mood[_ngcontent-%COMP%]{padding:.2rem;border:1px solid rgba(0,0,0,35%);border-radius:.3rem}.post-purpose[_ngcontent-%COMP%]{background-color:var(--sns-post-purpose-color)}.post-topic[_ngcontent-%COMP%]{background-color:var(--sns-post-topic-color)}.post-mood[_ngcontent-%COMP%]{background-color:var(--sns-post-mood-color)}.post-footer[_ngcontent-%COMP%]{padding-top:1rem;padding-bottom:.5rem}@media (max-width:1080px){.post-title[_ngcontent-%COMP%]{font-size:1.25rem}.author-identification[_ngcontent-%COMP%], .post-date[_ngcontent-%COMP%]{font-size:.9rem}.post-content[_ngcontent-%COMP%], .post-summary[_ngcontent-%COMP%]{font-size:1rem}.post-action[_ngcontent-%COMP%]{padding:.25rem}}.compose-post[_ngcontent-%COMP%]{--avatar-size: 3rem;min-width:30rem;border-radius:0rem!important}.compose-header[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;justify-content:space-between;align-items:center;padding:.1rem 0rem}.compose-cancel[_ngcontent-%COMP%]{margin:0rem .25rem}.compose-cancel[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-bottom:5px}.compose-description[_ngcontent-%COMP%]{margin:0rem 1rem}.create-post[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;gap:.5rem;align-items:start;padding:.5rem}.avatar-wrapper[_ngcontent-%COMP%]{position:relative;float:left;flex-shrink:0;width:var(--avatar-size);height:var(--avatar-size);margin-top:.75rem;border-radius:100%;overflow:hidden}.avatar[_ngcontent-%COMP%]{width:var(--avatar-size);height:var(--avatar-size);object-fit:cover}.compose-input[_ngcontent-%COMP%]{width:100%}.upload-media[_ngcontent-%COMP%]{position:relative;margin-right:auto}.add-file-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:0px;width:0px;overflow:hidden}.upload-label[_ngcontent-%COMP%]:hover{cursor:pointer;scale:1.05}.selected-media-list[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;gap:.5rem}.selected-media[_ngcontent-%COMP%]{position:relative}.selected-media-media[_ngcontent-%COMP%]{height:150px;border:1px solid;border-radius:3px}.remove-media[_ngcontent-%COMP%]{position:absolute;top:.1rem;right:.1rem;border-radius:100%;background-color:#00000080}.remove-media[_ngcontent-%COMP%]:hover{background-color:#00000059}.remove-media[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{color:red}mat-dialog-content[_ngcontent-%COMP%]{padding:1rem .75rem .25rem!important}mat-dialog-actions[_ngcontent-%COMP%]{padding-top:.25rem!important}@media (max-width:32rem){.compose-post[_ngcontent-%COMP%]{min-width:unset;width:400px}}"]})}}return o})();var Bt=(()=>{class o extends ve{constructor(e,t){super(),this.data=e,this.dialogRef=t,this.feedView=new k("basic"),this.dialog=f(le),this.user=e.user}ngOnInit(){}startComposition(){var e;switch(this.feedView.value){case"basic":e=this.dialog.open(jt,{scrollStrategy:new E,data:{user:this.user}});break;case"announcement":e=this.dialog.open($t,{scrollStrategy:new E,data:{user:this.user}});break;case"pictorial":e=this.dialog.open(qt,{scrollStrategy:new E,data:{user:this.user}});break}e&&e.afterClosed().pipe(ot(1)).subscribe(t=>{t.hasPosted?this.dialogRef.close({hasPosted:t.hasPosted,post:t.post}):this.dialogRef.close({hasPosted:t.hasPosted})})}close(){this.dialogRef.close({hasPosted:!1})}static{this.\u0275fac=function(t){return new(t||o)(h(A),h(L))}}static{this.\u0275cmp=_({type:o,selectors:[["choose-compose"]],features:[I],decls:19,vars:3,consts:[[1,"compose-post"],[1,"compose-header"],["mat-icon-button","","mat-dialog-close","",1,"compose-cancel"],["fontIcon","close"],[1,"compose-description"],[1,"create-post"],["value","basic",3,"formControl"],["value","basic",3,"checked"],["value","announcement"],["value","pictorial"],["type","submit","mat-button","",3,"click","disabled"]],template:function(t,r){t&1&&(n(0,"div",0)(1,"div",1)(2,"button",2),m(3,"mat-icon",3),i(),n(4,"div",4)(5,"span"),s(6,"Choose Type of Post"),i()()(),n(7,"div",5)(8,"mat-dialog-content")(9,"mat-button-toggle-group",6)(10,"mat-button-toggle",7),s(11,"Basic"),i(),n(12,"mat-button-toggle",8),s(13,"Announcement"),i(),n(14,"mat-button-toggle",9),s(15,"Pictorial"),i()()()(),n(16,"mat-dialog-actions")(17,"button",10),g("click",function(){return r.startComposition()}),s(18,"Start Composing"),i()()()),t&2&&(l(9),d("formControl",r.feedView),l(),d("checked",!0),l(7),d("disabled",r.feedView.invalid))},dependencies:[ge,F,je,v,b,pe,O,D,Ge,He,Qe,R,he,_e,N],styles:["mat-card-actions[_ngcontent-%COMP%]{justify-content:end;gap:1rem;padding:0rem 1rem}.post[_ngcontent-%COMP%]{color:#000;border-color:var(--sns-post-border-color);border-radius:5px;overflow:hidden;background-color:var(--sns-post-bg-color)}.post[_ngcontent-%COMP%]:hover{cursor:pointer;background-color:var(--sns-hover-color)}.post-title[_ngcontent-%COMP%], .author-identification[_ngcontent-%COMP%], .post-date[_ngcontent-%COMP%], .post-content[_ngcontent-%COMP%], .post-summary[_ngcontent-%COMP%]{color:var(--sns-post-text-color)}.post-title[_ngcontent-%COMP%]{text-wrap:nowrap;text-overflow:ellipsis;overflow:hidden}.author-identification[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;gap:.5rem}.author-displayname[_ngcontent-%COMP%]{text-wrap:nowrap;text-overflow:ellipsis;overflow:hidden}.author-username[_ngcontent-%COMP%]{text-wrap:nowrap;color:var(--sns-username-color)}.post-media[_ngcontent-%COMP%]{max-height:700px;object-fit:cover}.post-action[_ngcontent-%COMP%]{height:1.75rem;box-shadow:none!important;background-color:transparent;color:var(--sns-post-text-color)}.post-action[_ngcontent-%COMP%]:hover{scale:1.05}.action-like[_ngcontent-%COMP%]{color:var(--sns-like-post-color)}.action-comment[_ngcontent-%COMP%]{color:var(--sns-comment-post-color)}.post-date[_ngcontent-%COMP%]{flex:1;justify-self:end;text-align:end;text-wrap:nowrap}.post-categories[_ngcontent-%COMP%]{flex:1;font-size:.9rem;display:flex;flex-flow:row nowrap;gap:.5rem;text-overflow:ellipsis}.post-categories[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.post-purpose[_ngcontent-%COMP%], .post-topic[_ngcontent-%COMP%], .post-mood[_ngcontent-%COMP%]{padding:.2rem;border:1px solid rgba(0,0,0,35%);border-radius:.3rem}.post-purpose[_ngcontent-%COMP%]{background-color:var(--sns-post-purpose-color)}.post-topic[_ngcontent-%COMP%]{background-color:var(--sns-post-topic-color)}.post-mood[_ngcontent-%COMP%]{background-color:var(--sns-post-mood-color)}.post-footer[_ngcontent-%COMP%]{padding-top:1rem;padding-bottom:.5rem}@media (max-width:1080px){.post-title[_ngcontent-%COMP%]{font-size:1.25rem}.author-identification[_ngcontent-%COMP%], .post-date[_ngcontent-%COMP%]{font-size:.9rem}.post-content[_ngcontent-%COMP%], .post-summary[_ngcontent-%COMP%]{font-size:1rem}.post-action[_ngcontent-%COMP%]{padding:.25rem}}.compose-post[_ngcontent-%COMP%]{--avatar-size: 3rem;min-width:30rem;border-radius:0rem!important}.compose-header[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;justify-content:space-between;align-items:center;padding:.1rem 0rem}.compose-cancel[_ngcontent-%COMP%]{margin:0rem .25rem}.compose-cancel[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-bottom:5px}.compose-description[_ngcontent-%COMP%]{margin:0rem 1rem}.create-post[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;gap:.5rem;align-items:start;padding:.5rem}.avatar-wrapper[_ngcontent-%COMP%]{position:relative;float:left;flex-shrink:0;width:var(--avatar-size);height:var(--avatar-size);margin-top:.75rem;border-radius:100%;overflow:hidden}.avatar[_ngcontent-%COMP%]{width:var(--avatar-size);height:var(--avatar-size);object-fit:cover}.compose-input[_ngcontent-%COMP%]{width:100%}.upload-media[_ngcontent-%COMP%]{position:relative;margin-right:auto}.add-file-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:0px;width:0px;overflow:hidden}.upload-label[_ngcontent-%COMP%]:hover{cursor:pointer;scale:1.05}.selected-media-list[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;gap:.5rem}.selected-media[_ngcontent-%COMP%]{position:relative}.selected-media-media[_ngcontent-%COMP%]{height:150px;border:1px solid;border-radius:3px}.remove-media[_ngcontent-%COMP%]{position:absolute;top:.1rem;right:.1rem;border-radius:100%;background-color:#00000080}.remove-media[_ngcontent-%COMP%]:hover{background-color:#00000059}.remove-media[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{color:red}mat-dialog-content[_ngcontent-%COMP%]{padding:1rem .75rem .25rem!important}mat-dialog-actions[_ngcontent-%COMP%]{padding-top:.25rem!important}@media (max-width:32rem){.compose-post[_ngcontent-%COMP%]{min-width:unset;width:400px}}mat-button-toggle-group[_ngcontent-%COMP%]{width:100%;padding-bottom:1rem;border:none;border-radius:0;background-color:var(--sns-bg-trans);z-index:100}mat-button-toggle[_ngcontent-%COMP%]{color:var(--sns-text-color);width:100%;border:none!important}"]})}}return o})();var zt=(()=>{class o extends ve{constructor(e,t){super(),this.data=e,this.dialogRef=t,this.authService=f(V),this.hasLoggedOut=!1}ngOnInit(){}logout(){this.authService.logout$().pipe(Ee(3)).subscribe({next:e=>{console.log(e),this.hasLoggedOut=!0,this.router.navigate(["/sns/logout"])},error:e=>{console.log(e)}})}close(){this.dialogRef.close({hasLoggedOut:this.hasLoggedOut})}static{this.\u0275fac=function(t){return new(t||o)(h(A),h(L))}}static{this.\u0275cmp=_({type:o,selectors:[["logout-promt"]],features:[I],decls:13,vars:0,consts:[[1,"logout-prompt"],[1,"logout-prompt-header"],[1,"logout-prompt-content"],["mat-flat-button","",1,"return-btn",3,"click"]],template:function(t,r){t&1&&(n(0,"div",0)(1,"div",1)(2,"div")(3,"h5"),s(4,"Logout"),i()()(),n(5,"mat-dialog-content")(6,"div",2)(7,"div"),s(8,"Are you sure you wish to logout?"),i(),n(9,"button",3),g("click",function(){return r.logout()}),s(10,"Logout"),i(),n(11,"button",3),g("click",function(){return r.close()}),s(12,"Cancel"),i()()()())},dependencies:[R,N,v,b],styles:[".logout-prompt[_ngcontent-%COMP%]{padding:1rem 0rem;box-sizing:border-box}.logout-prompt-header[_ngcontent-%COMP%]{padding:0rem 1rem;border-bottom:1px solid rgba(30,30,30,.5)}.logout-prompt-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem;font-size:1.25rem;text-align:center}.return-btn[_ngcontent-%COMP%]{border-radius:3px}"]})}}return o})();var Ut=(()=>{class o{constructor(e,t){this.router=e,this.route=t,this.width=window.innerWidth}ngOnInit(){}toProfile(){window.getSelection()?.toString().length==0&&this.router.navigate([this.user.username],{relativeTo:this.route.parent})}get avatarSize(){return this.width<1295?"4rem":"5rem"}get avatarOverrides(){let e={};return this.width<1295&&(e["justify-self"]="center"),e}onResize(){this.width=window.innerWidth}static{this.\u0275fac=function(t){return new(t||o)(h(q),h(ce))}}static{this.\u0275cmp=_({type:o,selectors:[["sns-user-summary"]],hostBindings:function(t,r){t&1&&g("resize",function(){return r.onResize()},!1,$e)},inputs:{user:"user"},decls:21,vars:9,consts:[[1,"user-summary"],[1,"avatar-name",3,"click"],[1,"avatar",3,"username","avatar","size","styleOverrides"],[1,"name"],[1,"username"],[1,"stats"],["title","Posts","aria-hidden","false","aria-label","number posts","fontIcon","article"],["title","Pictorials","aria-hidden","false","aria-label","number pictorials","fontIcon","image"],["title","Comments","aria-hidden","false","aria-label","number comments","fontIcon","comment"]],template:function(t,r){t&1&&(n(0,"div",0)(1,"div",1),g("click",function(){return r.toProfile()}),m(2,"sns-user-avatar",2),n(3,"div",3)(4,"span"),s(5),i()()(),n(6,"div",4),s(7),i(),n(8,"div",5)(9,"div"),s(10,"#"),m(11,"mat-icon",6),s(12),i(),n(13,"div"),s(14,"#"),m(15,"mat-icon",7),s(16),i(),n(17,"div"),s(18,"#"),m(19,"mat-icon",8),s(20),i()()()),t&2&&(l(2),d("username",r.user.username)("avatar",r.user.avatar)("size",r.avatarSize)("styleOverrides",r.avatarOverrides),l(3),B(r.user.displayName),l(2),$(" @",r.user.username," "),l(5),$(": ",r.user.posts," "),l(4),$(": ",r.user.pictorials,""),l(4),$(": ",r.user.comments,""))},dependencies:[O,D,Tt],styles:["mat-icon[_ngcontent-%COMP%]{vertical-align:text-bottom}.user-summary[_ngcontent-%COMP%]{width:100%}.avatar-name[_ngcontent-%COMP%]{margin-top:1rem;border-bottom:2px solid;border-bottom-right-radius:2px}.avatar-name[_ngcontent-%COMP%]:hover{cursor:pointer}.name[_ngcontent-%COMP%]{font-size:1.2rem;letter-spacing:.15rem;align-content:end}.avatar[_ngcontent-%COMP%]{position:relative;float:left;transform:translateY(-20%);margin-right:.5rem}.username[_ngcontent-%COMP%]{letter-spacing:.15rem;color:var(--sns-username-color)}.stats[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;justify-content:space-between;gap:.5rem;opacity:80%;text-wrap:nowrap}@media (max-width: 1295px){.stats[_ngcontent-%COMP%], .username[_ngcontent-%COMP%], .name[_ngcontent-%COMP%]{display:none}.avatar-name[_ngcontent-%COMP%]{border-bottom:none}.avatar[_ngcontent-%COMP%]{float:none;margin:unset;justify-self:center}}"]})}}return o})();var Ro=o=>["/sns",o],Vo=()=>["/sns/settings"],Ht=(()=>{class o{constructor(e){this.router=e,this.userService=f(Fe),this.authService=f(V),this.sessionService=f(Je),this.user=this.userService.me$,this.dialog=f(le),this.subs=[],this.userService.refreshMe(),this.validLoginSessionCheck=setInterval(()=>{this.authService.isLoggedIn$().subscribe(r=>this.loginCheck(r))},1e3*60*5);let t=this.sessionService.loginSession$.pipe(nt(1)).subscribe(r=>this.checkSession(r));this.subs.push(t)}ngOnInit(){}ngOnDestroy(){clearInterval(this.validLoginSessionCheck);for(let e of this.subs)e.unsubscribe()}createPost(){this.dialog.open(Bt,{scrollStrategy:new E,data:{user:this.user()}})}promptLogout(){this.dialog.open(zt,{disableClose:!0,restoreFocus:!1,scrollStrategy:new E,data:{state:this.router.routerState.snapshot}})}loginCheck(e){e||this.sessionService.sessionExpired("login")}checkSession(e){!e&&this.dialogRef==null&&(this.dialogRef=this.dialog.open(Dt,{disableClose:!0,restoreFocus:!1,scrollStrategy:new E,data:{session:"login",state:this.router.routerState.snapshot}}),this.dialogRef.afterClosed().subscribe(t=>{this.dialogRef=void 0}))}static{this.\u0275fac=function(t){return new(t||o)(h(q))}}static{this.\u0275cmp=_({type:o,selectors:[["sns-index"]],decls:41,vars:6,consts:[["id","sns-index",1,"index"],[1,"index-sections"],["id","sns-nav"],[1,"logo"],[3,"user"],["mat-fab","","extended","",1,"new-post-btn",3,"click"],["aria-hidden","false","aria-label","new post","fontIcon","post_add"],[1,"nav-list"],["title","Home","routerLink","/sns/home","routerLinkActive","active-link",1,"nav-link"],["aria-hidden","false","aria-label","home","fontIcon","home",1,"link-icon"],[1,"link-text"],["title","search","routerLink","/sns/search","routerLinkActive","active-link",1,"nav-link"],["aria-hidden","false","aria-label","search","fontIcon","search",1,"link-icon"],["title","notifications TBA",1,"nav-link"],["aria-hidden","false","aria-label","notifications","fontIcon","notifications",1,"link-icon","TBA"],[1,"link-text","TBA"],["title","bookmarks TBA",1,"nav-link"],["aria-hidden","false","aria-label","bookmarks","fontIcon","bookmarks",1,"link-icon","TBA"],["title","Profile","routerLinkActive","active-link",1,"nav-link",3,"routerLink"],["aria-hidden","false","aria-label","profile","fontIcon","person",1,"link-icon"],["title","settings","routerLinkActive","active-link",1,"nav-link",3,"routerLink"],["aria-hidden","false","aria-label","settings","fontIcon","settings",1,"link-icon"],["title","logout",1,"nav-link","logout",3,"click"],["aria-hidden","false","aria-label","logout","fontIcon","logout",1,"link-icon"],["id","content"]],template:function(t,r){t&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),s(4," Logo "),i(),m(5,"sns-user-summary",4),n(6,"button",5),g("click",function(){return r.createPost()}),m(7,"mat-icon",6),n(8,"span"),s(9,"New post"),i()(),n(10,"div",7)(11,"div",8),m(12,"mat-icon",9),n(13,"span",10),s(14,"Home"),i()(),n(15,"div",11),m(16,"mat-icon",12),n(17,"span",10),s(18,"Search"),i()(),n(19,"div",13),m(20,"mat-icon",14),n(21,"span",15),s(22,"Notifications TBA"),i()(),n(23,"div",16),m(24,"mat-icon",17),n(25,"span",15),s(26,"Bookmarks TBA"),i()(),n(27,"div",18),m(28,"mat-icon",19),n(29,"span",10),s(30,"Profile"),i()(),n(31,"div",20),m(32,"mat-icon",21),n(33,"span",10),s(34,"Settings"),i()(),n(35,"div",22),g("click",function(){return r.promptLogout()}),m(36,"mat-icon",23),n(37,"span",10),s(38,"Logout"),i()()()(),n(39,"section",24),m(40,"router-outlet"),i()()()),t&2&&(l(5),d("user",r.user()),l(22),d("routerLink",mt(3,Ro,r.user().username)),l(4),d("routerLink",lt(5,Vo)))},dependencies:[O,D,v,ut,ie,ct,ne,pt,Ut],styles:[".index[_ngcontent-%COMP%]{--nav-width: 20rem;width:100%;min-height:100%;padding-left:calc(100vw - 100%);color:#c8c8c8;background-color:var(--sns-bg)}.index-sections[_ngcontent-%COMP%]{position:relative;height:100%;width:100%;max-width:fit-content;margin:auto}#sns-nav[_ngcontent-%COMP%]{position:fixed;top:0rem;display:flex;flex-direction:column;align-items:center;gap:1rem;width:var(--nav-width);height:calc(100% - 2rem);padding:1rem;box-sizing:border-box}.logo[_ngcontent-%COMP%]{height:3rem;text-align:center}sns-user-summary[_ngcontent-%COMP%]{width:100%}.new-post-btn[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;height:3rem;width:100%}.nav-list[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;gap:1.5rem;margin-top:1.5rem}.nav-link[_ngcontent-%COMP%]{font-size:1.15rem;display:flex;flex-flow:row nowrap;gap:.25rem;align-items:end;text-decoration:none;color:transparent}.nav-link[_ngcontent-%COMP%]:hover{cursor:pointer;color:#5f92b2}.link-icon[_ngcontent-%COMP%]{margin:auto 0rem;-webkit-text-stroke-color:lightskyblue;-webkit-text-stroke-width:1px}.TBA[_ngcontent-%COMP%]{color:#f08080!important;-webkit-text-stroke-color:lightcoral!important}.link-text[_ngcontent-%COMP%], .active-link[_ngcontent-%COMP%]{color:#87cefa}.logout[_ngcontent-%COMP%]{margin-top:auto}#content[_ngcontent-%COMP%]{width:calc(100% - var(--nav-width));min-height:calc(100vh - 2rem);margin-left:var(--nav-width)}@media (max-width: 1295px){.index[_ngcontent-%COMP%]{--nav-width: 5rem}.nav-list[_ngcontent-%COMP%]{gap:2.5rem}.nav-link[_ngcontent-%COMP%]{justify-content:center;transform:scale(1.2)}.nav-link[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:none}.new-post-btn[_ngcontent-%COMP%]{align-self:center;justify-content:center;padding:unset}.new-post-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin:auto}.new-post-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:none}}"]})}}return o})();var Qt=(()=>{class o extends ve{constructor(e,t){super(),this.data=e,this.dialogRef=t}ngOnInit(){}close(){}logout(){this.dialogRef.close(),this.router.navigate(["/sns/logout"])}returnToHome(){this.dialogRef.close(),this.router.navigate(["/sns/home"])}static{this.\u0275fac=function(t){return new(t||o)(h(A),h(L))}}static{this.\u0275cmp=_({type:o,selectors:[["already-logged-in"]],features:[I],decls:13,vars:0,consts:[[1,"logged-in"],[1,"logged-in-header"],[1,"logged-in-content"],["mat-flat-button","",1,"return-btn",3,"click"]],template:function(t,r){t&1&&(n(0,"div",0)(1,"div",1)(2,"div")(3,"h5"),s(4,"Already Logged In"),i()()(),n(5,"mat-dialog-content")(6,"div",2)(7,"div"),s(8,"You are already logged in. Would you like to logout?"),i(),n(9,"button",3),g("click",function(){return r.logout()}),s(10,"Logout"),i(),n(11,"button",3),g("click",function(){return r.returnToHome()}),s(12,"Return to home"),i()()()())},dependencies:[R,N,v,b],styles:[".logged-in[_ngcontent-%COMP%]{padding:1rem 0rem;box-sizing:border-box}.logged-in-header[_ngcontent-%COMP%]{padding:0rem 1rem;border-bottom:1px solid rgba(30,30,30,.5)}.logged-in-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem;font-size:1.25rem;text-align:center}.return-btn[_ngcontent-%COMP%]{border-radius:3px}"]})}}return o})();var $o=["loginForm"],Gt=(()=>{class o{constructor(e,t,r){this.authService=e,this.router=t,this.route=r,this.sessionService=f(Je),this.dialog=f(le),this.returnTo=this.route.snapshot.queryParams.returnTo}ngOnInit(){this.authService.isLoggedIn$().subscribe(e=>{e&&this.dialog.open(Qt,{disableClose:!0,restoreFocus:!0,scrollStrategy:new E})})}onSubmit(){let e=this.loginForm.value;this.authService.login$(e.username,e.password).subscribe({next:t=>{console.log(t),this.authService.refresh(),this.redirect()}})}redirect(){this.sessionService.newSession("login"),this.returnTo?this.router.navigateByUrl(this.returnTo):this.router.navigate(["../home"],{relativeTo:this.route})}static{this.\u0275fac=function(t){return new(t||o)(h(V),h(q),h(ce))}}static{this.\u0275cmp=_({type:o,selectors:[["sns-login"]],viewQuery:function(t,r){if(t&1&&ee($o,5),t&2){let a;te(a=oe())&&(r.loginForm=a.first)}},decls:18,vars:0,consts:[["loginForm","ngForm"],[1,"sns-login"],[1,"sns-login-form",3,"submit"],["appearance","outline"],["name","username","ngModel","","matInput","","lowerCaseInput","","placeholder","Username..."],["name","password","type","password","ngModel","","matInput","","placeholder","Password..."],["mat-raised-button",""],["routerLink","/sns/register",1,"link"]],template:function(t,r){if(t&1){let a=P();n(0,"div",1)(1,"div")(2,"form",2,0),g("submit",function(){return w(a),x(r.onSubmit())}),n(4,"h3"),s(5,"Login"),i(),n(6,"mat-form-field",3)(7,"mat-label"),s(8,"Username"),i(),m(9,"input",4),i(),n(10,"mat-form-field",3)(11,"mat-label"),s(12,"Password"),i(),m(13,"input",5),i(),n(14,"button",6),s(15,"Submit"),i(),n(16,"a",7),s(17,"No account? Register here"),i()()()()}},dependencies:[ie,ne,Q,H,z,F,U,se,re,J,Y,W,G,v,b,Ke],styles:[".sns-login[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem}.sns-login-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;min-width:10rem;max-width:30rem;width:100%;margin:auto;margin-top:3rem;padding:1rem;color:#000;border:1px solid black;border-radius:3px;background-color:#c8c8c8}.link[_ngcontent-%COMP%]{color:#00008b}"]})}}return o})();var qo=()=>[ne,b];function jo(o,p){o&1&&(n(0,"div",0)(1,"div",1)(2,"h5"),s(3,"Successfully Logged Out"),i(),n(4,"a",2),s(5,"No account? Register here"),i(),n(6,"a",3),s(7,"Already have an account? Login here"),i()()())}function Bo(o,p){if(o&1){let e=P();n(0,"div",0)(1,"div",1)(2,"h5"),s(3,"Would you like to logout?"),i(),n(4,"button",4),g("click",function(){w(e);let r=c(2);return x(r.logout())}),s(5,"Logout"),i(),n(6,"a",5),s(7,"Cancel"),i()()()}}function zo(o,p){if(o&1&&C(0,jo,8,0,"div",0)(1,Bo,8,0,"div",0),o&2){let e=c();M(e.isLoggedIn=="no"?0:1)}}function Uo(o,p){o&1&&(n(0,"div",0)(1,"div",1)(2,"h5"),s(3,"Checking login status"),i()()())}var Wt=(()=>{class o{constructor(){this.authService=f(V),this.authService.isLoggedIn$().pipe(Ee(3)).subscribe(e=>{e?this.isLoggedIn="yes":this.isLoggedIn="no"})}ngOnInit(){}logout(){this.authService.logout$().pipe(Ee(3)).subscribe(()=>{this.isLoggedIn="no"})}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275cmp=_({type:o,selectors:[["logout-page"]],decls:4,vars:1,consts:[[1,"sns-logout"],[1,"sns-logout-form"],["routerLink","/sns/register",1,"link"],["routerLink","/sns/login",1,"link"],["mat-flat-button","",3,"click"],["routerLink","/sns/home",1,"link"]],template:function(t,r){t&1&&(C(0,zo,2,1)(1,Uo,4,0),Me(2,0,qo,null,1)),t&2&&(l(2),be(r.isLoggedIn))},dependencies:[ie,v],styles:[".sns-logout[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem}.sns-logout-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;min-width:10rem;max-width:30rem;width:100%;margin:auto;margin-top:3rem;padding:1rem;color:#000;border:1px solid black;border-radius:3px;background-color:#c8c8c8}.link[_ngcontent-%COMP%]{color:#00008b}"]})}}return o})();var Yt=(()=>{class o extends ve{constructor(e,t){super(),this.data=e,this.dialogRef=t}ngOnInit(){}close(){}return(){this.dialogRef.close(),this.router.navigate(["/sns/login"],{queryParams:{returnTo:this.data.returnTo}})}static{this.\u0275fac=function(t){return new(t||o)(h(A),h(L))}}static{this.\u0275cmp=_({type:o,selectors:[["registration-success"]],features:[I],decls:11,vars:0,consts:[[1,"registration-success"],[1,"success-header"],[1,"success-content"],["mat-flat-button","",1,"return-btn",3,"click"]],template:function(t,r){t&1&&(n(0,"div",0)(1,"div",1)(2,"div")(3,"h5"),s(4,"Registration Succcessful"),i()()(),n(5,"mat-dialog-content")(6,"div",2)(7,"div"),s(8,"You've succesfully registered, you may return to login."),i(),n(9,"button",3),g("click",function(){return r.return()}),s(10,"Return to login"),i()()()())},dependencies:[R,N,v,b],styles:[".registration-success[_ngcontent-%COMP%]{padding:1rem 0rem;box-sizing:border-box}.success-header[_ngcontent-%COMP%]{padding:0rem 1rem;border-bottom:1px solid rgba(30,30,30,.5)}.success-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem;font-size:1.25rem;text-align:center}.return-btn[_ngcontent-%COMP%]{border-radius:3px}"]})}}return o})();var Ho=()=>[ne,H,z,F,U,Be,ze,Y,W,G,ae,b,import("./chunk-7ZB256TU.js").then(o=>o.LowercaseInputDirective),import("./chunk-KDRJXZTY.js").then(o=>o.SecurityQuestionsFormComponent)];function Qo(o,p){o&1&&(n(0,"mat-hint"),s(1,"Enter a username"),i())}function Go(o,p){o&1&&(n(0,"mat-hint"),s(1,"Username contains invalid characters"),i())}function Wo(o,p){o&1&&(n(0,"mat-hint"),s(1,"Invalid username. Must not start with '.', '_' OR be consecutive"),i())}function Yo(o,p){o&1&&(n(0,"mat-hint"),s(1,"Enter a password"),i())}function Jo(o,p){o&1&&(n(0,"mat-hint"),s(1,"Password cannot contain spaces"),i())}function Ko(o,p){o&1&&(n(0,"mat-hint"),s(1,"Enter a display name"),i())}function Xo(o,p){if(o&1){let e=P();n(0,"div")(1,"form",1),g("submit",function(){w(e);let r=c();return x(r.register())}),n(2,"h3"),s(3,"Register"),i(),n(4,"mat-form-field",2)(5,"mat-label"),s(6,"Username"),i(),m(7,"input",3),C(8,Qo,2,0,"mat-hint")(9,Go,2,0,"mat-hint")(10,Wo,2,0,"mat-hint"),i(),n(11,"mat-form-field",2)(12,"mat-label"),s(13,"Password"),i(),m(14,"input",4),C(15,Yo,2,0,"mat-hint")(16,Jo,2,0,"mat-hint"),i(),n(17,"mat-form-field",2)(18,"mat-label"),s(19,"DisplayName"),i(),m(20,"input",5),C(21,Ko,2,0,"mat-hint"),i(),m(22,"security-questions-form",6),n(23,"button",7),s(24,"Submit"),i(),n(25,"a",8),s(26,"Already have an account? Login Here"),i()()()}if(o&2){let e=c();l(),d("formGroup",e.registrationForm),l(7),M(e.username.hasError("required")?8:e.username.hasError("invalidUsernameCharacter")?9:e.username.hasError("invalidUsernameSeq")?10:-1),l(7),M(e.password.hasError("required")?15:e.password.hasError("invalidPassword")?16:-1),l(6),M(e.password.hasError("required")?21:-1),l(),d("form",e.registrationForm)("questions",e.questions())("numberQuestions",e.numberQuestions)}}var Jt=(()=>{class o{constructor(e,t,r){this.authService=e,this.router=t,this.route=r,this.userVerifyService=f(Xe),this.toastService=f(qe),this.numberQuestions=Ye.NUMBER_REGISTRATION_QUESTIONS,this.dialog=f(le),this.returnTo=this.route.snapshot.queryParams.returnTo,this.questions=this.userVerifyService.questions$;let a=new Se({username:new k(void 0,[T.required,T.minLength(Ye.USERNAME_MIN_LENGTH),we.invalidUsernameCharacter(),we.invalidUsernameSeq()]),password:new k(void 0,[T.required,T.minLength(Ye.PASSWORD_MIN_LENGTH),we.invalidPassword()]),displayName:new k(void 0,T.required),questions:new Ue([])});for(let u=0;u<this.numberQuestions;u++)a.controls.questions.push(new Se({question:new k(void 0,{nonNullable:!0,validators:T.required}),answer:new k(void 0,{nonNullable:!0,validators:[T.required,we.invalidSecurityQuestionAnswerSeq()]})}));this.registrationForm=a}ngOnInit(){}getQuestion(e,t){return t?this.questionsFormArray.at(e).controls.answer:this.questionsFormArray.at(e).controls.question}register(){let e=this.registrationForm.value,t=this.questionsArrayToMap(this.formatQuestions());this.authService.register$(e.username,e.password,e.displayName,t).subscribe({next:r=>{let a=this.dialog.open(Yt,{restoreFocus:!1,scrollStrategy:new E,closeOnNavigation:!0,data:{state:this.returnTo}})},error:r=>{console.log(r),this.toastService.show({type:"danger",source_feature:"sns",header:"Error",body:"Failed to register"})}})}formatQuestions(){let e=[];for(let t=0;t<this.numberQuestions;t++){let r=this.getQuestion(t).value,a=this.getQuestion(t,!0).value;a&&e.push({question:r,answer:a.trim()})}return e}questionsArrayToMap(e){return e.reduce((t,r)=>(t[r.question]=r.answer,t),{})}get username(){return this.registrationForm.controls.username}get password(){return this.registrationForm.controls.password}get displayName(){return this.registrationForm.controls.displayName}get questionsFormArray(){return this.registrationForm.get("questions")}static{this.\u0275fac=function(t){return new(t||o)(h(V),h(q),h(ce))}}static{this.\u0275cmp=_({type:o,selectors:[["sns-register"]],decls:4,vars:1,consts:[[1,"sns-register"],[1,"sns-register-form",3,"submit","formGroup"],["appearance","outline"],["name","username","formControlName","username","matInput","","lowerCaseInput","","placeholder","Username...","cdkFocusInitial",""],["name","password","formControlName","password","type","password","matInput","","placeholder","Password..."],["name","displayName","formControlName","displayName","matInput","","placeholder","Display name..."],[3,"form","questions","numberQuestions"],["mat-raised-button","",1,"submit-btn"],["routerLink","/sns/login",1,"link"]],template:function(t,r){t&1&&(n(0,"div",0),C(1,Xo,27,7),Me(2,1,Ho),i()),t&2&&(l(2),be(r.questions().length>0))},dependencies:[ie,ge,Q,J,v,fe],styles:[".sns-register[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem}.sns-register-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;min-width:10rem;max-width:30rem;width:100%;margin:auto;margin-top:3rem;padding:1rem;color:#000;border:1px solid black;border-radius:3px;background-color:#c8c8c8}.link[_ngcontent-%COMP%]{color:#00008b}"]})}}return o})();var Kt=(o,p)=>{let e=f(q),t=f(V),r=()=>(console.log("Invalid credentials"),e.navigate(["/sns/login"],{queryParams:{returnTo:p.url}}),Ze);return t.isLoggedIn$().pipe(Te(a=>a||(r(),!1)),et((a,u)=>r()))},Xt=(o,p)=>{let e=f(q),t=f(Xe),r=()=>(console.log("User not confirmed"),e.navigate(["/sns/confirm-user"],{queryParams:{returnTo:p.url}}),Ze);return t.isSecured$().pipe(Te(a=>a||(r(),!1)),et((a,u)=>r()))};var Zo=["usernameForm"];function en(o,p){if(o&1){let e=P();n(0,"div")(1,"form",2,0),g("submit",function(){w(e);let r=c();return x(r.submitUsername())}),n(3,"h3"),s(4,"Login"),i(),n(5,"mat-form-field",3)(6,"mat-label"),s(7,"Username"),i(),m(8,"input",4),i(),n(9,"button",5),s(10,"Submit"),i(),n(11,"a",6),s(12,"Return to login"),i()()()}}function tn(o,p){o&1&&(n(0,"mat-hint"),s(1,"Enter answer"),i())}function on(o,p){if(o&1&&(n(0,"div",12)(1,"div")(2,"span"),s(3),i()(),n(4,"mat-form-field",13)(5,"mat-label"),s(6,"Answer"),i(),m(7,"input",17),C(8,tn,2,0,"mat-hint"),i()()),o&2){let e=p.$index,t=c(2);at("formGroupName",e),l(3),B(t.getQuestion(e).value),l(5),M(-1)}}function nn(o,p){if(o&1&&(n(0,"mat-hint"),s(1),i()),o&2){let e=c(2);l(),B(e.minLengthHint)}}function rn(o,p){if(o&1&&(n(0,"mat-hint"),s(1),i()),o&2){let e=c(2);l(),B(e.invalidPasswordHint)}}function sn(o,p){if(o&1&&(n(0,"mat-hint"),s(1),i()),o&2){let e=c(2);l(),B(e.unconfirmedHint)}}function an(o,p){if(o&1){let e=P();n(0,"div")(1,"form",7),g("submit",function(){w(e);let r=c();return x(r.resetPassword())}),n(2,"h3"),s(3,"Reset Password"),i(),n(4,"button",8),g("click",function(){w(e);let r=c();return x(r.notMe())}),m(5,"mat-icon",9),n(6,"span"),s(7,"Not You?"),i()(),n(8,"div",10)(9,"div"),s(10,"Username"),i(),n(11,"div"),s(12),i()(),n(13,"div",11),X(14,on,9,3,"div",12,Pe),i(),n(16,"div")(17,"mat-form-field",13)(18,"mat-label"),s(19,"New Password"),i(),m(20,"input",14),C(21,nn,2,1,"mat-hint")(22,rn,2,1,"mat-hint"),i()(),n(23,"div")(24,"mat-form-field",13)(25,"mat-label"),s(26,"Confirm Password"),i(),m(27,"input",15),C(28,sn,2,1,"mat-hint"),i()(),n(29,"button",16),s(30,"Submit"),i()()()}if(o&2){let e=c();l(),d("formGroup",e.resetForm),l(11),B(e.username),l(2),Z(e.questionsFormArray.controls),l(7),M(e.newPassword.hasError("minlength")?21:e.newPassword.hasError("invalidPassword")?22:-1),l(7),M(e.confirmPassword.hasError("notMatching")?28:-1),l(),d("disabled",e.resetForm.invalid)}}var Zt=(()=>{class o{constructor(e,t){this.route=e,this.router=t,this.authService=f(V),this.toastService=f(qe),this.dialog=f(le),this.questions=[];let r=new k(void 0,[T.required,T.minLength(8),we.invalidPassword()]),a=new k(void 0,[T.required,this.passwordConfirmed(r)]),u=new Se({newPassword:r,confirmPassword:a,questions:new Ue([])});this.resetForm=u}ngOnInit(){}submitUsername(){let e=this.loginForm.value.username;e&&this.authService.forgotPassword$(e).subscribe({next:t=>{this.username=e,this.questions=t,this.questionsFormArray.clear();for(let r of t)this.questionsFormArray.push(new Se({question:new k(r,{nonNullable:!0,validators:T.required}),answer:new k(void 0,{nonNullable:!0,validators:T.required})}))},error:t=>{this.questionsFormArray.clear()}})}resetPassword(){if(!this.username)return;let e=this.username,t=this.newPassword.value,r=this.confirmPassword.value,a=[];for(let u=0;u<this.questionsFormArray.length;u++){let S=this.getQuestion(u).value,Re=this.getQuestion(u,!0).value;Re&&a.push({question:S,answer:Re.trim()})}this.authService.resetPassword$(e,t,r,a).subscribe({next:()=>{this.dialog.open(Et,{disableClose:!0,restoreFocus:!1,scrollStrategy:new E,data:{confirmText:"Password Changed",navText:"Return to Login",navLink:"/sns/login"}})},error:u=>{this.toastService.show({header:"Error",source_feature:"sns",type:"danger",body:"Failed to reset password"})}})}getQuestion(e,t){return t?this.questionsFormArray.at(e).controls.answer:this.questionsFormArray.at(e).controls.question}notMe(){this.username=void 0,this.questionsFormArray.clear()}passwordConfirmed(e){return t=>t.value==e.value?null:{notMatching:{value:"Passwords do not match"}}}get isResettingPassword(){return this.username&&this.questionsFormArray.length>0}get newPassword(){return this.resetForm.controls.newPassword}get confirmPassword(){return this.resetForm.controls.confirmPassword}get questionsFormArray(){return this.resetForm.get("questions")}get minLengthHint(){return`Min Length: ${this.newPassword.getError("minlength").requiredLength}`}get invalidPasswordHint(){return`Invalid Character(s): ${this.newPassword.getError("invalidPassword").invalidCharacters.map(t=>`'${t}'`).join(", ")}`}get unconfirmedHint(){return this.confirmPassword.getError("notMatching").value}static{this.\u0275fac=function(t){return new(t||o)(h(ce),h(q))}}static{this.\u0275cmp=_({type:o,selectors:[["forgot-password-page"]],viewQuery:function(t,r){if(t&1&&ee(Zo,5),t&2){let a;te(a=oe())&&(r.loginForm=a.first)}},decls:3,vars:1,consts:[["usernameForm","ngForm"],[1,"sns-forgot-password"],[1,"sns-forgot-password-form",3,"submit"],["appearance","outline"],["name","username","ngModel","","matInput","","lowerCaseInput","","placeholder","Username..."],["mat-raised-button",""],["routerLink","/sns/login",1,"link"],[1,"sns-forgot-password-form",3,"submit","formGroup"],["mat-raised-button","",1,"not-you",3,"click"],["aria-hidden","false","aria-label","back","fontIcon","arrow_back",1,"link-icon"],[1,"input-group"],["formArrayName","questions",1,"questions"],[1,"input-group",3,"formGroupName"],["appearance","outline",1,"reset-input"],["formControlName","newPassword","type","password","matInput","","maxlength","256","placeholder","Password..."],["formControlName","confirmPassword","type","password","matInput","","maxlength","256","placeholder","Password..."],["mat-raised-button","",3,"disabled"],["formControlName","answer","type","password","matInput","","maxlength","256","placeholder","Answer...","required",""]],template:function(t,r){t&1&&(n(0,"div",1),C(1,en,13,0,"div")(2,an,31,5,"div"),i()),t&2&&(l(),M(r.isResettingPassword?2:1))},dependencies:[ie,ne,ge,H,z,F,U,de,ue,Be,ze,_t,vt,Q,se,re,J,Y,W,G,ae,v,b,O,D,Ke],styles:[".sns-forgot-password[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem}.sns-forgot-password-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;min-width:10rem;max-width:30rem;width:100%;margin:auto;margin-top:3rem;padding:1rem;color:#000;border:1px solid black;border-radius:3px;background-color:#c8c8c8}.link[_ngcontent-%COMP%]{color:#00008b}.input-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.question[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;margin-bottom:1rem}.not-you[_ngcontent-%COMP%]{font-size:1.1rem;margin-bottom:1rem}.reset-input[_ngcontent-%COMP%]{width:100%}"]})}}return o})();var ln=[{path:"home",component:Nt},{path:"confirm-user",loadComponent:()=>import("./chunk-GLO5C3K5.js").then(o=>o.SnsVerifyUserComponent)},{path:"posts/:id",loadComponent:()=>import("./chunk-PTW5F7PR.js").then(o=>o.SnsViewPostComponent)},{path:"settings",loadComponent:()=>import("./chunk-CCVPN5K4.js").then(o=>o.SnsSettingsComponent),canActivate:[Xt]},{path:"search",loadComponent:()=>import("./chunk-NA367DCS.js").then(o=>o.SnsSearchPageComponent)},{path:":username",loadComponent:()=>import("./chunk-PKHDAJQE.js").then(o=>o.SnsProfileComponent)},{path:":username/:section",loadComponent:()=>import("./chunk-PKHDAJQE.js").then(o=>o.SnsProfileComponent)},{path:"**",redirectTo:"home",pathMatch:"full"}],Ls=[{path:"login",component:Gt},{path:"logout",component:Wt},{path:"register",component:Jt},{path:"forgot-password",component:Zt},{path:"",component:Ht,loadChildren:()=>ln,canActivate:[Kt]}];export{ln as contentRoutes,Ls as snsRoutes};
