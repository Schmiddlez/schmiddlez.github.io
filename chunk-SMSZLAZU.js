import{a as W,b as Y,c as J,d as he,e as ge,f as we,g as ve,h as ye}from"./chunk-DGBRVGTQ.js";import{a as xe}from"./chunk-IHWM6UX2.js";import{a as Se}from"./chunk-WMGO3G7U.js";import{a as be}from"./chunk-EDOFCG4F.js";import{a as K}from"./chunk-CR5TPDSS.js";import{a as g}from"./chunk-CRXCR2JF.js";import{a as _e}from"./chunk-OL4NWCWT.js";import{a as Ce}from"./chunk-GV27WZQL.js";import"./chunk-AYUTKG3J.js";import"./chunk-YAGYU2LF.js";import"./chunk-Y3TTJPGN.js";import"./chunk-U54IN6QP.js";import"./chunk-JKNJZGAZ.js";import"./chunk-UUBVQWNF.js";import{a as ie,c as fe}from"./chunk-UOSUV5A5.js";import{a as de,b as D}from"./chunk-GSXTAEMJ.js";import"./chunk-H2UTJKOZ.js";import"./chunk-N7TBWEAR.js";import{b as B,d as A}from"./chunk-NPZLEDH6.js";import"./chunk-WTDRPXX3.js";import"./chunk-HU7WFQWJ.js";import{e as q,i as N,m as H,z as G}from"./chunk-HUAPMYXL.js";import"./chunk-LUEFBJHU.js";import"./chunk-P4ZELJWN.js";import{b as x,d as O,e as j,i as z}from"./chunk-KVX4MIOR.js";import"./chunk-5V4PC647.js";import"./chunk-OOKV5ZR5.js";import{$a as me,Aa as le,Da as _,Fb as l,Lb as b,Ob as F,Pb as M,Qb as s,Rb as r,Sb as d,Ub as T,Wb as w,Xb as a,Z as se,Za as ae,a as ee,ab as o,b as te,bb as h,da as S,gb as ce,gc as m,hb as pe,hc as f,ic as V,ka as E,la as I,mb as P,ob as ue,oc as U,tb as y,va as re,ya as L,yc as C,za as v}from"./chunk-3AA7O2RR.js";var Fe=(()=>{class n{set loadUntil(e){this.stop=e,this.stop&&this.stopLoading(this.immediateStop),e==!1&&this.doLoading()}set immediate(e){this.immediateStop=e}set inheritClasses(e){if(!e)for(let t of this.eleRef.nativeElement.classList)this.render.removeClass(this.container,t)}constructor(e,t,i,p){if(this.eleRef=e,this.viewRef=t,this.render=i,this.route=p,this.isShownChange=new re,this.subs=[],this.container=this.render.createElement("div"),this.render.addClass(this.container,"loading-container"),this.inheritClasses)for(let k of this.eleRef.nativeElement.classList)this.render.addClass(this.container,k);this.loading=this.render.createElement("div"),this.render.addClass(this.loading,"loading"),this.container.appendChild(this.loading);let u=this.viewRef.createComponent(ie);u.setInput("mode","indeterminate"),this.spinner=u.injector.get(ie)._elementRef.nativeElement}ngOnInit(){let e=this.eleRef.nativeElement,t=this.render.parentNode(e);this.render.insertBefore(t,this.container,e),this.render.removeChild(e.parentElement,e),this.render.appendChild(this.container,e),this.render.removeChild(this.spinner.parentElement,this.spinner),this.render.appendChild(this.loading,this.spinner);let i=this.route.url.subscribe(p=>{this.doLoading()});this.subs.push(i)}ngOnDestroy(){for(let e of this.subs)e.unsubscribe()}doLoading(){this.render.setStyle(this.eleRef.nativeElement,"visibility","hidden"),this.render.setStyle(this.loading,"display","flex"),this.render.setStyle(this.loading,"justify-content","center"),this.render.setStyle(this.loading,"margin-top","10rem"),this.stop&&this.stopLoading(this.immediateStop)}stopLoading(e){e?this.show():setTimeout(()=>{this.show()},1e3)}show(){this.render.setStyle(this.loading,"display","none"),this.render.setStyle(this.eleRef.nativeElement,"visibility","visible")}static{this.\u0275fac=function(t){return new(t||n)(h(le),h(pe),h(ce),h(x))}}static{this.\u0275dir=ue({type:n,selectors:[["","hasLoading",""]],inputs:{loadUntil:"loadUntil",immediate:"immediate",inheritClasses:"inheritClasses"},outputs:{isShownChange:"isShownChange"}})}}return n})();var Ie=["posts","comments","likes","follows","following","followers"],Te=["posts","comments","likes"],$e=["follows","following","followers"],Me=n=>Ie.includes(n),$=n=>Te.includes(n),X=n=>$e.includes(n),Z=(()=>{class n{constructor(){this.userService=S(K),this.profilePosts$=C(()=>[...this.announcements(),...this.posts$()]),this.announcements=_([]),this.views={posts:_([]),comments:_([]),likes:_([]),follows:_([]),followers:_([])},this.pages={posts:0,comments:0,likes:0,follows:0,followers:0},this.more={posts:!0,comments:!0,likes:!0,follows:!0,followers:!0},this.loading={posts:!1,comments:!1,likes:!1,follows:!1,followers:!1},this.announcements$=this.announcements.asReadonly(),this.posts$=this.views.posts.asReadonly(),this.comments$=this.views.comments.asReadonly(),this.likes$=this.views.likes.asReadonly(),this.follows$=this.views.follows.asReadonly(),this.followers$=this.views.followers.asReadonly()}setUser(e){this.reset(),this.user=e,this.getMore(e,"posts"),this.getMore(e,"comments"),this.getMore(e,"likes"),this.getMore(e,"follows"),this.getMore(e,"followers"),this.userService.getUserAnnouncements(e,t=>this.announcements.set(t))}setView(e){this.view=e}reset(){this.announcements.set([]);for(let e in this.views)this.views[e].set([]);for(let e in this.pages)this.pages[e]=0;for(let e in this.more)this.more[e]=!0;for(let e in this.loading)this.loading[e]=!1}getMore(e,t){if(this.checkMoreRequest(t))return;let i=u=>{u.length>0?(this.views[t].update(k=>[...k,...u]),this.pages[t]=this.pages[t]+1):this.more[t]=!1},p=()=>this.loading[t]=!1;switch(t){case"posts":this.loading[t]=!0,this.userService.getUserPostsForProfile(e,this.pages[t],i,p);break;case"comments":this.loading[t]=!0,this.userService.getUserComments(e,this.pages[t],i,p);break;case"likes":this.loading[t]=!0,this.userService.getUserLikes(e,this.pages[t],i,p);break;case"follows":this.loading[t]=!0,this.userService.getUserFollows(e,this.pages[t],i,p);break;case"followers":this.loading[t]=!0,this.userService.getUserFollowers(e,this.pages[t],i,p);break}}get currentProfile(){return this.user==g?void 0:this.user}get currentView(){return this.view}checkMoreRequest(e){return!this.more[e]||this.loading[e]}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var ke=(n,c)=>c.id,Pe=n=>["/sns",n];function je(n,c){if(n&1){let e=T();s(0,"div",19)(1,"button",21),w("click",function(i){E(e);let p=a().$implicit,u=a();return I(u.isFollowing(p)?u.unfollow(p,i):u.follow(p,i))}),s(2,"span"),m(3),r()()()}if(n&2){let e=a().$implicit,t=a();o(3),f(t.isFollowing(e)?"Unfollow":"Follow")}}function ze(n,c){if(n&1&&(s(0,"div",13)(1,"div",15),d(2,"sns-user-avatar",4),s(3,"div",16)(4,"span",17),m(5),r(),s(6,"span",18),m(7),r()(),y(8,je,4,1,"div",19),r(),s(9,"div",20)(10,"p"),m(11),r()()()),n&2){let e=c.$implicit,t=a();l("routerLink",U(10,Pe,e.username)),o(2),l("username",e.username)("avatar",e.avatar)("size","4.5rem"),o(2),l("title",e.displayName),o(),f(e.displayName),o(),l("title",e.username),o(),f("@"+e.username),o(),b(e.id!=t.me().id?8:-1),o(3),f(e.about)}}function Be(n,c){if(n&1&&(s(0,"div",14)(1,"span"),m(2),r(),s(3,"span"),m(4,"is not following anyone"),r()()),n&2){let e=a();o(2),f(e.user().displayName)}}function Ae(n,c){if(n&1){let e=T();s(0,"div",19)(1,"button",21),w("click",function(i){E(e);let p=a().$implicit,u=a();return I(u.isFollowing(p)?u.unfollow(p,i):u.follow(p,i))}),s(2,"span"),m(3),r()()()}if(n&2){let e=a().$implicit,t=a();o(3),f(t.isFollowing(e)?"Unfollow":"Follow")}}function De(n,c){if(n&1&&(s(0,"div",13)(1,"div",15),d(2,"sns-user-avatar",4),s(3,"div",16)(4,"span",17),m(5),r(),s(6,"span",18),m(7),r()(),y(8,Ae,4,1,"div",19),r(),s(9,"div",20)(10,"p"),m(11),r()()()),n&2){let e=c.$implicit,t=a();l("routerLink",U(10,Pe,e.username)),o(2),l("username",e.username)("avatar",e.avatar)("size","4.5rem"),o(2),l("title",e.displayName),o(),f(e.displayName),o(),l("title",e.username),o(),f("@"+e.username),o(),b(e.id!=t.me().id?8:-1),o(3),f(e.about)}}function qe(n,c){if(n&1&&(s(0,"div",14)(1,"span",22),m(2),r(),s(3,"span"),m(4,"is not followed by anyone ;("),r()()),n&2){let e=a();o(2),f(e.user().displayName)}}var Ue=(()=>{class n{constructor(e,t){this.route=e,this.router=t,this.me=v.required(),this.user=v.required(),this.follows=v.required(),this.followers=v.required(),this.onFollowChange=L(),this.view=new N("posts"),this.subs=[]}ngOnInit(){let e=this.route.params.subscribe(t=>{let i=t.section;X(i)&&i!=this.view.value&&(this.view.setValue(i),this.changeView(i))});this.subs.push(e)}follow(e,t){t?.stopPropagation(),this.onFollowChange.emit({action:"follow",data:e})}unfollow(e,t){t?.stopPropagation(),this.onFollowChange.emit({action:"unfollow",data:e})}isFollowing(e){return this.me().follows.includes(e.id)}contentChange(e){this.changeView(e.value)}goBack(){this.user()!=g&&this.router.navigate(["sns",this.user().username])}changeView(e){if(this.user()!=g)switch(e){case"follows":case"following":this.router.navigate(["sns",this.user().username,e]);break;case"followers":this.router.navigate(["sns",this.user().username,e]);break;default:this.router.navigate(["sns",this.user().username])}}static{this.\u0275fac=function(t){return new(t||n)(h(x),h(O))}}static{this.\u0275cmp=P({type:n,selectors:[["sns-user-follows"]],inputs:{me:[1,"me"],user:[1,"user"],follows:[1,"follows"],followers:[1,"followers"]},outputs:{onFollowChange:"onFollowChange"},decls:24,vars:11,consts:[[1,"sns-user-follows"],[1,"follows-header"],[1,"back-to-user",3,"click"],[1,"sns-user"],[3,"username","avatar","size"],[1,"user-info"],[1,"displayname"],[1,"username"],["value","following",1,"user-section-group",3,"change","formControl"],["value","following",1,"user-section",3,"checked"],["value","followers",1,"user-section"],[1,"follows-content"],[3,"hidden"],[1,"sns-follows-user",3,"routerLink"],[1,"empty-follows"],[1,"follows-user-info"],[1,"follows-user-name"],[1,"follows-displayname",3,"title"],[1,"follows-username",3,"title"],[1,"follow"],[1,"follows-about"],["mat-fab","","extended","",1,"follow-btn",3,"click"],[1,"empty-name"]],template:function(t,i){t&1&&(s(0,"div",0)(1,"div",1)(2,"div",2),w("click",function(){return i.goBack()}),s(3,"div",3),d(4,"sns-user-avatar",4),s(5,"div",5)(6,"div",6),m(7),r(),s(8,"div",7),m(9),r()()()(),s(10,"mat-button-toggle-group",8),w("change",function(u){return i.contentChange(u)}),s(11,"mat-button-toggle",9),m(12,"Following"),r(),s(13,"mat-button-toggle",10),m(14,"Followers"),r()()(),s(15,"div",11)(16,"div",12),F(17,ze,12,12,"div",13,ke,!1,Be,5,1,"div",14),r(),s(20,"div",12),F(21,De,12,12,"div",13,ke,!1,qe,5,1,"div",14),r()()()),t&2&&(o(4),l("username",i.user().username)("avatar",i.user().avatar)("size","4.5rem"),o(3),f(i.user().displayName),o(2),f("@"+i.user().username),o(),l("formControl",i.view),o(),l("checked",!0),o(5),l("hidden",i.view.value!="follows"&&i.view.value!="following"),o(),M(i.follows()),o(3),l("hidden",i.view.value!="followers"),o(),M(i.followers()))},dependencies:[J,W,Y,A,B,D,z,j,G,q,H,be],styles:[".follows-header[_ngcontent-%COMP%]{position:sticky;top:0;display:flex;flex-direction:column;gap:1rem;padding:.5rem 0rem 1.5rem;background-color:var(--sns-bg-trans);-webkit-backdrop-filter:blur(.25rem);backdrop-filter:blur(.25rem);z-index:100}.follows-content[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;padding:.25rem}.back-to-user[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;gap:1rem}.back-to-user[_ngcontent-%COMP%]:hover{cursor:pointer;background-color:var(--sns-hover-color)}.sns-user[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;gap:2rem;margin:auto}.user-info[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;align-items:center;margin:auto;font-size:1.3rem}.displayname[_ngcontent-%COMP%]{font-size:1.75rem;overflow:hidden;text-overflow:ellipsis;margin-right:1rem}.username[_ngcontent-%COMP%]{font-size:1.25rem;color:var(--sns-username-color)}.user-section-group[_ngcontent-%COMP%]{flex:1;border:none;border-radius:0;background-color:var(--sns-bg-trans)}mat-button-toggle[_ngcontent-%COMP%]{color:var(--sns-text-color);width:100%;border:none!important}.sns-follows-user[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;align-content:center;gap:1.25rem;padding:1rem;border-bottom:1px solid rgba(200,200,200,.25)}.sns-follows-user[_ngcontent-%COMP%]:hover{cursor:pointer;scale:1.01;background-color:var(--sns-hover-color)}.follows-user-info[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;gap:.5rem}.follows-user-name[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;align-items:center;overflow:hidden}.follows-displayname[_ngcontent-%COMP%]{font-size:1.75rem;margin-right:.5rem}.follows-username[_ngcontent-%COMP%]{font-size:1.2rem;color:var(--sns-username-color)}.follow[_ngcontent-%COMP%]{display:flex;align-items:flex-start;margin-left:auto}.follow-btn[_ngcontent-%COMP%]{height:2rem}.displayname[_ngcontent-%COMP%], .follows-displayname[_ngcontent-%COMP%], .follows-username[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;margin-right:1rem}.empty-follows[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;gap:.25rem;margin:auto;justify-content:center;align-items:center;font-size:1.25rem}.empty-name[_ngcontent-%COMP%]{font-size:1.45rem}"]})}}return n})();var oe=(n,c)=>c.id,Oe=n=>[n];function Ne(n,c){if(n&1){let e=T();s(0,"div",10)(1,"button",27),w("click",function(){E(e);let i=a();return I(i.isFollowing()?i.unfollow():i.follow())}),s(2,"span"),m(3),r()()()}if(n&2){let e=a();o(3),f(e.isFollowing()?"Unfollow":"Follow")}}function He(n,c){}function Ge(n,c){if(n&1&&d(0,"sns-announcement",26),n&2){let e=a().$implicit,t=a();l("post",t.announcement(e))("user",t.me())}}function We(n,c){if(n&1&&d(0,"sns-comment",26),n&2){let e=a().$implicit,t=a();l("post",t.comment(e))("user",t.me())}}function Ye(n,c){if(n&1&&d(0,"sns-pictorial",26),n&2){let e=a().$implicit,t=a();l("post",t.pictorial(e))("user",t.me())}}function Je(n,c){if(n&1&&d(0,"sns-article",26),n&2){let e=a().$implicit,t=a();l("post",t.article(e))("user",t.me())}}function Ke(n,c){if(n&1&&y(0,He,0,0)(1,Ge,1,2,"sns-announcement",26)(2,We,1,2,"sns-comment",26)(3,Ye,1,2,"sns-pictorial",26)(4,Je,1,2,"sns-article",26),n&2){let e,t=c.$implicit;b((e=t.type)==="basic"?0:e==="announcement"?1:e==="comment"?2:e==="pictorial"?3:e==="article"?4:-1)}}function Qe(n,c){if(n&1&&d(0,"sns-comment",26),n&2){let e=c.$implicit,t=a();l("post",t.comment(e))("user",t.me())}}function Xe(n,c){}function Ze(n,c){if(n&1&&d(0,"sns-announcement",26),n&2){let e=a().$implicit,t=a();l("post",t.announcement(e))("user",t.me())}}function et(n,c){if(n&1&&d(0,"sns-comment",26),n&2){let e=a().$implicit,t=a();l("post",t.comment(e))("user",t.me())}}function tt(n,c){if(n&1&&d(0,"sns-pictorial",26),n&2){let e=a().$implicit,t=a();l("post",t.pictorial(e))("user",t.me())}}function it(n,c){if(n&1&&d(0,"sns-article",26),n&2){let e=a().$implicit,t=a();l("post",t.article(e))("user",t.me())}}function nt(n,c){if(n&1&&y(0,Xe,0,0)(1,Ze,1,2,"sns-announcement",26)(2,et,1,2,"sns-comment",26)(3,tt,1,2,"sns-pictorial",26)(4,it,1,2,"sns-article",26),n&2){let e,t=c.$implicit;b((e=t.type)==="basic"?0:e==="announcement"?1:e==="comment"?2:e==="pictorial"?3:e==="article"?4:-1)}}var Ee=(()=>{class n{constructor(e,t){this.route=e,this.router=t,this.profileService=S(Z),this.throttler=new fe,this.me=v.required(),this.user=v.required(),this.posts=v.required(),this.comments=v.required(),this.likes=v.required(),this.onFollowChange=L(),this.view=new N("posts"),this.isFollowing=C(()=>this.me().follows.includes(this.user().id)),this.subs=[],this.announcement=he,this.comment=ge,this.pictorial=we,this.article=ve}ngOnInit(){let e=this.route.params.subscribe(t=>{let i=t.section;$(i)&&i!=this.view.value&&(this.view.setValue(i),this.changeView(i))});this.subs.push(e)}ngOnDestroy(){for(let e of this.subs)e.unsubscribe()}contentChange(e){this.changeView(e.value)}onScroll(){let e=window.document.documentElement;e.scrollHeight-(e.scrollTop+e.offsetHeight)<Math.min(2e3,e.scrollHeight*.1)&&this.throttler.throttle(()=>{let i=this.view.value;i&&$(i)&&this.profileService.getMore(this.user(),i)},3e3)}follow(e=this.user()){this.onFollowChange.emit({action:"follow",data:e})}unfollow(e=this.user()){this.onFollowChange.emit({action:"unfollow",data:e})}changeView(e){if(this.user()!=g)switch(e){case"posts":this.router.navigate(["sns",this.user().username]);break;case"comments":this.router.navigate(["sns",this.user().username,"comments"]);break;case"likes":this.router.navigate(["sns",this.user().username,"likes"]);break;default:this.router.navigate(["sns",this.user().username])}}static{this.\u0275fac=function(t){return new(t||n)(h(x),h(O))}}static{this.\u0275cmp=P({type:n,selectors:[["sns-user"]],hostBindings:function(t,i){t&1&&w("scroll",function(){return i.onScroll()},!1,me)},inputs:{me:[1,"me"],user:[1,"user"],posts:[1,"posts"],comments:[1,"comments"],likes:[1,"likes"]},outputs:{onFollowChange:"onFollowChange"},decls:55,vars:22,consts:[[1,"sns-user"],[1,"profile-background"],[1,"profile-info"],[1,"user-general"],[1,"avatar-wrapper"],[1,"avatar",3,"title","src"],[1,"user-identification"],[1,"filler"],[1,"displayname"],[1,"username"],[1,"follow"],[1,"user-more"],[1,"stats"],[1,"post-stats"],["title","Articles","aria-hidden","false","aria-label","number articles","fontIcon","article"],["title","Pictorials","aria-hidden","false","aria-label","number pictorials","fontIcon","image"],["title","Comments","aria-hidden","false","aria-label","number comments","fontIcon","comment"],[1,"follow-stats"],[3,"routerLink"],[1,"profile-content"],["value","posts",1,"user-section-group",3,"change","formControl"],["value","posts",1,"user-section",3,"checked"],["value","comments",1,"user-section"],["value","likes",1,"user-section"],[3,"hidden"],[1,"user-feed"],[3,"post","user"],["mat-fab","","extended","",1,"follow-btn",3,"click"]],template:function(t,i){t&1&&(s(0,"div",0),d(1,"div",1),s(2,"div",2)(3,"div",3)(4,"div",4),d(5,"img",5),r(),s(6,"div",6),d(7,"span",7),s(8,"span",8),m(9),r(),s(10,"span",9),m(11),r(),y(12,Ne,4,1,"div",10),r()(),s(13,"div",11)(14,"div"),m(15),r(),s(16,"div",12)(17,"div",13)(18,"div"),m(19,"#"),d(20,"mat-icon",14),m(21),r(),s(22,"div"),m(23,"#"),d(24,"mat-icon",15),m(25),r(),s(26,"div"),m(27,"#"),d(28,"mat-icon",16),m(29),r()(),s(30,"div",17)(31,"span",18),m(32),r(),s(33,"span",18),m(34),r()()()()(),s(35,"div",19)(36,"mat-button-toggle-group",20),w("change",function(u){return i.contentChange(u)}),s(37,"mat-button-toggle",21),m(38,"Posts"),r(),s(39,"mat-button-toggle",22),m(40,"Comments"),r(),s(41,"mat-button-toggle",23),m(42,"Likes"),r()(),s(43,"div",24)(44,"div",25),F(45,Ke,5,1,null,null,oe),r()(),s(47,"div",24)(48,"div",25),F(49,Qe,1,2,"sns-comment",26,oe),r()(),s(51,"div",24)(52,"div",25),F(53,nt,5,1,null,null,oe),r()()()()),t&2&&(o(5),l("title","avatar")("src",i.user().avatar,ae),o(4),f(i.user().displayName),o(2),f("@"+i.user().username),o(),b(i.user().id!=i.me().id?12:-1),o(3),f(i.user().about),o(6),V(": ",i.user().articles," "),o(4),V(": ",i.user().pictorials,""),o(4),V(": ",i.user().comments,""),o(2),l("routerLink",U(18,Oe,"/sns/"+i.user().username+"/followers")),o(),f("Followers: "+i.user().followCount),o(),l("routerLink",U(20,Oe,"/sns/"+i.user().username+"/following")),o(),f("Following: "+i.user().follows.length),o(2),l("formControl",i.view),o(),l("checked",!0),o(6),l("hidden",i.view.value!="posts"),o(2),M(i.posts()),o(2),l("hidden",i.view.value!="comments"),o(2),M(i.comments()),o(2),l("hidden",i.view.value!="likes"),o(2),M(i.likes()))},dependencies:[J,W,Y,A,B,D,de,G,q,H,z,j,_e,Se,xe,Ce],styles:[".sns-user[_ngcontent-%COMP%]{flex:1;display:flex;flex-flow:column}.profile-background[_ngcontent-%COMP%]{height:12rem;background-color:var(--mudae-light)}.profile-info[_ngcontent-%COMP%]{position:relative;padding:0rem .5rem .5rem;margin-bottom:1rem}.follow[_ngcontent-%COMP%]{position:absolute;top:.75rem;right:.25rem}.follow-btn[_ngcontent-%COMP%]{height:2rem}.user-general[_ngcontent-%COMP%]{position:relative;display:flex;flex-flow:row wrap;gap:.5rem;letter-spacing:.125rem;margin-bottom:1rem}.avatar-wrapper[_ngcontent-%COMP%]{--avatar-size: 6rem;position:absolute;flex-shrink:0;width:var(--avatar-size);height:var(--avatar-size);margin-right:.5rem;transform:translateY(calc(var(--avatar-size) / -2));border-radius:100%;overflow:hidden}.avatar[_ngcontent-%COMP%]{width:var(--avatar-size);height:var(--avatar-size);object-fit:cover}.user-identification[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-self:flex-end;overflow:hidden}.filler[_ngcontent-%COMP%]{width:7rem;height:3rem}.displayname[_ngcontent-%COMP%]{font-size:1.75rem;overflow:hidden;text-overflow:ellipsis}.username[_ngcontent-%COMP%]{font-size:1.25rem;color:#ffffff80}.user-more[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.stats[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;gap:1rem;justify-content:space-between;opacity:80%}.post-stats[_ngcontent-%COMP%], .follow-stats[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;gap:1.5rem;text-wrap:nowrap}.follow-stats[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]:hover{cursor:pointer;color:#fff}mat-icon[_ngcontent-%COMP%]{vertical-align:text-bottom}.profile-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.user-section-group[_ngcontent-%COMP%]{flex:1;border:none;border-radius:0;background-color:#1e1e1ebf}mat-button-toggle[_ngcontent-%COMP%]{color:#fff;width:100%;border:none!important}.user-feed[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.loading[_ngcontent-%COMP%]{flex:1;display:flex;justify-content:center;padding-top:10rem}"]})}}return n})();var Zt=(()=>{class n{constructor(e,t){this.route=e,this.router=t,this.userService=S(K),this.profileService=S(Z),this.me=_(g),this.user=_(g),this.section=_("posts"),this.sameProfile=C(()=>this.me()!=g&&this.user().username==this.profileService.currentProfile?.username),this.isValid=C(()=>this.me()!=g&&this.user()!=g),this.profileInfo=C(()=>({user:this.user(),posts:this.posts(),comments:this.comments(),likes:this.likes(),follows:this.follows(),followers:this.followers()})),this.subs=[],this.isProfileMainSection=$,this.isProfileFollowSection=X,this.me=this.userService.me$,this.posts=this.profileService.profilePosts$,this.comments=this.profileService.comments$,this.likes=this.profileService.likes$,this.follows=this.profileService.follows$,this.followers=this.profileService.followers$;let i=this.route.params.subscribe(p=>{let u=p.username,k=p.section;if(Me(k)&&this.section.set(k),this.profileService.currentProfile&&u==this.profileService.currentProfile?.username){let R=this.profileService.currentProfile;this.user.set(R)}else this.user.set(g),this.userService.getUserByUsername$(u).subscribe(R=>{this.user.set(R),this.profileService.setUser(R)})});this.subs.push(i)}ngOnInit(){}ngOnDestroy(){for(let e of this.subs)e.unsubscribe()}onFollowChange(e){e.action=="follow"?this.follow(e.data):e.action=="unfollow"&&this.unfollow(e.data)}follow(e){this.userService.followUser$(e).subscribe({next:t=>{this.userService.updateFollows(t),this.user.update(i=>te(ee({},i),{followCount:i.followCount+1}))},error:t=>{console.log(t)}})}unfollow(e){this.userService.unfollowUser$(e).subscribe({next:t=>{this.userService.removeFollows(t),this.user.update(i=>te(ee({},i),{followCount:i.followCount-1}))},error:t=>{console.log(t)}})}static{this.\u0275fac=function(t){return new(t||n)(h(x),h(O))}}static{this.\u0275cmp=P({type:n,selectors:[["sns-profile"]],decls:6,vars:15,consts:[["id","sns-profile"],[3,"hidden"],["hasLoading","",1,"main-content",3,"onFollowChange","me","user","posts","comments","likes","loadUntil","immediate"],["hasLoading","",1,"main-content",3,"onFollowChange","me","user","follows","followers","loadUntil","immediate"],[1,"side-content"]],template:function(t,i){t&1&&(s(0,"div",0)(1,"div",1)(2,"sns-user",2),w("onFollowChange",function(u){return i.onFollowChange(u)}),r()(),s(3,"div",1)(4,"sns-user-follows",3),w("onFollowChange",function(u){return i.onFollowChange(u)}),r()(),d(5,"sns-search",4),r()),t&2&&(o(),l("hidden",!i.isProfileMainSection(i.section())),o(),l("me",i.me())("user",i.user())("posts",i.posts())("comments",i.comments())("likes",i.likes())("loadUntil",i.isValid())("immediate",i.sameProfile()),o(),l("hidden",!i.isProfileFollowSection(i.section())),o(),l("me",i.me())("user",i.user())("follows",i.follows())("followers",i.followers())("loadUntil",i.isValid())("immediate",i.sameProfile()))},dependencies:[Ee,ye,Ue,Fe],styles:["#sns-profile[_ngcontent-%COMP%]{position:relative;display:flex;flex-flow:row nowrap;justify-content:center;width:100%;max-height:100%}@media (max-width:1080px){sns-user[_ngcontent-%COMP%]{min-width:10rem;padding-right:1rem}.side-content[_ngcontent-%COMP%]{display:none}}"]})}}return n})();export{Zt as SnsProfileComponent};
