import{a as He}from"./chunk-IG64557V.js";import{a as ve,b as Se,c as de}from"./chunk-ZUWKRBQH.js";import{a as Ie,b as $e}from"./chunk-3MO2X2A3.js";import{a as Ge}from"./chunk-RFHZPYFY.js";import{a as he}from"./chunk-QE36J6DD.js";import{a as je}from"./chunk-GGYXFCSL.js";import{a as H,b as N,c as Ve,d as be}from"./chunk-SNVRFF47.js";import{b as K,c as v,e as V,f as Q,g as D,i as g,k as ee,l as ge,m as Ae,n as te,q as ie,r as re,s as q,t as W,v as Ne,y as A}from"./chunk-TNQGBTTS.js";import{a as oe,b as me,c as pe,d as Ce,e as Be}from"./chunk-2XN2X2Z5.js";import{b as F}from"./chunk-UHDF7GHS.js";import{a as B}from"./chunk-LE6ER5HQ.js";import{b as I,c as fe,d as P,e as k,i as $}from"./chunk-BT2GGWQX.js";import{a as De}from"./chunk-LTUS2JR5.js";import"./chunk-B6GQN5TU.js";import{m as ue}from"./chunk-BLCVZY47.js";import{$a as s,Ab as Me,B as Re,Ca as Fe,Db as m,Gb as Te,Hb as ye,Jb as U,Kb as Oe,Lb as y,Mb as S,Nb as r,Ob as o,Pb as d,Rb as J,Tb as C,Ub as f,Ya as le,Z as Pe,_a as Y,ab as u,da as b,dc as a,ec as h,fc as Le,ka as M,kc as R,l as Ee,la as T,lb as x,lc as j,nc as X,oc as Z,r as ke,sb as _,yb as O,zb as L}from"./chunk-X7EC65UH.js";var ct=(t,c)=>c.id,mt=()=>[ee,q,W,K,ge,re,V,Q,te,ie,k],Ue=()=>["/loa-assistant/home"];function pt(t,c){if(t&1&&(r(0,"option",22),a(1),o()),t&2){let e=c.$implicit;m("value",e.name),s(),h(e.name)}}function ut(t,c){if(t&1){let e=J();r(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"div",6)(5,"h5",7),a(6,"Add Character"),o(),r(7,"div",8),d(8,"img",9),o(),d(9,"button",10),o()(),r(10,"div",11)(11,"div",8)(12,"form",12),C("submit",function(){M(e);let n=f();return T(n.submit())}),r(13,"div",13)(14,"div",14),d(15,"input",15),r(16,"label",16),a(17,"Name"),o()(),r(18,"div",17),d(19,"input",18),r(20,"label",19),a(21,"Item Level"),o()()(),r(22,"div",20)(23,"select",21),y(24,pt,2,2,"option",22,ct),o(),r(26,"label",23),a(27,"Class"),o()(),r(28,"div",24),d(29,"input",25),r(30,"label",26),a(31,"Player"),o()(),r(32,"div",27)(33,"button",28),C("click",function(){M(e);let n=f();return T(n.reset())}),a(34,"Reset"),o(),r(35,"button",29),a(36,"Add Character"),o()()()()(),r(37,"div",30)(38,"button",31),a(39,"Cancel"),o()()()()()}if(t&2){let e=f();s(8),m("title",e.character().loaClass.name)("src",e.getLoaClassImage(e.character().loaClass),le),s(),m("routerLink",R(6,Ue)),s(3),m("formGroup",e.characterForm),s(12),S(e.loaClasses()),s(11),m("disabled",e.characterForm.invalid),s(3),m("routerLink",R(7,Ue))}}var qe=(()=>{class t{constructor(e,i,n){this.toastService=e,this.route=i,this.router=n,this.playerService=b(F),this.characterService=b(H),this.subs=[],this.getLoaClassImage=de,this.characterForm=new D({name:new g("",[v.required,v.pattern("[a-zA-Z]*")]),itemlevel:new g("",[v.required,v.min(0),v.max(ve)]),loaClass:new g("",[v.required]),player:new g("",v.required)}),this.playerChanges=$e(this.playerService.me$),this.player=this.playerService.me$,this.character=Fe(structuredClone(Se)),this.loaClasses=this.characterService.loaClasses$}ngOnInit(){var e=this.playerChanges.subscribe(n=>{n&&(this.character().player=n,this.characterForm.controls.player.setValue(n.name))}),i=this.characterService.characterChanges$.subscribe(n=>{n.change=="add"&&n.character.name==this.character.name&&(this.character.set(n.character),this.router.navigate([`/loa-assistant/characters/${n.character.id}`]))});this.subs.push(e,i)}ngOnDestroy(){for(let e of this.subs)e.unsubscribe()}cancel(){this.router.navigate(["."],{relativeTo:this.route.parent})}submit(){let e=this.character();e.name=this.characterForm.controls.name.value,e.itemlevel=this.characterForm.controls.itemlevel.value;var i=this.loaClasses().find(n=>n.name==this.characterForm.controls.loaClass.value);i?e.loaClass=i:this.toastService.show({header:"Character Creation Error",body:"Invalid Character Class",type:"warning",source_feature:"loa-assistant"}),this.character.set(e),console.log(this.character()),this.characterService.addCharacter(e)}reset(){let e=structuredClone(Se),i=this.player();i&&(e.player=i),this.character.set(e),this.characterForm.controls.name.reset(),this.characterForm.controls.itemlevel.reset(),this.characterForm.controls.loaClass.reset(),this.characterForm.controls.player.reset(i?.name)}static{this.\u0275fac=function(i){return new(i||t)(u(B),u(I),u(P))}}static{this.\u0275cmp=x({type:t,selectors:[["character-add"]],hostBindings:function(i,n){i&1&&C("keydown.escape",function(p){return n.cancel(p)},!1,Y)},decls:6,vars:1,consts:[[1,"_color-discord-content-text"],[1,"modal-backdrop"],[1,"modal","loa-character-add",2,"display","block"],[1,"modal-dialog","modal-dialog-centered","modal-dialog-scrollable","mw-75","_minw-25r","mx-auto"],[1,"modal-content","border","_minh-75"],[1,"modal-header","flex-column","gap-2"],[1,"d-flex","align-items-center","w-100","px-3"],[1,"modal-title","flex-grow-1"],[1,"flex-grow-1"],[1,"img-fluid","_class-image",3,"title","src"],["type","button","data-bs-backdrop","static","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"routerLink"],[1,"modal-body","d-flex"],[1,"d-flex","h-100","flex-column","gap-3",3,"submit","formGroup"],[1,"d-flex","gap-2"],[1,"form-floating","flex-grow-1"],["type","text","id","cName","formControlName","name","placeholder","Name",1,"form-control"],["for","cName"],[1,"form-floating","flex-shrink-0","w-10r"],["type","number","id","cLevel","formControlName","itemlevel","placeholder","Item Level",1,"form-control"],["for","cLevel"],[1,"form-floating","flex-shrink-0"],["formControlName","loaClass","id","cClass",1,"form-select"],[3,"value"],["for","cClass"],[1,"form-floating"],["type","text","readonly","","id","cPlayer","formControlName","player","placeholder","Player",1,"form-control-plaintext"],["for","cPlayer"],[1,"d-flex","flex-grow-1","align-items-end","justify-content-center","gap-2"],["type","button",1,"btn","btn-warning","flex-grow-1","mw-15r",3,"click"],["type","submit",1,"btn","btn-success","flex-grow-1","mw-15r",3,"disabled"],[1,"modal-footer","justify-content-end"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary",3,"routerLink"]],template:function(i,n){i&1&&(r(0,"div",0),a(1,"Loa Character Add / Edit"),o(),d(2,"div",1),_(3,ut,40,8),O(4,3,mt)),i&2&&(s(4),L(n.character))},dependencies:[A],styles:[".loa-character-add[_ngcontent-%COMP%]   .form-floating[_ngcontent-%COMP%]   .form-control-plaintext[_ngcontent-%COMP%]{color:var(--discord-menu-text)}._class-image[_ngcontent-%COMP%]{line-height:0;max-height:3rem;opacity:.5}"]})}}return t})();var ft=(t,c)=>c.id,ht=()=>[ee,q,W,K,ge,re,V,Q,te,ie,k,import("./chunk-IFULCIJQ.js").then(t=>t.CharacterRaidsEditComponent),import("./chunk-I5XIFQJY.js").then(t=>t.CharacterRepeatsEditComponent)],We=()=>["/loa-assistant/home"];function gt(t,c){if(t&1&&(r(0,"option",28),a(1),o()),t&2){let e=c.$implicit;m("value",e.name),s(),h(e.name)}}function vt(t,c){if(t&1){let e=J();r(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"div",6)(5,"h5",7),a(6),o(),r(7,"div",8),d(8,"img",9),o(),d(9,"button",10),o(),r(10,"ul",11)(11,"li",12)(12,"span",13),a(13,"Info"),o()(),r(14,"li",12)(15,"span",14),a(16,"Raids"),o()(),r(17,"li",12)(18,"span",15),a(19,"Repeats"),o()()()(),r(20,"div",16)(21,"div",17)(22,"form",18),C("submit",function(){M(e);let n=f();return T(n.submit(n.characterForm))}),r(23,"div",19)(24,"div",20),d(25,"input",21),r(26,"label",22),a(27,"Name"),o()(),r(28,"div",23),d(29,"input",24),r(30,"label",25),a(31,"Item Level"),o()()(),r(32,"div",26)(33,"select",27),y(34,gt,2,2,"option",28,ft),o(),r(36,"label",29),a(37,"Class"),o()(),r(38,"div",30),d(39,"input",31),r(40,"label",32),a(41,"Player"),o()(),r(42,"div",33)(43,"button",34),C("click",function(){M(e);let n=f();return T(n.reset(n.characterForm))}),a(44,"Reset"),o(),r(45,"button",35),a(46,"Save Changes"),o()()()(),r(47,"div",36),d(48,"character-raids-edit",37),o(),r(49,"div",38),d(50,"character-repeats-edit",37),o()(),r(51,"div",39)(52,"button",40),C("click",function(){M(e);let n=f();return T(n.characterDelete())}),a(53,"Delete"),o(),r(54,"button",41),a(55,"Cancel"),o()()()()()}if(t&2){let e=f();s(6),h(e.character.name),s(2),m("title",e.character.loaClass.name)("src",e.getLoaClassImage(e.character.loaClass),le),s(),m("routerLink",R(9,We)),s(13),m("formGroup",e.characterForm),s(12),S(e.loaClasses()),s(11),m("disabled",e.characterForm.invalid),s(3),m("character",e.character),s(2),m("character",e.character),s(4),m("routerLink",R(10,We))}}var ze=(()=>{class t{constructor(e,i,n){this.route=e,this.router=i,this.toastService=n,this.playerService=b(F),this.characterService=b(H),this.raidService=b(N),this.subs=[],this.getLoaClassImage=de,this.characterForm=new D({name:new g("",[v.required,v.pattern("[a-zA-Z]*")]),itemlevel:new g("",[v.required,v.min(0),v.max(ve)]),loaClass:new g("",[v.required]),player:new g("",v.required)}),this.loaClasses=this.characterService.loaClasses$}ngOnInit(){let e=this.route.snapshot.params.id;this.characterService.getById(e).subscribe({next:i=>this.characterFound(i),error:i=>this.characterNotFound(i)})}ngOnDestroy(){for(let e of this.subs)e.unsubscribe()}cancel(){this.router.navigate(["."],{relativeTo:this.route.parent})}characterFound(e){console.log(e),this.character=e;for(let[i,n]of Object.entries(this.characterForm.controls))switch(i){case"name":n.setValue(this.character.name);break;case"itemlevel":n.setValue(this.character.itemlevel);break;case"loaClass":break;case"player":n.setValue(this.character.player.name);break}this.characterForm.controls.loaClass.setValue(this.character.loaClass.name)}characterNotFound(e){console.log(e),this.toastService.show({header:"Character",body:`Character with id:${this.route.snapshot.params.id} not found`,type:"danger",source_feature:"loa-assistant"}),this.router.navigate(["."],{relativeTo:this.route.parent})}submit(e){e===this.characterForm&&this.characterEdit()}reset(e){e===this.characterForm&&this.characterReset()}characterEdit(){for(let[i,n]of Object.entries(this.characterForm.controls))switch(i){case"name":this.character.name=n.value;break;case"itemlevel":this.character.itemlevel=n.value;break;case"loaClass":var e=this.loaClasses().find(l=>l.name===n.value);e&&(this.character.loaClass=e);break;case"player":break}this.characterService.editCharacter(this.character)}characterReset(){for(let[e,i]of Object.entries(this.characterForm.controls))switch(e){case"name":i.reset(this.character.name);break;case"itemlevel":i.reset(this.character.itemlevel);break;case"loaClass":i.reset(this.character.loaClass.name);break;case"player":i.reset(this.character.player.name);break}}characterDelete(){confirm(`Are you sure wish to delete this character: '${this.character.name}' ?`)&&(this.characterService.deleteCharacter(this.character),this.router.navigate(["."],{relativeTo:this.route.parent}))}static{this.\u0275fac=function(i){return new(i||t)(u(I),u(P),u(B))}}static{this.\u0275cmp=x({type:t,selectors:[["loa-character-edit"]],hostBindings:function(i,n){i&1&&C("keydown.escape",function(p){return n.cancel(p)},!1,Y)},decls:6,vars:1,consts:[[1,"_color-discord-content-text"],[1,"modal-backdrop"],[1,"modal","loa-character-edit",2,"display","block"],[1,"modal-dialog","modal-dialog-centered","modal-dialog-scrollable","mw-75","_minw-25r","mx-auto"],[1,"modal-content","border","_minh-75"],[1,"modal-header","flex-column","gap-2"],[1,"d-flex","align-items-center","w-100","px-3"],[1,"modal-title","flex-grow-1"],[1,"flex-grow-1"],[1,"img-fluid","_class-image",3,"title","src"],["type","button","data-bs-backdrop","static","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"routerLink"],["role","tablist",1,"nav","nav-tabs","w-100","flex-nowrap","px-3"],["role","presentation",1,"nav-item"],["id","chrInfoTab","data-bs-toggle","tab","data-bs-target","#chrInfo","role","tab","aria-controls","chrInfo","aria-selected","false",1,"nav-link"],["id","chrRaidsTab","data-bs-toggle","tab","data-bs-target","#chrRaids","role","tab","aria-controls","chrRaids","aria-selected","true",1,"nav-link","active"],["id","chrRepeatsTab","data-bs-toggle","tab","data-bs-target","#chrRepeats","role","tab","aria-controls","chrRepeats","aria-selected","false",1,"nav-link"],[1,"modal-body","d-flex","tab-content"],["id","chrInfo","role","tabpanel","aria-labelledby","chrInfoTab",1,"tab-pane","fade","flex-grow-1"],[1,"d-flex","h-100","flex-column","gap-3",3,"submit","formGroup"],[1,"d-flex","gap-2"],[1,"form-floating","flex-grow-1"],["type","text","id","cName","formControlName","name","placeholder","Name",1,"form-control"],["for","cName"],[1,"form-floating","flex-shrink-0","w-10r"],["type","number","id","cLevel","formControlName","itemlevel","placeholder","Item Level",1,"form-control"],["for","cLevel"],[1,"form-floating","flex-shrink-0"],["formControlName","loaClass","id","cClass",1,"form-select"],[3,"value"],["for","cClass"],[1,"form-floating"],["type","text","readonly","","id","cPlayer","formControlName","player","placeholder","Player",1,"form-control-plaintext"],["for","cPlayer"],[1,"d-flex","flex-grow-1","align-items-end","justify-content-center","gap-2"],["type","button",1,"btn","btn-warning","flex-grow-1","mw-15r",3,"click"],["type","submit",1,"btn","btn-success","flex-grow-1","mw-15r",3,"disabled"],["id","chrRaids","role","tabpanel","aria-labelledby","chrRaidsTab",1,"tab-pane","fade","flex-grow-1","show","active"],[3,"character"],["id","chrRepeats","role","tabpanel","aria-labelledby","chrRepeatsTab",1,"tab-pane","fade","flex-grow-1"],[1,"modal-footer","justify-content-between"],["type","button",1,"btn","btn-danger",3,"click"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary",3,"routerLink"]],template:function(i,n){i&1&&(r(0,"div",0),a(1,"Loa Character Add / Edit"),o(),d(2,"div",1),_(3,vt,56,11),O(4,3,ht)),i&2&&(s(4),L(n.character))},dependencies:[ue,A,$],styles:[".loa-character-edit[_ngcontent-%COMP%]   .nav-tabs[_ngcontent-%COMP%]{border-color:var(--discord-menu-text)}.loa-character-edit[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{color:var(--discord-content-text)}.loa-character-edit[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover{cursor:pointer;border-color:var(--discord-menu-text)}.loa-character-edit[_ngcontent-%COMP%] > .modal-dialog[_ngcontent-%COMP%] > .modal-content[_ngcontent-%COMP%] > .modal-header[_ngcontent-%COMP%]{padding:1rem 0rem 0rem}.loa-character-edit[_ngcontent-%COMP%] > .modal-dialog[_ngcontent-%COMP%] > .modal-content[_ngcontent-%COMP%] > .modal-header[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{border-color:var(--discord-menu-text);border-bottom-color:transparent;background-color:var(--discord-menu)}.loa-character-edit[_ngcontent-%COMP%]   .form-floating[_ngcontent-%COMP%]   .form-control-plaintext[_ngcontent-%COMP%]{color:var(--discord-menu-text)}._class-image[_ngcontent-%COMP%]{line-height:0;max-height:3rem;opacity:.5}"]})}}return t})();var we=(t,c)=>c.id,bt=()=>[k],Ct=()=>[import("./chunk-527MARKQ.js").then(t=>t.GroupEditComponent),import("./chunk-PT4XS6NT.js").then(t=>t.LoaCharacterComponent),import("./chunk-43GZZAQW.js").then(t=>t.NonMutatingOrderByPipe),q,W,re,V,Ae,k],xt=()=>[import("./chunk-5N3FTQAW.js").then(t=>t.OrderByPipe),q,W],_t=()=>["/loa-assistant"],Ye=t=>["/loa-assistant/home/raids",t];function yt(t,c){if(t&1&&(r(0,"li",4)(1,"a",5),a(2,"Raids"),o()(),r(3,"li",6),a(4,"Groups"),o()),t&2){let e=f();s(),m("routerLink",j(1,Ye,e.raidpost.id))}}function St(t,c){if(t&1&&(r(0,"option",38),a(1),o()),t&2){let e=c.$implicit;m("value",e.name),s(),h(e.loaClass.name+" | "+e.itemlevel+" - "+e.player.name)}}function wt(t,c){if(t&1&&(r(0,"datalist",37),y(1,St,2,2,"option",38,we),X(3,"orderBy"),o()),t&2){let e=f(2);s(),S(Z(3,0,e.available,e.sortSignups))}}function Et(t,c){if(t&1&&d(0,"loa-character",24),t&2){let e=c.$implicit;m("character",e)("showPlayer",!0)}}function kt(t,c){if(t&1&&d(0,"group-edit",29),t&2){let e=c.$implicit,i=f(2);m("groupsFormArray",i.groupsFormArray)("raidpost",i.raidpost)("group",e)("available",i.available)}}function Rt(t,c){t&1&&(r(0,"div",30)(1,"h5"),a(2,"Raidpost currently has no groups"),o()())}function Pt(t,c){if(t&1){let e=J();_(0,wt,4,3),O(1,0,xt),Me(),r(3,"div",7)(4,"section",8)(5,"div",9)(6,"h5"),a(7),o(),r(8,"h5"),a(9),o(),r(10,"h5"),a(11),o()(),r(12,"div",10)(13,"select",11)(14,"option",12),a(15,"Full Auto"),o(),r(16,"option",13),a(17,"Semi Auto"),o(),r(18,"option",14),a(19,"Full Manual"),o()(),r(20,"label",15),a(21,"Mode"),o()()(),r(22,"section",16)(23,"div",17)(24,"div",18)(25,"div",19)(26,"h5",20)(27,"button",21),a(28,"Sign-ups"),o()(),r(29,"div",22)(30,"div",23),y(31,Et,1,2,"loa-character",24,we),X(33,"nonMutatingOrderBy"),o()()()(),r(34,"div",25)(35,"div",26)(36,"div",27)(37,"h3"),a(38,"Post mode must be set to 'Manual' to save changes"),o()()(),r(39,"div",28),y(40,kt,1,4,"group-edit",29,we,!1,Rt,3,0,"div",30),o()()(),r(43,"div")(44,"div",31)(45,"div",32)(46,"button",33),C("click",function(){M(e);let n=f();return T(n.addGroup())}),a(47,"Add Group"),o(),r(48,"button",34),C("click",function(){M(e);let n=f();return T(n.reset())}),a(49,"Reset"),o()(),r(50,"div",32)(51,"button",35),C("click",function(){M(e);let n=f();return T(n.submit())}),a(52,"Save Changes"),o(),r(53,"button",36),a(54,"Cancel"),o()()()()()()}if(t&2){let e=f();s(7),h(e.raidpost.name),s(2),h(e.raidpost.properties.loaRaid.name),s(2),h(e.raidTime(e.raidpost.properties.startTime)),s(2),m("formControl",e.raidMode),s(18),S(Z(33,8,e.raidpost.signups,e.sortSignups)),s(4),m("hidden",e.validMode),s(5),S(e.raidpost.groups),s(11),m("disabled",!e.validMode),s(2),m("routerLink",j(11,Ye,e.raidpost.id))}}var Je=(()=>{class t{constructor(e,i,n,l){this.route=e,this.router=i,this.toastService=n,this.idGen=l,this.playerService=b(F),this.groupEditService=b(He),this.loaRaidService=b(N),this.available=[],this.raidTime=oe,this.subs=[],this.groupsFormArray=new Ne([]),this.raidForm=new D({groups:this.groupsFormArray}),this.raidMode=new g("FULL_AUTO")}ngOnInit(){let e=this.route.snapshot.params.id;var i=this.loaRaidService.getById(e).subscribe({next:l=>{this.raidpost=l,this.raidMode.reset(l.properties.mode),this.groupsBackup=[...this.raidpost.groups],this.available=[...this.raidpost.signups]},error:l=>{this.router.navigate(["loa-assistant"]),console.log(l)}}),n=this.loaRaidService.raidChanges$.subscribe(l=>{l.change=="groups"?(console.log(l.raidpost),this.groupsBackup=l.raidpost.groups,this.groupEditService.save()):l.change=="edit"&&(this.raidpost=l.raidpost,this.groupsBackup=l.raidpost.groups,this.raidMode.reset(this.raidpost.properties.mode))});this.subs.push(i,n)}ngOnDestroy(){for(let e of this.subs)e.unsubscribe();this.toastService.clear()}get validMode(){return this.raidMode.value.toLowerCase().includes("manual")}addGroup(){this.raidpost.groups.push({id:this.idGen.nextGroupId,name:`Group ${this.raidpost.groups.length+1}`,parties:[],raid:this.raidpost}),console.log(this.raidpost.groups)}submit(){if(!this.validMode){this.raidpost.properties.mode=this.raidMode.value,this.toastService.show({header:"Raid Mode",body:"Mode for post must be set to MANUAL to edit groups",type:"warning",source_feature:"loa-assistant",delay:5e3});return}let e=this.parseGroupInput(this.groupsFormArray.value);this.raidpost.groups=e,this.loaRaidService.groups(this.raidpost)}reset(){this.raidpost.groups=[...this.groupsBackup],Object.assign(this.available,this.raidpost.signups),this.groupsFormArray.clear(),this.groupEditService.reset()}sortC(e,i){return e.name.localeCompare(i.name,void 0,{sensitivity:"base"})}sortSignups(e,i){let n=e.player.name.localeCompare(i.player.name,void 0,{sensitivity:"base"});return n!=0?n:e.name.localeCompare(i.name,void 0,{sensitivity:"base"})}notAssigned(e){for(let i of this.groupsFormArray.controls)for(let n of i.get("partys").controls)for(let l of n.controls)if(l.value==e.id)return!1;return!0}cloneRaidpost(e){let i=structuredClone(e);return delete i.groups,i}parseGroupInput(e){var i=[];let n=this.cloneRaidpost(this.raidpost);for(let l of e){let p={id:l.groupId,name:`Group ${i.length+1}`,raid:n},E=this.parsePartyInput(l.partys);for(let w of E)w.group=structuredClone(p);p.parties=E,i.push(p)}return i}parsePartyInput(e){let i=[];if(e.length==0)return i;for(let n of e){let l=this.parseMemberInput(n),p={id:0,name:`Party ${i.length+1}`,members:l};i.push(p)}return i}parseMemberInput(e){let i=[];console.log(e);for(let n of e){let l=this.raidpost.signups.find(p=>p.id==n);if(l){i.push(l);continue}l=this.raidpost.signups.find(p=>p.name.toLowerCase()==n.toLowerCase()),l&&i.push(l)}return i}static{this.\u0275fac=function(i){return new(i||t)(u(I),u(P),u(B),u(Ve))}}static{this.\u0275cmp=x({type:t,selectors:[["edit-raid-groups"]],inputs:{raidpost:"raidpost"},decls:13,vars:4,consts:[[1,"container-xxl","d-flex","flex-column","raid-group-edit"],[1,"d-flex","w-100","pt-2","border-secondary","border-bottom"],["aria-label","breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],[3,"routerLink"],["aria-current","page",1,"breadcrumb-item","active"],[1,"raid-group-edit","d-flex","flex-column","gap-3","_color-discord-menu-text"],[1,"d-flex","flex-column","gap-2","pt-3"],[1,"d-flex","justify-content-between","align-items-center"],[1,"form-floating"],["id","raidMode",1,"form-select","form-select-lg",3,"formControl"],["value","FULL_AUTO"],["value","SEMI_AUTO"],["value","FULL_MANUAL"],["for","raidMode"],[1,"vh-100","edit-section"],[1,"group-edit-section","flex-grow-1","overflow-hidden"],["id","signupsSection",1,"signups-section","accordion","overflow-y-auto"],[1,"accordion-item"],["id","signupListHeader",1,"accordion-header"],["data-bs-toggle","collapse","href","#signupList","role","button","aria-expanded","true","aria-controls","signupList",1,"accordion-button"],["id","signupList","aria-labelledby","signupListHeader","data-bs-parent","signupsSection",1,"accordion-collapse","collapse","collapse","show"],[1,"signups-list"],[1,"",3,"character","showPlayer"],[1,"groups","overflow-y-scroll"],[1,"position-sticky","sticky-top",3,"hidden"],[1,"text-center","bg-warning","text-black","p-2"],[1,"d-flex","flex-column","gap-3","px-2"],[1,"w-100",3,"groupsFormArray","raidpost","group","available"],[1,"text-center"],[1,"row","g-3"],[1,"col-6","d-flex","gap-2"],[1,"btn","btn-primary","flex-grow-1",3,"click"],[1,"btn","btn-warning","flex-grow-1",3,"click"],[1,"btn","btn-success","flex-grow-1",3,"click","disabled"],[1,"btn","btn-secondary","flex-grow-1",3,"routerLink"],["id","raidSignups"],[3,"value"]],template:function(i,n){i&1&&(r(0,"div",0)(1,"div",1)(2,"nav",2)(3,"ol",3)(4,"li",4)(5,"a",5),a(6,"Home"),o()(),_(7,yt,5,3),O(8,7,bt),o()()(),_(10,Pt,55,13),O(11,10,Ct),o()),i&2&&(s(5),m("routerLink",R(3,_t)),s(3),L(n.raidpost),s(3),L(n.raidpost))},dependencies:[A,$,k],styles:[".edit-section[_ngcontent-%COMP%]{display:grid;grid-template-rows:1fr auto;gap:1rem}.group-edit-section[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto 1fr;gap:.5rem;padding-top:.5rem;padding-bottom:.5rem}.raid-group-edit[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:var(--discord-type)}.signups-section[_ngcontent-%COMP%]   .accordion-button[_ngcontent-%COMP%]{border:none;box-shadow:none}.signups-section[_ngcontent-%COMP%]   .accordion-item[_ngcontent-%COMP%]{border:none}.signups-list[_ngcontent-%COMP%]{display:flex;max-width:28rem;flex-flow:row wrap;gap:.75rem;padding:.25rem;overflow-y:auto}.ttt[_ngcontent-%COMP%]{height:100%;position:relative}.groups[_ngcontent-%COMP%]::-webkit-scrollbar, .signups-list[_ngcontent-%COMP%]::-webkit-scrollbar{width:10px}.groups[_ngcontent-%COMP%]::-webkit-scrollbar-track   .signups-list[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent;margin:0}.groups[_ngcontent-%COMP%]::-webkit-scrollbar-thumb, .signups-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#888;background:var(--discord-menu-text);border-radius:3px}.groups[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover, .signups-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#555}@media (max-width:1000px){.group-edit-section[_ngcontent-%COMP%]{grid-template-columns:14rem 1fr}}@media (max-width:780px){.group-edit-section[_ngcontent-%COMP%]{grid-template-columns:1fr}.signups-section[_ngcontent-%COMP%]{order:2;align-self:end}.signups-list[_ngcontent-%COMP%]{max-width:none;flex-flow:row nowrap}}"]})}}return t})();var Xe=(t,c)=>c.id,Ze=()=>["/loa-assistant/home"];function Ft(t,c){t&1&&d(0,"i",7)}function Mt(t,c){if(t&1&&(r(0,"option",22),a(1),o()),t&2){let e=c.$implicit;m("value",e.name),s(),h(e.name)}}function Tt(t,c){if(t&1&&(r(0,"option",22),a(1),o()),t&2){let e=c.$implicit;m("value",e.name),s(),h(e.name)}}var Ke=(()=>{class t{constructor(e,i,n){this.route=e,this.router=i,this.toastService=n,this.playerService=b(F),this.raidService=b(N),this.subs=[],this.raidForm=new D({}),this.raidForm.setControl("name",new g("",v.required)),this.raidForm.setControl("server",new g("",v.required)),this.raidForm.setControl("loaRaid",new g("",v.required)),this.raidForm.setControl("startTime",new g("",v.required)),this.raidForm.setControl("type",new g("",v.required)),this.loaRaids=this.raidService.loaRaids$,this.servers=this.playerService.myServers$}ngOnInit(){var e=this.raidService.raidChanges$.subscribe(i=>{i.change=="add"&&i.raidpost.name==this.raidpost?.name&&(this.raidpost=i.raidpost,this.router.navigate([`/loa-assistant/raids/${this.raidpost.id}`]))});this.subs.push(e)}ngOnDestroy(){for(let e of this.subs)e.unsubscribe()}cancel(){this.router.navigate(["."],{relativeTo:this.route.parent})}reset(){this.raidForm.reset(),this.raidpost=void 0}submit(){var e=this.raidForm.controls.name.value,i=this.servers().find(w=>w.name==this.raidForm.controls.server.value);i||this.toastService.show({header:"Raidpost Creation Error",body:"Invalid Server",type:"warning",source_feature:"loa-assistant"});var n=this.loaRaids().find(w=>w.name==this.raidForm.controls.loaRaid.value);n||this.toastService.show({header:"Raidpost Creation Error",body:"Invalid Raid",type:"warning",source_feature:"loa-assistant"});var l=this.raidForm.controls.startTime.value,p=this.raidForm.controls.type.value;if(!(!i||!n)){var E={type:p,id:"0",name:e,server:i,postProperties:{postTime:new Date,channelId:"",messageId:"",mentions:[]},properties:{startTime:pe(l),publishMessageId:"",remainderMessageId:"",loaRaid:n,playerCount:n.playerCount,mode:"FULL_AUTO"},signups:[],groups:[],remainders:[]};console.log(E),this.raidpost=E,this.raidService.addPost(this.raidpost)}}static{this.\u0275fac=function(i){return new(i||t)(u(I),u(P),u(B))}}static{this.\u0275cmp=x({type:t,selectors:[["raid-add"]],hostBindings:function(i,n){i&1&&C("keydown.escape",function(p){return n.cancel(p)},!1,Y)},decls:56,vars:7,consts:[[1,"modal-backdrop"],[1,"modal","raid-post-edit",2,"display","block"],[1,"modal-dialog","modal-dialog-centered","modal-dialog-scrollable","mw-75","_minw-25r","mx-auto"],[1,"modal-content","border","_minh-75"],[1,"modal-header","flex-column","gap-2"],[1,"edit-modal-header-top","w-100","px-3"],[1,"my-auto","flex-grow-1"],[1,"bi-arrow-clockwise","repeat-symbol"],["type","button","data-bs-backdrop","static","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"routerLink"],[1,"modal-body","d-flex"],["id","raidEdit",1,"flex-grow-1"],[1,"h-100","d-flex","flex-column"],[1,"alert","alert-warning","d-flex","align-items-center","justify-content-center","p-0","text-center","border-2","border-warning"],[1,"bi-exclamation","float-start","fs-2"],[1,"bi-exclamation","float-end","fs-2"],[1,"d-flex","flex-grow-1","flex-column","gap-3",3,"submit","formGroup"],[1,"form-floating"],["type","text","id","rName","formControlName","name","placeholder","Name",1,"form-control"],["for","rName"],[1,"d-flex","gap-2"],[1,"form-floating","flex-grow-1"],["id","rServer","formControlName","server",1,"form-select"],[3,"value"],["for","rServer"],[1,"form-floating","flex-shrink-0","w-10r"],["id","rLoaRaid","formControlName","loaRaid",1,"form-select"],["for","rLoaRaid"],["type","datetime-local","id","rStartTime","formControlName","startTime","placeholder","Start Time",1,"form-control"],["for","rStartTime"],["id","rType","formControlName","type",1,"form-select"],["value","raidpost"],["value","repeatingpost"],["for","rType"],[1,"d-flex","flex-grow-1","align-items-end","justify-content-center","gap-2"],["type","button",1,"btn","btn-warning","flex-grow-1","mw-15r",3,"click"],["type","submit",1,"btn","btn-success","flex-grow-1","mw-15r",3,"disabled"],[1,"modal-footer","justify-content-end"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary",3,"routerLink"]],template:function(i,n){i&1&&(d(0,"div",0),r(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"h5",6),a(7,"Add Raidpost"),o(),_(8,Ft,1,0,"i",7),d(9,"button",8),o()(),r(10,"div",9)(11,"div",10)(12,"div",11)(13,"div",12),d(14,"i",13),r(15,"span"),a(16,"Note that you must have permissions to manage raids in this post's Discord server"),o(),d(17,"i",14),o(),r(18,"form",15),C("submit",function(){return n.submit()}),r(19,"div",16),d(20,"input",17),r(21,"label",18),a(22,"Name"),o()(),r(23,"div",19)(24,"div",20)(25,"select",21),y(26,Mt,2,2,"option",22,Xe),o(),r(28,"label",23),a(29,"Server"),o()(),r(30,"div",24)(31,"select",25),y(32,Tt,2,2,"option",22,Xe),o(),r(34,"label",26),a(35,"Raid"),o()()(),r(36,"div",16),d(37,"input",27),r(38,"label",28),a(39,"Start Time"),o()(),r(40,"div",16)(41,"select",29)(42,"option",30),a(43,"No"),o(),r(44,"option",31),a(45,"Yes"),o()(),r(46,"label",32),a(47,"Repeating Post?"),o()(),r(48,"div",33)(49,"button",34),C("click",function(){return n.reset()}),a(50,"Reset"),o(),r(51,"button",35),a(52,"Add Post"),o()()()()()(),r(53,"div",36)(54,"button",37),a(55,"Cancel"),o()()()()()),i&2&&(s(8),U((n.raidpost==null?null:n.raidpost.type)=="repeatingpost"?8:-1),s(),m("routerLink",R(5,Ze)),s(9),m("formGroup",n.raidForm),s(8),S(n.servers()),s(6),S(n.loaRaids()),s(19),m("disabled",!n.raidForm.valid),s(3),m("routerLink",R(6,Ze)))},dependencies:[A,ee,q,W,K,re,V,Q,te,ie,k],styles:[".edit-modal-header-top[_ngcontent-%COMP%]{position:relative;display:flex;flex-flow:row nowrap;align-items:center}.repeat-symbol[_ngcontent-%COMP%]{position:absolute;left:50%;transform:translate(-50%);font-size:2rem;line-height:0;animation:_ngcontent-%COMP%_spin 4s linear infinite}.loaClassImage[_ngcontent-%COMP%]{height:1.5rem}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}"]})}}return t})();var Ot=(t,c)=>c.id,Lt=()=>[k,ee,K,V,Q,te,ie,import("./chunk-UANRTKRB.js").then(t=>t.RaidGroupComponent)],Qe=()=>["/loa-assistant/home"],It=t=>[t];function Dt(t,c){t&1&&d(0,"i",7)}function At(t,c){if(t&1&&(r(0,"div",19)(1,"span",18),a(2),o(),r(3,"span",18),a(4),o(),r(5,"span",18),a(6),o()()),t&2){let e=f(2);s(2),h("Me : "+e.counts.me.total),s(2),h("DPS : "+e.counts.me.dps),s(2),h("SUP : "+e.counts.me.sup)}}function Nt(t,c){if(t&1&&(r(0,"div")(1,"div"),d(2,"img",53),o(),r(3,"div",54),a(4),o(),r(5,"div"),a(6),o()()),t&2){let e=c.$implicit,i=f(2);s(2),m("title",e.loaClass.name)("alt",e.loaClass.name)("src",i.getLoaClassImage(e.loaClass),le),s(),Te(i.characterIsMine$(e)),m("title",e.name),s(),h(e.name),s(2),h(e.itemlevel)}}function Gt(t,c){t&1&&(r(0,"div")(1,"span"),a(2,"No Remainders"),o()())}function jt(t,c){if(t&1&&d(0,"raid-group",24),t&2){let e=c.$implicit;m("group",e)}}function $t(t,c){t&1&&(r(0,"div")(1,"span"),a(2,"No Current Groups"),o()())}function Vt(t,c){if(t&1){let e=J();r(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"h5",6),a(6),o(),_(7,Dt,1,0,"i",7),d(8,"button",8),o(),r(9,"ul",9)(10,"li",10)(11,"span",11),a(12,"Info"),o()(),r(13,"li",10)(14,"span",12),a(15,"Groups"),o()(),r(16,"li",10)(17,"span",13),a(18,"Edit"),o()()()(),r(19,"div",14)(20,"div",15)(21,"div")(22,"h4"),a(23),o()(),r(24,"div")(25,"strong"),a(26),o()(),r(27,"div"),a(28),o(),r(29,"div",16)(30,"div",17)(31,"span",18),a(32),o(),r(33,"span",18),a(34),o(),r(35,"span",18),a(36),o()(),_(37,At,7,3,"div",19),o(),r(38,"div",20)(39,"h5"),a(40,"Remainders"),o(),r(41,"div",21),y(42,Nt,7,8,"div",null,Ot,!1,Gt,3,0,"div"),o()()(),r(45,"div",22)(46,"div",23),y(47,jt,1,1,"raid-group",24,Oe,!1,$t,3,0,"div"),o()(),r(50,"div",25)(51,"div",26)(52,"div",27),d(53,"i",28),r(54,"span"),a(55,"Note that you must have permissions to manage raids in this post's Discord server"),o(),d(56,"i",29),o(),r(57,"form",30),C("submit",function(){M(e);let n=f();return T(n.submit())}),r(58,"div",31),d(59,"input",32),r(60,"label",33),a(61,"Name"),o()(),r(62,"div",34)(63,"div",35),d(64,"input",36),r(65,"label",37),a(66,"Server"),o()(),r(67,"div",38),d(68,"input",39),r(69,"label",40),a(70,"Raid"),o()()(),r(71,"div",31),d(72,"input",41),r(73,"label",42),a(74,"Post Time"),o()(),r(75,"div",31),d(76,"input",43),r(77,"label",44),a(78,"Start Time"),o()(),r(79,"div",45)(80,"a",46),a(81,"Edit Groups"),o()(),r(82,"div",47)(83,"button",48),C("click",function(){M(e);let n=f();return T(n.reset())}),a(84,"Reset"),o(),r(85,"button",49),a(86,"Save Changes"),o()()()()()(),r(87,"div",50)(88,"button",51),C("click",function(){M(e);let n=f();return T(n.delete())}),a(89,"Delete"),o(),r(90,"button",52),a(91,"Cancel"),o()()()()()}if(t&2){let e=f();s(6),h(e.raidpost.properties.loaRaid.name),s(),U(e.raidpost.type=="repeatingpost"?7:-1),s(),m("routerLink",R(16,Qe)),s(15),h(e.raidpost.name),s(3),h(e.raidTime(e.raidpost.properties.startTime)),s(2),h(e.raidpost.server.name),s(4),h("All : "+e.counts.all.total),s(2),h("DPS : "+e.counts.all.dps),s(2),h("SUP : "+e.counts.all.sup),s(),U(e.player()?37:-1),s(5),S(e.raidpost.remainders),s(5),S(e.groups),s(10),m("formGroup",e.raidForm),s(23),m("routerLink",j(17,It,e.editGroupsLink)),s(5),m("disabled",!e.raidForm.valid),s(5),m("routerLink",R(19,Qe))}}var et=(()=>{class t{constructor(e,i){this.route=e,this.router=i,this.playerService=b(F),this.characterService=b(H),this.raidService=b(N),this.subs=[],this.raidTime=oe,this.getLoaClassImage=de,this.raidForm=new D({}),this.player=this.playerService.me$}ngOnInit(){let e=this.route.snapshot.params.id;this.raidService.getById(e).subscribe({next:n=>this.raidpostFound(n),error:n=>this.raidpostNotFound(n)});var i=this.raidService.raidChanges$.subscribe(n=>{n.change=="edit"&&n.raidpost.id==this.raidpost?.id&&(this.backupPost=structuredClone(n.raidpost),this.raidpost=n.raidpost)});this.subs.push(i)}ngOnDestroy(){for(let e of this.subs)e.unsubscribe()}cancel(){this.router.navigate(["."],{relativeTo:this.route.parent})}raidpostFound(e){console.log(e),this.raidpost=e,this.backupPost=structuredClone(e),this.groups=e.groups,this.editGroupsLink=`/loa-assistant/raids/${this.raidpost.id}/edit/groups`,this.raidForm.setControl("name",new g(this.backupPost.name,v.required)),this.raidForm.setControl("server",new g(this.backupPost.server.name,v.required)),this.raidForm.setControl("loaRaid",new g(this.backupPost.properties.loaRaid.name,v.required)),this.raidForm.setControl("postTime",new g(me(this.backupPost.postProperties.postTime),v.required)),this.raidForm.setControl("startTime",new g(me(this.backupPost.properties.startTime),v.required))}raidpostNotFound(e){this.router.navigate(["."],{relativeTo:this.route.parent}),console.log(e)}get counts(){return Be(this.raidpost,this.player())}submit(){let e=this.raidpost;for(let[i,n]of Object.entries(this.raidForm.controls))switch(i){case"name":e.name=n.value;break;case"server":break;case"loaRaid":break;case"postTime":e.postProperties.postTime=pe(n.value);break;case"startTime":e.properties.startTime=pe(n.value);break}this.raidService.editPost(this.raidpost)}reset(){this.raidForm.controls.name.reset(this.backupPost.name),this.raidForm.controls.server.reset(this.backupPost.server.name),this.raidForm.controls.loaRaid.reset(this.backupPost.properties.loaRaid.name),this.raidForm.controls.postTime.reset(me(this.backupPost.postProperties.postTime)),this.raidForm.controls.startTime.reset(me(this.backupPost.properties.startTime))}delete(){confirm(`Are you sure wish to delete this raidpost: '${this.raidpost.name}' ?`)&&(this.raidService.deletePost(this.raidpost),this.router.navigate(["."],{relativeTo:this.route.parent}))}characterIsMine$(e){return e.player.id===this.player()?.id?{color:"lightskyblue"}:{}}static{this.\u0275fac=function(i){return new(i||t)(u(I),u(P))}}static{this.\u0275cmp=x({type:t,selectors:[["raid-edit"]],hostBindings:function(i,n){i&1&&C("keydown.escape",function(p){return n.cancel(p)},!1,Y)},decls:4,vars:1,consts:[[1,"modal-backdrop"],[1,"modal","raid-post-edit",2,"display","block"],[1,"modal-dialog","modal-dialog-centered","modal-dialog-scrollable","mw-75","_minw-25r","mx-auto"],[1,"modal-content","border","_minh-75"],[1,"modal-header","flex-column","gap-2"],[1,"edit-modal-header-top","w-100","px-3"],[1,"my-auto","flex-grow-1"],[1,"bi-arrow-clockwise","repeat-symbol"],["type","button","data-bs-backdrop","static","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"routerLink"],["role","tablist",1,"nav","nav-tabs","w-100","flex-nowrap","px-3"],["role","presentation",1,"nav-item"],["id","raidInfoTab","data-bs-toggle","tab","data-bs-target","#raidInfo","role","tab","aria-controls","raidInfo","aria-selected","true",1,"nav-link","active"],["id","raidGroupsTab","data-bs-toggle","tab","data-bs-target","#raidGroups","role","tab","aria-controls","raidGroups","aria-selected","false",1,"nav-link"],["id","raidEditTab","data-bs-toggle","tab","data-bs-target","#raidEdit","role","tab","aria-controls","raidEdit","aria-selected","false",1,"nav-link"],[1,"modal-body","d-flex","tab-content"],["id","raidInfo","role","tabpanel","aria-labelledby","raidInfoTab",1,"tab-pane","fade","flex-grow-1","show","active"],[1,"border-top","border-secondary","pt-1","gap-1","my-2"],[1,"row"],[1,"col-4"],[1,"row","text-success"],[1,"text-center","pt-3"],[1,"d-flex","flex-wrap","gap-3","justify-content-center"],["id","raidGroups","role","tabpanel","aria-labelledby","raidGroupsTab",1,"tab-pane","fade","flex-grow-1"],[1,"d-flex","flex-wrap","gap-4","align-items-center","justify-content-center"],[3,"group"],["id","raidEdit","role","tabpanel","aria-labelledby","raidEditTab",1,"tab-pane","fade","flex-grow-1"],[1,"h-100","d-flex","flex-column"],[1,"alert","alert-warning","d-flex","align-items-center","justify-content-center","p-0","text-center","border-2","border-warning"],[1,"bi-exclamation","float-start","fs-2"],[1,"bi-exclamation","float-end","fs-2"],[1,"d-flex","flex-grow-1","flex-column","gap-3",3,"submit","formGroup"],[1,"form-floating"],["type","text","id","rName","formControlName","name","placeholder","Name",1,"form-control"],["for","rName"],[1,"d-flex","gap-2"],[1,"form-floating","flex-grow-1"],["type","text","readonly","","id","rServer","formControlName","server","placeholder","Server",1,"form-control-plaintext"],["for","rServer"],[1,"form-floating","flex-shrink-0","w-10r"],["type","text","readonly","","id","rLoaRaid","formControlName","loaRaid","placeholder","LoaRaid",1,"form-control-plaintext"],["for","rLoaRaid"],["type","datetime-local","id","rPostTime","formControlName","postTime","placeholder","Post Time",1,"form-control"],["for","rPostTime"],["type","datetime-local","id","rStartTime","formControlName","startTime","placeholder","Start Time",1,"form-control"],["for","rStartTime"],[1,"text-center"],[3,"routerLink"],[1,"d-flex","flex-grow-1","align-items-end","justify-content-center","gap-2"],["type","button",1,"btn","btn-warning","flex-grow-1","mw-15r",3,"click"],["type","submit",1,"btn","btn-success","flex-grow-1","mw-15r",3,"disabled"],[1,"modal-footer","justify-content-between"],["type","button",1,"btn","btn-danger",3,"click"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary",3,"routerLink"],[1,"loaClassImage",3,"title","alt","src"],[1,"flex-grow-1","text-truncate",3,"title"]],template:function(i,n){i&1&&(d(0,"div",0),_(1,Vt,92,20),O(2,1,Lt)),i&2&&(s(2),L(n.raidpost))},dependencies:[ue,$,A],styles:[".raid-post-edit[_ngcontent-%COMP%]   .nav-tabs[_ngcontent-%COMP%]{border-color:var(--discord-menu-text)}.raid-post-edit[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{color:var(--discord-content-text)}.raid-post-edit[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover{cursor:pointer;border-color:var(--discord-menu-text)}.raid-post-edit[_ngcontent-%COMP%] > .modal-dialog[_ngcontent-%COMP%] > .modal-content[_ngcontent-%COMP%] > .modal-header[_ngcontent-%COMP%]{padding:1rem 0rem 0rem}.raid-post-edit[_ngcontent-%COMP%] > .modal-dialog[_ngcontent-%COMP%] > .modal-content[_ngcontent-%COMP%] > .modal-header[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{border-color:var(--discord-menu-text);border-bottom-color:transparent;background-color:var(--discord-menu)}.raid-post-edit[_ngcontent-%COMP%]   .form-floating[_ngcontent-%COMP%]   .form-control-plaintext[_ngcontent-%COMP%]{color:var(--discord-menu-text)}._class-image[_ngcontent-%COMP%]{line-height:0;max-height:3rem;opacity:.5}.filter-symbol[_ngcontent-%COMP%]{position:absolute;left:1rem;top:50%;transform:translateY(-50%);font-size:1.75rem;line-height:0}.edit-modal-header-top[_ngcontent-%COMP%]{position:relative;display:flex;flex-flow:row nowrap;align-items:center}.edit-modal-tablist[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;padding-left:1rem;padding-right:1rem;width:100%}.repeat-symbol[_ngcontent-%COMP%]{position:absolute;left:50%;transform:translate(-50%);font-size:2rem;line-height:0;animation:_ngcontent-%COMP%_spin 4s linear infinite}.loaClassImage[_ngcontent-%COMP%]{height:1.5rem}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}"]})}}return t})();var ne=class t extends Ie{static{this.url=`${De.loa()}/oauth`}constructor(){super(`${t.url}/url`,`${t.url}/tokens`,`${t.url}/refresh`)}isValid(){return this.http.get(`${t.url}/valid`)}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275prov=Pe({token:t,factory:t.\u0275fac,providedIn:"root"})}};var it=(t,c)=>{let e=b(P),i=b(he),n=b(ne),l=()=>(e.navigate(["/loa-assistant/login"]),c.url,Ee);return i.check("loa-tokens")?n.isValid().pipe(ke(p=>p||l()),Re((p,E)=>l())):l()};var Bt=(t,c)=>c.id;function Ht(t,c){if(t&1&&(r(0,"div",3)(1,"h5",1),a(2),o(),r(3,"div",5)(4,"p"),a(5),o()()()),t&2){let e=c.$implicit;s(2),h(e.name),s(3),h(e.statement)}}function Ut(t,c){t&1&&(r(0,"div",4)(1,"h5"),a(2,"No Current Announcements"),o()())}var rt=(()=>{class t{constructor(){this.announcements=[]}ngOnInit(){}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=x({type:t,selectors:[["announcements"]],inputs:{announcements:"announcements"},decls:7,vars:1,consts:[[1,"card","announcements"],[1,"card-header"],[1,"card-body","overflow-y-auto"],[1,"card","announcement"],[1,"text-center"],[1,"card-body"]],template:function(i,n){i&1&&(r(0,"div",0)(1,"h5",1),a(2,"Announcements"),o(),r(3,"div",2),y(4,Ht,6,2,"div",3,Bt,!1,Ut,3,0,"div",4),o()()),i&2&&(s(4),S(n.announcements))},styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;overflow:hidden}.announcements[_ngcontent-%COMP%]{flex:1;overflow:hidden}.announcements[_ngcontent-%COMP%] > .card-body[_ngcontent-%COMP%]{overflow-y:auto}.announcement[_ngcontent-%COMP%] > .card-body[_ngcontent-%COMP%] > p[_ngcontent-%COMP%]{white-space:pre-line}"]})}}return t})();var Wt=(t,c)=>c.id,zt=()=>[import("./chunk-5N3FTQAW.js").then(t=>t.OrderByPipe),k],Yt=t=>["raids",t];function Jt(t,c){if(t&1&&d(0,"i"),t&2){let e=f().$implicit,i=f(2);ye("bi-arrow-clockwise repeat-symbol "+i.repeatColor(e))}}function Xt(t,c){if(t&1&&(r(0,"div",10),d(1,"div"),r(2,"h5",12)(3,"span",13),a(4),o(),r(5,"span",14),a(6),o()(),r(7,"div",15)(8,"div",16),a(9),o(),_(10,Jt,1,2,"i",17),o()()),t&2){let e=c.$implicit,i=f(2);m("routerLink",j(9,Yt,e.id)),s(),ye("p-1 rounded "+i.raidColor(e)),s(2),m("title",e.name),s(),h(e.name),s(2),h(e.properties.loaRaid.name),s(2),m("title",i.raidTime(e.properties.startTime)),s(),h(i.raidTime(e.properties.startTime)),s(),U(e.type=="repeatingpost"?10:-1)}}function Zt(t,c){t&1&&(r(0,"div",11)(1,"h5"),a(2,"You have no available raids"),o()())}function Kt(t,c){if(t&1&&(y(0,Xt,11,11,"div",10,Wt,!1,Zt,3,0,"div",11),X(3,"orderBy")),t&2){let e=f();S(Z(3,1,e.upcomingRaids,e.sort))}}var ot=(()=>{class t{constructor(e){this.playerService=e,this.raidposts=[],this.subs=[],this.raidTime=oe,this.sort=Ce,this.raidFilterForm=new D({raid:new g("Any"),server:new g("Any"),status:new g("Any")})}ngOnInit(){this.player||(this.player=this.playerService.me$())}ngOnDestroy(){for(let e of this.subs)e.unsubscribe()}get upcomingRaids(){let e=[...this.raidposts];for(let[i,n]of Object.entries(this.raidFilterForm.controls))if(n.value!="Any")switch(i){case"raid":e=e.filter(l=>l.properties.loaRaid.name==n.value||n.value==="");break;case"server":e=e.filter(l=>l.server.name==n.value||n.value==="");break;case"status":if(!this.player)break;n.value=="Not Signed Up"?e=e.filter(l=>!l.signups.find(p=>p.player.id==this.player?.id)):n.value=="Signed Up"&&(e=e.filter(l=>l.signups.find(p=>p.player.id==this.player?.id)));break}return e}inRaid(e){if(!this.player)return!1;for(let i of e.signups)if(i.player.id==this.player.id)return!0;return!1}inRepeat(e){if(!this.player)return!1;let i=e;for(let n of i?.repeatingSignups)if(n.player.id==this.player?.id)return!0;return!1}raidColor(e){if(this.player)return this.inRaid(e)?"bg-success":"bg-danger"}repeatColor(e){if(this.player)return this.inRepeat(e)?"text-success":"text-danger"}color(e){for(let i of e.signups)if(i.player.id===this.player?.id)return{"background-color":"yellowgreen"};return{"background-color":"lightcoral"}}static{this.\u0275fac=function(i){return new(i||t)(u(F))}}static{this.\u0275cmp=x({type:t,selectors:[["loa-upcoming-raids"]],inputs:{raidposts:"raidposts",player:"player"},decls:17,vars:2,consts:[[1,"card","loa-upcoming-raids"],[1,"card-header","d-flex"],[1,"m-0"],["id","upcomingRaidsFilter","title","Filter Upcoming Raids","data-bs-toggle","dropdown","data-bs-auto-close","outside","aria-expanded","false",1,"bi-filter","filter-symbol","_color-discord-menu-text"],[1,"dropdown","filter-dropdown"],["aria-labelledby","upcomingRaidsFilter",1,"dropdown-menu","w-20r","raid-filter"],[1,"dropdown-header"],[1,"raid-filter",3,"filterForm"],[1,"upcoming-raid-list","card-body","d-flex","flex-column","gap-2"],[1,"d-flex","gap-2"],[1,"card","loa-upcoming-raid",3,"routerLink"],[1,"text-center"],[1,"card-subtitle","d-flex","flex-nowrap","justify-content-between"],[1,"text-nowrap","text-truncate",3,"title"],[1,"fs-6","align-self-end","text-nowrap"],[1,"d-flex","flex-nowrap","justify-content-between"],[1,"fs-6","text-truncate",3,"title"],[3,"class"]],template:function(i,n){i&1&&(r(0,"div",0)(1,"div",1)(2,"h5",2),a(3,"Upcoming Raids"),o(),d(4,"i",3),r(5,"div",4)(6,"ul",5)(7,"li")(8,"h6",6),a(9,"Filter Raids"),o()(),r(10,"li"),d(11,"raid-filter",7),o()()()(),r(12,"div",8),_(13,Kt,4,4),O(14,13,zt),o(),d(16,"div",9),o()),i&2&&(s(11),m("filterForm",n.raidFilterForm),s(3),L(n.raidposts))},dependencies:[$,be],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;overflow:hidden}.upcoming-raid-list[_ngcontent-%COMP%]::-webkit-scrollbar{width:10px}.upcoming-raid-list[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent;margin:0}.upcoming-raid-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#888;background:var(--discord-menu-text);border-radius:3px}.upcoming-raid-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#555}.loa-upcoming-raids[_ngcontent-%COMP%]{flex:1;position:relative;overflow:hidden}.loa-upcoming-raids[_ngcontent-%COMP%] > .card-body[_ngcontent-%COMP%]{overflow-y:auto}.loa-upcoming-raid[_ngcontent-%COMP%]{position:relative;display:flex;flex-flow:column;gap:.5rem;padding:.5rem!important;color:var(--discord-content-text);border-radius:3px!important;background-color:var(--discord-content)}.loa-upcoming-raid[_ngcontent-%COMP%]:hover{cursor:pointer;scale:1.01;border:1px solid var(--discord-content-text);border-radius:3px}.filter-symbol[_ngcontent-%COMP%]{position:absolute;font-size:1.75rem;top:.45rem;right:.5rem;line-height:0}.filter-symbol[_ngcontent-%COMP%]:hover{cursor:pointer;scale:1.1}.repeat-symbol[_ngcontent-%COMP%]{font-size:1.5rem;align-self:center;line-height:0;animation:_ngcontent-%COMP%_spin 4s linear infinite}.raid-filter[_ngcontent-%COMP%]{background-color:var(--discord-menu)}.filter-dropdown[_ngcontent-%COMP%]{list-style-type:none!important}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}"]})}}return t})();var nt=(t,c)=>c.id,Qt=()=>[k,import("./chunk-5N3FTQAW.js").then(t=>t.OrderByPipe),import("./chunk-PT4XS6NT.js").then(t=>t.LoaCharacterComponent)],ei=()=>[k,import("./chunk-5N3FTQAW.js").then(t=>t.OrderByPipe),import("./chunk-NCFRC2TF.js").then(t=>t.RaidPostComponent)],ti=()=>["characters/add"],ii=()=>["raids/add"],ri=t=>["characters",t],oi=t=>["raids",t];function ni(t,c){if(t&1&&d(0,"loa-character",19),t&2){let e=c.$implicit;m("character",e)("routerLink",j(2,ri,e.id))}}function ai(t,c){t&1&&(r(0,"div",20)(1,"h5"),a(2,"You have no characters"),o()())}function si(t,c){if(t&1&&(r(0,"div",18),y(1,ni,1,4,"loa-character",19,nt,!1,ai,3,0,"div",20),X(4,"orderBy"),o()),t&2){let e=f();s(),S(Z(4,1,e.characters(),e.sortC))}}function li(t,c){if(t&1&&d(0,"raid-post",21),t&2){let e=c.$implicit,i=f(2);m("raidpost",e)("player",i.player())("routerLink",j(3,oi,e.id))}}function di(t,c){if(t&1&&(r(0,"div",20)(1,"h5"),a(2),o()()),t&2){let e=f(2);s(2),Le("You have no available ",e.raids.length>0?"filtered":""," raids")}}function ci(t,c){if(t&1&&(r(0,"div",18),y(1,li,1,5,"raid-post",21,nt,!1,di,3,1,"div",20),X(4,"orderBy"),o()),t&2){let e=f();s(),S(Z(4,1,e.filteredRaids,e.sortRaids))}}var at=(()=>{class t{sortC(e,i){return e.itemlevel-i.itemlevel}constructor(e,i,n,l,p){this.router=e,this.meService=i,this.characterService=n,this.raidService=l,this.toastService=p,this.colors=Ge,this.testr=null,this.raidTime=oe,this.sortRaids=Ce,this.subs=[],this.player=this.meService.me$,this.characters=this.meService.myCharacters$,this.servers=this.meService.myServers$,this.raids=this.meService.myRaids$,this.repeats=this.meService.myRepeats$,this.raidFilterForm=new D({raid:new g("Any"),server:new g("Any"),status:new g("Any")})}ngOnInit(){var e=this.characterService.characterChanges$.subscribe(l=>{let p=l?.character,E=l?.change;if(p==null)return;let w=this.characters();switch(E){case"add":w.push(p);break;case"edit":let ae=w.find(se=>se.id==p.id);ae!=null&&Object.assign(ae,p);break;case"delete":let ce=w.findIndex(se=>se.id==p.id);ce>-1&&w.splice(ce,1);break;case"signup":console.log("Signup");break}}),i=this.characterService.signupChanges$.subscribe(l=>{l.forEach(p=>{var E=this.raids().find(w=>w.id==p.id);if(E!=null&&E!==p){if(E.type=="repeatingpost"){let w=E,ae=p;w.repeatingSignups.length=0,Object.assign(w.repeatingSignups,ae.repeatingSignups)}E.signups.length=0,Object.assign(E.signups,p.signups)}})}),n=this.raidService.raidChanges$.subscribe(l=>{let p=l?.raidpost,E=l?.change;if(p==null)return;let w=this.raids();switch(E){case"add":w.push(p);break;case"edit":let ae=w.find(se=>se.id==p.id);ae!=null&&Object.assign(ae,p);break;case"delete":let ce=w.findIndex(se=>se.id==p.id);ce>-1&&w.splice(ce,1);break;case"signup":console.log("Signup");break}});this.subs.push(e,i,n)}ngOnDestroy(){for(let e of this.subs)e.unsubscribe();clearTimeout(this.expirationTimeout)}get filteredRaids(){let e=[...this.raids()];for(let[i,n]of Object.entries(this.raidFilterForm.controls))if(n.value!="Any")switch(i){case"raid":e=e.filter(l=>l.properties.loaRaid.name==n.value||n.value==="");break;case"server":e=e.filter(l=>l.server.name==n.value||n.value==="");break;case"status":if(!this.player)break;n.value=="Not Signed Up"?e=e.filter(l=>!l.signups.find(p=>p.player.id==this.player()?.id)):n.value=="Signed Up"&&(e=e.filter(l=>l.signups.find(p=>p.player.id==this.player()?.id)));break}return e}logout(){let e=this.player();e&&this.meService.logout(e).subscribe({next:i=>{i?this.router.navigate(["loa-assistant/login"]):this.toastService.show({header:"Error",body:"Failed to logout. Please try again.",type:"danger",source_feature:"loa-assistant",delay:7500})},error:i=>{console.log(i),this.toastService.show({header:"Error",body:"Failed to logout. Please try again.",type:"danger",source_feature:"loa-assistant",delay:7500})}})}static{this.\u0275fac=function(i){return new(i||t)(u(P),u(F),u(H),u(N),u(B))}}static{this.\u0275cmp=x({type:t,selectors:[["loa-home"]],decls:35,vars:13,consts:[[1,"d-flex","justify-content-between","_color-discord-menu-text"],[1,"logout-button",3,"click"],[1,"container-xxl","d-flex","flex-column","gap-5","pb-5","loa-home"],[1,"row","g-3r","g-2","_minh-20r"],[1,"col-12","col-lg-8","mh-25r","_minh-10r"],[1,"col-12","col-lg-4","mh-25r","_minh-10r",3,"raidposts","player"],[1,"d-flex","gap-3"],["text","Characters","type","h4",1,"flex-grow-1",3,"color","lc"],["type","button","title","Add Character","routerLinkActive","router-link-active",1,"btn","btn-sm","btn-secondary","h-50","align-self-center",3,"routerLink"],[1,"bi-plus-lg"],["text","Raids","type","h4",1,"flex-grow-1",3,"color","lc"],["type","button","title","Add Raid Post","routerLinkActive","router-link-active",1,"btn","btn-sm","btn-secondary","h-50","align-self-center",3,"routerLink"],["id","raidsFilter","type","button","title","Filter Raids","data-bs-toggle","dropdown","data-bs-auto-close","outside","aria-expanded","false",1,"btn","btn-sm","btn-secondary","h-50","align-self-center","filter-button"],[1,"bi-filter","filter-symbol"],[1,"dropdown","filter-dropdown"],["aria-labelledby","raidsFilter",1,"dropdown-menu","w-20r","raid-filter"],[1,"dropdown-header"],[1,"raid-filter",3,"filterForm"],[1,"d-flex","flex","flex-wrap","gap-3","justify-content-center"],[3,"character","routerLink"],[1,"text-center","_color-discord-content-text"],[3,"raidpost","player","routerLink"]],template:function(i,n){i&1&&(r(0,"div",0)(1,"span"),a(2,"Loa Assistant Home"),o(),r(3,"a",1),C("click",function(){return n.logout()}),a(4,"Log Out"),o()(),r(5,"div",2)(6,"section",3),d(7,"announcements",4)(8,"loa-upcoming-raids",5),o(),r(9,"section")(10,"div",6),d(11,"my-header",7),r(12,"button",8),d(13,"i",9),o()(),_(14,si,5,4),O(15,14,Qt),o(),r(17,"section")(18,"div",6),d(19,"my-header",10),r(20,"button",11),d(21,"i",9),o(),r(22,"button",12),d(23,"i",13),o(),r(24,"div",14)(25,"ul",15)(26,"li")(27,"h6",16),a(28,"Filter Raids"),o()(),r(29,"li"),d(30,"raid-filter",17),o()()()(),_(31,ci,5,4),O(32,31,ei),o()(),d(34,"router-outlet")),i&2&&(s(8),m("raidposts",n.raids())("player",n.player()),s(3),m("color",n.colors.discordContenttext)("lc",n.colors.discordMenuText),s(),m("routerLink",R(11,ti)),s(3),L(n.characters),s(4),m("color",n.colors.discordContenttext)("lc",n.colors.discordMenuText),s(),m("routerLink",R(12,ii)),s(10),m("filterForm",n.raidFilterForm),s(2),L(n.raids))},dependencies:[k,fe,A,je,be,ot,rt],styles:["loa-character[_ngcontent-%COMP%], raid-post[_ngcontent-%COMP%]{border:1px solid transparent}loa-character[_ngcontent-%COMP%]:hover, raid-post[_ngcontent-%COMP%]:hover{cursor:pointer;scale:1.05;border:1px solid var(--discord-content-text);border-radius:3px}.loa-home[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:transparent!important}.raid-filter[_ngcontent-%COMP%]{background-color:var(--discord-menu)}.filter-dropdown[_ngcontent-%COMP%]{list-style-type:none!important}.logout-button[_ngcontent-%COMP%]:hover{cursor:pointer}"]})}}return t})();var st=(()=>{class t{constructor(){this.meService=b(F),this.characterService=b(H),this.raidService=b(N)}ngOnInit(){}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=x({type:t,selectors:[["loa-index"]],decls:1,vars:0,template:function(i,n){i&1&&d(0,"router-outlet")},dependencies:[$,fe],encapsulation:2})}}return t})();var lt=(()=>{class t{constructor(e,i,n,l){this.loaLogin=e,this.router=i,this.route=n,this.cookies=l,this.returnTo=n.snapshot.queryParams.returnTo;let p=e.tokensRecieved$.subscribe(E=>{p.unsubscribe(),l.set("loa-tokens",JSON.stringify(E)),this.redirect()})}ngOnInit(){}login(){this.loaLogin.login()}redirect(){this.returnTo?this.router.navigateByUrl(this.returnTo):this.router.navigate(["/loa-assistant/home"])}static{this.\u0275fac=function(i){return new(i||t)(u(ne),u(P),u(I),u(he))}}static{this.\u0275cmp=x({type:t,selectors:[["loa-login-page"]],decls:47,vars:0,consts:[[1,"text-center","_color-discord-content-text","pt-3"],[1,"_color-discord-menu-text","text-center","p-0","fs-5"],["href","https://discord.gg/ay7dvJFnwF"],[1,"text-center","p-5"],[1,"btn","btn-primary","btn-lg",3,"click"],[1,"_color-discord-menu-text"]],template:function(i,n){i&1&&(r(0,"div",0)(1,"h4"),a(2,"LoA Assistant"),o()(),r(3,"div")(4,"p",1),a(5," Demo Server: "),d(6,"br"),r(7,"a",2),a(8,"Join Demo Server"),o(),d(9,"br"),a(10," Join the Demo Server using a Discord account first, then login via Discord. "),d(11,"br"),a(12," (Unfortunately I cannot have a Demo Discord account as it requires email verification on logins from new locations) "),d(13,"br"),a(14," (Changes Reset Daily @ 07:00 UTC) "),o()(),r(15,"div",3)(16,"button",4),C("click",function(){return n.login()}),a(17,"Login via Discord"),o()(),r(18,"div")(19,"section",5),a(20," This application uses Discord as a means to identify and notify users. LoA-Assistant is a project made to assist in organizing raids for LostArk communities on Discord. "),d(21,"br"),r(22,"i"),a(23,"In order to make proper use of this application, both the User and application's Discord bot must be within the same Discord server."),o(),d(24,"br")(25,"br"),r(26,"b"),a(27,"Characters"),o(),d(28,"br"),r(29,"p"),a(30," Users may enter and update their LostArk character's information through the website or discord bot, including their name, class, and item level. These characters are used when a user wishes to sign up for a raid post. "),o(),d(31,"br")(32,"br"),r(33,"b"),a(34,"Raid Posts"),o(),d(35,"br"),r(36,"p"),a(37," Post managers, members of the Discord servers with a "),r(38,"u"),a(39,"specified role"),o(),a(40,", may create and edit posts for scheduling a LostArk raid. Each post will list the raid to be attempted as well as the starting time. Other members of the server can will be able to signup for the raid's post with the characters they entered into the application. "),o(),r(41,"p"),a(42," By default the application will automatically form groups consisting of one or more parties for the raid as characters are signed up. If there are enough characters then multiple groups may be formed. These groups are tenative and the characters that are assigned may change as the list of signups changes. "),r(43,"u"),a(44,"Alternatively"),o(),a(45,", managers may manually create the groups for these raids through the website. "),o(),a(46," When it time for the raid to start, if there are ample singups, the discord bot will @mention the participating users, and list the groups for the raid. "),o()())},styles:[".btn-container[_ngcontent-%COMP%]{text-align:center;margin:auto;padding:5rem 0rem}.login-btn[_ngcontent-%COMP%]{border-radius:.5rem}"]})}}return t})();function mi(t,c){t&1&&(r(0,"div"),a(1,"Awaiting Token Response..."),o())}function pi(t,c){t&1&&(r(0,"div"),a(1,"Tokens Recieved"),o())}function ui(t,c){t&1&&(r(0,"div"),a(1,"Failed to retrieve tokens"),o())}var dt=(()=>{class t{constructor(e,i){this.logLogin=e,this.route=i,this.succesfulTokenExchange=0}ngOnInit(){let e=this.route.snapshot.queryParams,i=e.code,n=e.state;i&&n&&this.logLogin.getTokens$(i).subscribe({next:l=>{window.opener.postMessage(l),this.succesfulTokenExchange=1,console.log(l),window.close()},error:()=>{this.succesfulTokenExchange=-1}})}static{this.\u0275fac=function(i){return new(i||t)(u(ne),u(I))}}static{this.\u0275cmp=x({type:t,selectors:[["loa-on-login"]],decls:4,vars:1,consts:[[1,"on-login"]],template:function(i,n){if(i&1&&(r(0,"div",0),_(1,mi,2,0,"div")(2,pi,2,0,"div")(3,ui,2,0,"div"),o()),i&2){let l;s(),U((l=n.succesfulTokenExchange)===0?1:l===1?2:l===-1?3:-1)}},styles:[".on-login[_ngcontent-%COMP%]{margin:5rem;padding:1rem;color:#c8c8c8}"]})}}return t})();var fi=[{path:"characters/add",component:qe},{path:"characters/:id",component:ze},{path:"raids/add",component:Ke},{path:"raids/:id",component:et}],hi=[{path:"home",component:at,loadChildren:()=>fi},{path:"raids/:id/edit/groups",component:Je},{path:"**",redirectTo:"home",pathMatch:"full"}],ao=[{path:"login",component:lt},{path:"on-login",component:dt},{path:"",component:st,loadChildren:()=>hi,canActivate:[it]}];export{hi as contentRoutes,fi as homeRoutes,ao as loaRoutes};
