import{a as y,b as E}from"./chunk-QCGIDFDQ.js";import{d as j}from"./chunk-RA5YA7SP.js";import{a as T}from"./chunk-C5RMYWSX.js";import{a as k}from"./chunk-P4ZELJWN.js";import{b as H}from"./chunk-OQ23N4OO.js";import{$ as C,$a as A,Ba as w,Bc as O,Db as P,Fa as m,Gb as U,Ib as s,Lb as V,Ob as p,Tb as a,Ub as n,Vb as h,Xb as S,Zb as _,_b as c,cb as o,db as N,fa as v,jc as f,k as F,kc as I,ma as g,na as x,pb as M,wb as u,xc as R}from"./chunk-UUT3EF6T.js";var D=(()=>{class t{constructor(){this.url=k.mudae(),this.http=v(H),this.toastService=v(T)}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=C({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var W=(()=>{class t extends D{constructor(){super(),this.characterChanges=new F(1),this.characterChanges$=this.characterChanges.asObservable()}getCharacter$(e){return this.http.get(`${this.url}/api/characters/${e}`)}searchCharacter$(e){return this.http.get(`${this.url}/api/characters/search`,{params:e})}favoriteCharacter$(e){return this.http.post(`${this.url}/api/characters/favorite`,e.id)}unfavoriteCharacter$(e){return this.http.post(`${this.url}/api/characters/unfavorite`,e.id)}setCharacterAsLost$(e){return this.http.post(`${this.url}/api/characters/lost`,e.id)}setCharacterAsOwned$(e){return this.http.post(`${this.url}/api/characters/owned`,e.id)}setCharacterAsUnclaimed$(e){return this.http.post(`${this.url}/api/characters/unclaimed`,e.id)}characterStatusUpdate(e){this.characterChanges.next(e)}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=C({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function z(){return{hideAdultSeries:!0,hideAdultCharacters:!0,displayCharacterRank:!0,displayCharacterSeries:!0,preserveFiltersInHistory:!1}}var B=(()=>{class t extends D{constructor(){super(),this.serverLoading$=m(!1),this.updateLoading$=m(!1),this.settingsLoading$=m(!1),this.servers=m([]),this.servers$=this.servers.asReadonly(),this.updates=m([]),this.updates$=this.updates.asReadonly();let e=localStorage.getItem("mudae-settings");this.settings=m(e?JSON.parse(e):z()),this.settings$=this.settings.asReadonly(),this.loading$=O(()=>this.serverLoading$()||this.updateLoading$()||this.settingsLoading$()),this.serverLoading$.set(!0),this.myServers$().subscribe({next:r=>{this.servers.set(r)},error:r=>{this.toastService.show({header:"Error",body:"Failed to user's server data.",type:"danger",source_feature:"mudae"}),console.log(r)}}).add(()=>this.serverLoading$.set(!1)),this.updateLoading$.set(!0),this.mudaeUpdates$().subscribe({next:r=>{this.updates.set(r.sort((i,l)=>this.orderUpdates(i,l)))},error:r=>{this.toastService.show({header:"Error",body:"Failed to mudae data.",type:"danger",source_feature:"mudae"}),console.log(r)}}).add(()=>this.updateLoading$.set(!1))}mudaeUpdates$(){return this.http.get(`${this.url}/api/updates`)}myServers$(){return this.http.get(`${this.url}/api/servers`)}saveSettings(e){this.settings.set(e),localStorage.setItem("mudae-settings",JSON.stringify(e))}orderUpdates(e,r){let i=[e.slice(0,3),Number(e.slice(3))],l=[r.slice(0,3),Number(r.slice(3))];return i[1]>l[1]?-1:i[1]<l[1]?1:this.monthNumber(l[0])-this.monthNumber(i[0])}monthNumber(e){switch(e){case"jan":return 1;case"feb":return 2;case"mar":return 3;case"apr":return 4;case"may":return 5;case"jun":return 6;case"jul":return 7;case"aug":return 8;case"sep":return 9;case"oct":return 10;case"nov":return 11;case"dec":return 12}return 0}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=C({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var L=function(t){return t.FAVORITE="favorite",t.UNFAVORITE="heart_broken",t.UNCLAIMED="radio_button_unchecked",t.OWNED="check_circle",t.LOST="cancel",t}(L||{}),b=function(t){return t.FAVORITE="#dc3545",t.UNFAVORITE="#999696",t.UNCLAIMED="#999696",t.OWNED="green",t.LOST="red",t.favorite="#dc3545",t.heart_broken="#999696",t.radio_button_unchecked="#999696",t.check_circle="green",t.cancel="red",t}(b||{}),G=(()=>{class t{constructor(){}ngOnInit(){let e;for(e in b)e==this.icon&&(this.iconColor=b[e]);if(this.hoverIcon){let r;for(r in b)r==this.hoverIcon&&(this.hoverIconColor=b[r])}this.displayIcon=this.icon,this.displayColor=this.iconColor}hover(){this.hoverIcon&&(this.displayIcon=this.hoverIcon,this.displayColor=this.hoverIconColor)}leave(){this.displayIcon=this.icon,this.displayColor=this.iconColor}get color(){return this.displayColor?{color:this.displayColor}:""}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=M({type:t,selectors:[["mudae-icon"]],inputs:{icon:"icon",hoverIcon:"hoverIcon",iconColor:"iconColor",hoverIconColor:"hoverIconColor"},decls:1,vars:3,consts:[[3,"mouseenter","mouseleave","fontIcon"]],template:function(r,i){r&1&&(a(0,"mat-icon",0),_("mouseenter",function(){return i.hover()})("mouseleave",function(){return i.leave()}),n()),r&2&&(V(i.color),s("fontIcon",i.displayIcon))},dependencies:[E,y],styles:["[_nghost-%COMP%]{display:flex}"]})}}return t})();var q=()=>[y,G,import("./chunk-SH2Y2TOJ.js").then(t=>t.ScrollWhenDirective),import("./chunk-HDMH366V.js").then(t=>t.CopyOnClickDirective)];function Y(t,d){if(t&1&&(a(0,"div",8),f(1),n()),t&2){let e=c(3);o(),I("#"+e.character().rank)}}function K(t,d){if(t&1&&(a(0,"div",0)(1,"div",1)(2,"div",2),h(3,"span",3),a(4,"span",4),h(5,"mat-icon",5),n()()(),a(6,"div",6)(7,"div",7)(8,"span"),f(9,"18+ Characters are hidden by default. This can be changed in settings."),n()(),u(10,Y,2,1,"div",8),n(),a(11,"div",9)(12,"div",10)(13,"span"),f(14),n()(),a(15,"div",11),h(16,"mudae-icon",12),n()()()),t&2){let e=c(2);o(3),s("title","(Hidden 18+ Character)")("innerText","(Hidden 18+)"),o(),s("className",e.gender(e.character().gender)),o(),s("fontIcon",e.gender(e.character().gender)),o(5),p(e.mudaeSettings().displayCharacterRank?10:-1),o(4),I("(Hidden 18+ Series)"),o(2),s("icon",e.mudaeIcons.LOST)("hoverIcon",e.mudaeIcons.LOST)}}function Q(t,d){if(t&1&&(a(0,"div",8),f(1),n()),t&2){let e=c(3);o(),I("#"+e.character().rank)}}function X(t,d){if(t&1&&(a(0,"div",10)(1,"span",17),f(2),n()()),t&2){let e=c(4);o(),s("scrollWhen",e.isHovered()),o(),I(e.character().seriesName)}}function Z(t,d){t&1&&(a(0,"div",10)(1,"div"),f(2),n()()),t&2&&(o(2),I("(Hidden 18+ Series)"))}function ee(t,d){if(t&1&&u(0,X,3,2,"div",10)(1,Z,3,1,"div",10),t&2){let e=c(3);p(!e.character().adult||!e.mudaeSettings().hideAdultSeries?0:1)}}function te(t,d){if(t&1){let e=S();a(0,"mudae-icon",21),_("click",function(){g(e);let i=c(4);return x(i.toggleClaimStatus())}),n()}if(t&2){let e=c(4);s("icon",e.mudaeIcons.LOST)("hoverIcon",e.mudaeIcons.UNCLAIMED)}}function re(t,d){if(t&1){let e=S();a(0,"mudae-icon",22),_("click",function(){g(e);let i=c(4);return x(i.toggleClaimStatus())}),n()}if(t&2){let e=c(4);s("icon",e.mudaeIcons.UNCLAIMED)("hoverIcon",e.mudaeIcons.OWNED)}}function ie(t,d){if(t&1){let e=S();a(0,"mudae-icon",23),_("click",function(){g(e);let i=c(4);return x(i.toggleClaimStatus())}),n()}if(t&2){let e=c(4);s("icon",e.mudaeIcons.OWNED)("hoverIcon",e.mudaeIcons.LOST)}}function ae(t,d){if(t&1&&u(0,te,1,2,"mudae-icon",18)(1,re,1,2,"mudae-icon",19)(2,ie,1,2,"mudae-icon",20),t&2){let e,r=c(3);p((e=r.claimStatus)===-1?0:e===0?1:e===1?2:-1)}}function ne(t,d){if(t&1){let e=S();a(0,"mudae-icon",24),_("click",function(){g(e);let i=c(3);return x(i.toggleFavorite())}),n()}if(t&2){let e=c(3);s("icon",e.mudaeIcons.FAVORITE)("hoverIcon",e.mudaeIcons.UNFAVORITE)}}function oe(t,d){if(t&1){let e=S();a(0,"mudae-icon",25),_("click",function(){g(e);let i=c(3);return x(i.toggleFavorite())}),n()}if(t&2){let e=c(3);s("icon",e.mudaeIcons.UNFAVORITE)("hoverIcon",e.mudaeIcons.FAVORITE)}}function ce(t,d){if(t&1&&(a(0,"div",0)(1,"div",1)(2,"div",2),h(3,"span",13),a(4,"span",4),h(5,"mat-icon",5),n()()(),a(6,"div",6),h(7,"img",14),u(8,Q,2,1,"div",8),n(),a(9,"div",9),u(10,ee,2,1),a(11,"div",11),u(12,ae,3,1)(13,ne,1,2,"mudae-icon",15)(14,oe,1,2,"mudae-icon",16),n()()()),t&2){let e,r=c(2);o(3),s("title",r.name())("innerText",r.name()),o(),s("className",r.gender(r.character().gender)),o(),s("fontIcon",r.gender(r.character().gender)),o(2),s("title",r.name())("alt",r.name())("src",r.character().chestImage,A),o(),p(r.mudaeSettings().displayCharacterRank?8:-1),o(2),p(r.mudaeSettings().displayCharacterSeries?10:-1),o(2),p(r.showStatus()?12:-1),o(),p((e=r.isFavorited)===!0?13:e===!1?14:-1)}}function se(t,d){if(t&1&&u(0,K,17,8,"div",0)(1,ce,15,11,"div",0),t&2){let e=c();p(e.character().adult&&e.mudaeSettings().hideAdultCharacters?0:1)}}function de(t,d){if(t&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",26),f(4,"Character"),n(),a(5,"span",27),h(6,"mat-icon",28),n()()(),a(7,"div",6),h(8,"img",29),n(),a(9,"div",9)(10,"div",11),h(11,"mat-icon",28),n()()()),t&2){let e=c();o(8),s("title",e.name())("alt",e.name())}}var Ue=(()=>{class t{constructor(e){this.changeRef=e,this.characterService=v(W),this.resourceService=v(B),this.toastService=v(T),this.me=w.required(),this.character=w.required(),this.showStatus=w(!1),this.mudaeIcons=L,this.characterStatus={favorited:!1,claimStatus:0},this.isHovered=m(!1),this.subs=[],this.mudaeSettings=this.resourceService.settings$,this.name=O(()=>{let r=this.character().name,i=r.match(/{(?<name>\w+)}$/)?.groups;return i?r.replace(/{(\w+)}$/,`(${i.name})`):r})}ngOnInit(){this.getStatus(this.me()),this.getFavorited(this.me())}ngOnDestroy(){for(let e of this.subs)e.unsubscribe()}get isFavorited(){return this.characterStatus.favorited}get claimStatus(){return this.characterStatus.claimStatus}toggleFavorite(){if(this.me().id=="anonymous"){this.toastService.show({header:"Nope~ ",body:"Login to Favorite.",type:"warning",source_feature:"mudae",link:"/mudae/login",linkText:"Go to Login"});return}let e;this.characterStatus.favorited?e=this.characterService.unfavoriteCharacter$(this.character()):e=this.characterService.favoriteCharacter$(this.character()),this.updateCharacter(e)}toggleClaimStatus(){if(this.me().id=="anonymous"){this.toastService.show({header:"Nope~ ",body:"Login to Mark.",type:"warning",source_feature:"mudae",link:"/mudae/login",linkText:"Go to Login"});return}let e;switch(this.characterStatus.claimStatus){case 0:e=this.characterService.setCharacterAsOwned$(this.character());break;case 1:e=this.characterService.setCharacterAsLost$(this.character());break;case-1:e=this.characterService.setCharacterAsUnclaimed$(this.character());break}this.updateCharacter(e)}updateCharacter(e){e?.subscribe({next:r=>{switch(this.characterService.characterStatusUpdate(r),r.action){case"FAVORITE":this.characterStatus.favorited=!0;break;case"UNFAVORITE":this.characterStatus.favorited=!1;break;case"UNCLAIMED":this.characterStatus.claimStatus=0;break;case"OWNED":this.characterStatus.claimStatus=1;break;case"LOST":this.characterStatus.claimStatus=-1;break}this.changeRef.markForCheck()},error:r=>{this.toastService.show({header:"Error",body:"An unexpected error has occured.",type:"danger",source_feature:"mudae"}),console.log(r)}})}gender(e){return e=="Other"||!e?"transgender":e.toLowerCase()}getStatus(e){var r=e.owned.findIndex(l=>l==this.character().id),i=e.lost.findIndex(l=>l==this.character().id);return r>-1?this.characterStatus.claimStatus=1:i>-1?this.characterStatus.claimStatus=-1:this.characterStatus.claimStatus=0,this.characterStatus.claimStatus}getFavorited(e){var r=e.favorites.findIndex(i=>i==this.character().id);return r>-1?this.characterStatus.favorited=!0:this.characterStatus.favorited=!1,this.characterStatus.favorited}get mudaeUrl(){return k.mudae()}onHover(){this.isHovered.set(!0)}onLeave(){this.isHovered.set(!1)}static{this.\u0275fac=function(r){return new(r||t)(N(R))}}static{this.\u0275cmp=M({type:t,selectors:[["mudae-character"]],hostBindings:function(r,i){r&1&&_("mouseenter",function(){return i.onHover()})("mouseleave",function(){return i.onLeave()})},inputs:{me:[1,"me"],character:[1,"character"],showStatus:[1,"showStatus"]},decls:4,vars:0,consts:[[1,"mudae-character"],[1,"character-header"],[1,"header-container"],[1,"character-name",3,"title","innerText"],[3,"className"],[3,"fontIcon"],[1,"image-container"],[1,"plus18-hidden-character"],[1,"character-rank"],[1,"character-footer"],[1,"series-name"],[1,"icon-list"],[1,"plus18-hidden-icon",3,"icon","hoverIcon"],["copyOnClick","",1,"character-name",3,"title","innerText"],[1,"character-image",3,"title","alt","src"],["title","Unfavorite",1,"favorite-icon",3,"icon","hoverIcon"],["title","Favorite",1,"unfavorite-icon",3,"icon","hoverIcon"],["copyOnClick","",3,"scrollWhen"],["title","Set Unclaimed",1,"lost-icon",3,"icon","hoverIcon"],["title","Set Owned",1,"unclaimed-icon",3,"icon","hoverIcon"],["title","Set Lost",1,"owned-icon",3,"icon","hoverIcon"],["title","Set Unclaimed",1,"lost-icon",3,"click","icon","hoverIcon"],["title","Set Owned",1,"unclaimed-icon",3,"click","icon","hoverIcon"],["title","Set Lost",1,"owned-icon",3,"click","icon","hoverIcon"],["title","Unfavorite",1,"favorite-icon",3,"click","icon","hoverIcon"],["title","Favorite",1,"unfavorite-icon",3,"click","icon","hoverIcon"],[1,"character-name"],[1,"transgender"],["fontIcon","pending"],[1,"character-image",3,"title","alt"]],template:function(r,i){r&1&&(u(0,se,2,1)(1,de,12,2),P(2,0,q,null,1),U(0,-1))},dependencies:[E,y,j],styles:[".mudae-character[_ngcontent-%COMP%]{width:10rem;color:var(--mudae-character-text-color);border:1px solid var(--mudae-character-border-color);border-radius:3px;box-sizing:border-box;box-shadow:var(--mudae-character-shadow)}.character-header[_ngcontent-%COMP%]{padding:.25rem .5rem;border-bottom:1px solid var(--mudae-character-inner-border-color);box-sizing:border-box}.header-container[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap}.character-name[_ngcontent-%COMP%]{flex-grow:1;text-overflow:ellipsis;text-wrap:nowrap;overflow:hidden}.male[_ngcontent-%COMP%], .female[_ngcontent-%COMP%], .transgender[_ngcontent-%COMP%]{display:flex;flex-shrink:0}.male[_ngcontent-%COMP%]{color:var(--mudae-male)}.female[_ngcontent-%COMP%]{color:var(--mudae-female)}.transgender[_ngcontent-%COMP%]{color:var(--mudae-transgender)}.image-container[_ngcontent-%COMP%]{position:relative;padding:0rem .5rem;min-height:var(--mudae-character-image-height);background-color:var(--mudae-character-inner-bg-color);box-sizing:border-box}.plus18-hidden-character[_ngcontent-%COMP%]{position:absolute;top:50%;left:0rem;transform:translateY(-50%);font-variant-caps:all-small-caps;letter-spacing:.5px;word-spacing:1px;text-align:center;background-color:var(--mudae-medium)}.plus18-hidden-icon[_ngcontent-%COMP%]{visibility:hidden}.character-image[_ngcontent-%COMP%]{width:100%;height:var(--mudae-character-image-height);background-image:var(--mudae-character-loading-image);background-size:contain}.character-rank[_ngcontent-%COMP%]{position:absolute;left:.75rem;bottom:.35rem;padding:0rem .25rem;font-size:1.2rem;color:var(--mudae-text-color);border-radius:3px;background-color:var(--mudae-character-inner-bg-color);box-shadow:2px 3px #00000059}.character-footer[_ngcontent-%COMP%]{padding:.25rem .5rem;border-top:1px solid var(--mudae-character-inner-border-color)}.series-name[_ngcontent-%COMP%]{text-align:center;text-wrap:nowrap;overflow:hidden;font-size:.85rem;font-weight:700;font-variant-caps:all-small-caps;letter-spacing:.25px}.icon-list[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;justify-content:space-between}.favorite-icon[_ngcontent-%COMP%], .unfavorite-icon[_ngcontent-%COMP%]{margin-left:auto}.favorite-icon[_ngcontent-%COMP%]{color:var(--mudae-favorite-color)}.owned-icon[_ngcontent-%COMP%]{color:var(--mudae-owned-color)}.lost-icon[_ngcontent-%COMP%]{color:var(--mudae-lost-color)}mudae-icon[_ngcontent-%COMP%]:hover{scale:1.15;cursor:pointer}.placeholder-img[_ngcontent-%COMP%]{width:100%;height:220px}"],changeDetection:0})}}return t})();export{D as a,W as b,B as c,Ue as d};
