import{a as b,b as k}from"./chunk-WRSMBKFW.js";import{J as z}from"./chunk-KCLKHEQV.js";import{a as T}from"./chunk-EJWSQFFV.js";import{a as D}from"./chunk-JLWIDV3F.js";import{e as W}from"./chunk-KE4LITEF.js";import{a as N}from"./chunk-44VI7T2K.js";import{$a as F,Bb as U,Jb as V,Mb as R,Nc as w,Rb as m,Sb as u,Uc as O,Xb as s,Yb as r,Zb as a,Zc as j,_b as h,ca as C,db as o,dc as S,fc as _,ha as v,hc as c,l as A,ma as g,mb as P,na as x,ub as y,uc as H,wc as f,xc as I,ya as p}from"./chunk-W56RDURX.js";var E=(()=>{class t{constructor(){this.url=D.mudae(),this.http=v(W),this.toastService=v(T)}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275prov=C({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var B=(()=>{class t extends E{constructor(){super(),this.characterChanges=new A(1),this.characterChanges$=this.characterChanges.asObservable()}getCharacter$(e){return this.http.get(`${this.url}/api/characters/${e}`)}searchCharacter$(e){return this.http.get(`${this.url}/api/characters/search`,{params:e})}favoriteCharacter$(e){return this.http.post(`${this.url}/api/characters/favorite`,e.id)}unfavoriteCharacter$(e){return this.http.post(`${this.url}/api/characters/unfavorite`,e.id)}setCharacterAsLost$(e){return this.http.post(`${this.url}/api/characters/lost`,e.id)}setCharacterAsOwned$(e){return this.http.post(`${this.url}/api/characters/owned`,e.id)}setCharacterAsUnclaimed$(e){return this.http.post(`${this.url}/api/characters/unclaimed`,e.id)}characterStatusUpdate(e){this.characterChanges.next(e)}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275prov=C({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function G(){return{hideAdultSeries:!0,hideAdultCharacters:!0,displayCharacterRank:!0,displayCharacterSeries:!0,preserveFiltersInHistory:!1}}var J=(()=>{class t extends E{constructor(){super(),this.serverLoading$=p(!1),this.updateLoading$=p(!1),this.settingsLoading$=p(!1),this.servers=p([]),this.servers$=this.servers.asReadonly(),this.updates=p([]),this.updates$=this.updates.asReadonly();let e=localStorage.getItem("mudae-settings");this.settings=p(e?JSON.parse(e):G()),this.settings$=this.settings.asReadonly(),this.loading$=w(()=>this.serverLoading$()||this.updateLoading$()||this.settingsLoading$()),this.serverLoading$.set(!0),this.myServers$().subscribe({next:n=>{this.servers.set(n)},error:n=>{this.toastService.show({header:"Error",body:"Failed to user's server data.",type:"danger",source_feature:"mudae"}),console.log(n)}}).add(()=>this.serverLoading$.set(!1)),this.updateLoading$.set(!0),this.mudaeUpdates$().subscribe({next:n=>{this.updates.set(n.sort((i,l)=>this.orderUpdates(i,l)))},error:n=>{this.toastService.show({header:"Error",body:"Failed to mudae data.",type:"danger",source_feature:"mudae"}),console.log(n)}}).add(()=>this.updateLoading$.set(!1))}mudaeUpdates$(){return this.http.get(`${this.url}/api/updates`)}myServers$(){return this.http.get(`${this.url}/api/servers`)}saveSettings(e){this.settings.set(e),localStorage.setItem("mudae-settings",JSON.stringify(e))}orderUpdates(e,n){let i=[e.slice(0,3),Number(e.slice(3))],l=[n.slice(0,3),Number(n.slice(3))];return i[1]>l[1]?-1:i[1]<l[1]?1:this.monthNumber(l[0])-this.monthNumber(i[0])}monthNumber(e){switch(e.toLowerCase()){case"jan":return 1;case"feb":return 2;case"mar":return 3;case"apr":return 4;case"may":return 5;case"jun":return 6;case"jul":return 7;case"aug":return 8;case"sep":return 9;case"oct":return 10;case"nov":return 11;case"dec":return 12}return 0}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275prov=C({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var L=(function(t){return t.FAVORITE="favorite",t.UNFAVORITE="heart_broken",t.UNCLAIMED="radio_button_unchecked",t.OWNED="check_circle",t.LOST="cancel",t})(L||{}),M=(function(t){return t.FAVORITE="#dc3545",t.UNFAVORITE="#999696",t.UNCLAIMED="#999696",t.OWNED="green",t.LOST="red",t.favorite="#dc3545",t.heart_broken="#999696",t.radio_button_unchecked="#999696",t.check_circle="green",t.cancel="red",t})(M||{}),q=(()=>{class t{constructor(){}ngOnInit(){let e;for(e in M)e==this.icon&&(this.iconColor=M[e]);if(this.hoverIcon){let n;for(n in M)n==this.hoverIcon&&(this.hoverIconColor=M[n])}this.displayIcon=this.icon,this.displayColor=this.iconColor}hover(){this.hoverIcon&&(this.displayIcon=this.hoverIcon,this.displayColor=this.hoverIconColor)}leave(){this.displayIcon=this.icon,this.displayColor=this.iconColor}get color(){return this.displayColor?{color:this.displayColor}:""}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=y({type:t,selectors:[["mudae-icon"]],inputs:{icon:"icon",hoverIcon:"hoverIcon",iconColor:"iconColor",hoverIconColor:"hoverIconColor"},decls:1,vars:3,consts:[[3,"mouseenter","mouseleave","fontIcon"]],template:function(n,i){n&1&&(r(0,"mat-icon",0),_("mouseenter",function(){return i.hover()})("mouseleave",function(){return i.leave()}),a()),n&2&&(H(i.color),s("fontIcon",i.displayIcon))},dependencies:[k,b],styles:["[_nghost-%COMP%]{display:flex}"]})}}return t})();var K=()=>[b,q,import("./chunk-LMIC2MF4.js").then(t=>t.ScrollWhenDirective),N];function Q(t,d){if(t&1&&(r(0,"div",8),f(1),a()),t&2){let e=c(3);o(),I("#"+e.character().rank)}}function X(t,d){if(t&1&&(r(0,"div",0)(1,"div",1)(2,"div",2),h(3,"span",3),r(4,"span",4),h(5,"mat-icon",5),a()()(),r(6,"div",6)(7,"div",7)(8,"span"),f(9,"18+ Characters are hidden by default. This can be changed in settings."),a()(),m(10,Q,2,1,"div",8),a(),r(11,"div",9)(12,"div",10)(13,"span"),f(14),a()(),r(15,"div",11),h(16,"mudae-icon",12),a()()()),t&2){let e=c(2);o(3),s("title","(Hidden 18+ Character)")("innerText","(Hidden 18+)"),o(),s("className",e.gender(e.character().gender)),o(),s("fontIcon",e.gender(e.character().gender)),o(5),u(e.mudaeSettings().displayCharacterRank?10:-1),o(4),I("(Hidden 18+ Series)"),o(2),s("icon",e.mudaeIcons.LOST)("hoverIcon",e.mudaeIcons.LOST)}}function Z(t,d){if(t&1&&(r(0,"div",8),f(1),a()),t&2){let e=c(3);o(),I("#"+e.character().rank)}}function ee(t,d){if(t&1&&(r(0,"div",10)(1,"span",18),f(2),a()()),t&2){let e=c(4);o(),s("scrollWhen",e.isHovered()),o(),I(e.character().seriesName)}}function te(t,d){t&1&&(r(0,"div",10)(1,"div"),f(2),a()()),t&2&&(o(2),I("(Hidden 18+ Series)"))}function ne(t,d){if(t&1&&m(0,ee,3,2,"div",10)(1,te,3,1,"div",10),t&2){let e=c(3);u(!e.character().adult||!e.mudaeSettings().hideAdultSeries?0:1)}}function ie(t,d){if(t&1){let e=S();r(0,"mudae-icon",22),_("click",function(){g(e);let i=c(4);return x(i.toggleClaimStatus())}),a()}if(t&2){let e=c(4);s("icon",e.mudaeIcons.LOST)("hoverIcon",e.mudaeIcons.UNCLAIMED)}}function re(t,d){if(t&1){let e=S();r(0,"mudae-icon",23),_("click",function(){g(e);let i=c(4);return x(i.toggleClaimStatus())}),a()}if(t&2){let e=c(4);s("icon",e.mudaeIcons.UNCLAIMED)("hoverIcon",e.mudaeIcons.OWNED)}}function ae(t,d){if(t&1){let e=S();r(0,"mudae-icon",24),_("click",function(){g(e);let i=c(4);return x(i.toggleClaimStatus())}),a()}if(t&2){let e=c(4);s("icon",e.mudaeIcons.OWNED)("hoverIcon",e.mudaeIcons.LOST)}}function oe(t,d){if(t&1&&m(0,ie,1,2,"mudae-icon",19)(1,re,1,2,"mudae-icon",20)(2,ae,1,2,"mudae-icon",21),t&2){let e,n=c(3);u((e=n.claimStatus)===-1?0:e===0?1:e===1?2:-1)}}function ce(t,d){if(t&1&&h(0,"mudae-icon",12),t&2){let e=c(3);s("icon",e.mudaeIcons.LOST)("hoverIcon",e.mudaeIcons.LOST)}}function se(t,d){t&1&&(r(0,"div",15),f(1,"SITE ONLY"),a())}function de(t,d){if(t&1){let e=S();r(0,"mudae-icon",25),_("click",function(){g(e);let i=c(3);return x(i.toggleFavorite())}),a()}if(t&2){let e=c(3);s("icon",e.mudaeIcons.FAVORITE)("hoverIcon",e.mudaeIcons.UNFAVORITE)}}function le(t,d){if(t&1){let e=S();r(0,"mudae-icon",26),_("click",function(){g(e);let i=c(3);return x(i.toggleFavorite())}),a()}if(t&2){let e=c(3);s("icon",e.mudaeIcons.UNFAVORITE)("hoverIcon",e.mudaeIcons.FAVORITE)}}function he(t,d){if(t&1&&(r(0,"div",0)(1,"div",1)(2,"div",2),h(3,"span",13),r(4,"span",4),h(5,"mat-icon",5),a()()(),r(6,"div",6),h(7,"img",14),m(8,Z,2,1,"div",8),a(),r(9,"div",9),m(10,ne,2,1),r(11,"div",11),m(12,oe,3,1)(13,ce,1,2,"mudae-icon",12),m(14,se,2,0,"div",15),m(15,de,1,2,"mudae-icon",16)(16,le,1,2,"mudae-icon",17),a()()()),t&2){let e,n=c(2);o(3),s("title",n.name())("innerText",n.name()),o(),s("className",n.gender(n.character().gender)),o(),s("fontIcon",n.gender(n.character().gender)),o(2),s("title",n.name())("alt",n.name())("src",n.character().chestImage,F),o(),u(n.mudaeSettings().displayCharacterRank?8:-1),o(2),u(n.mudaeSettings().displayCharacterSeries?10:-1),o(2),u(n.showStatus()?12:13),o(2),u(n.character().siteCharacter?14:-1),o(),u((e=n.isFavorited)===!0?15:e===!1?16:-1)}}function me(t,d){if(t&1&&m(0,X,17,8,"div",0)(1,he,17,12,"div",0),t&2){let e=c();u(e.character().adult&&e.mudaeSettings().hideAdultCharacters?0:1)}}function ue(t,d){t&1&&h(0,"span",3),t&2&&s("title","(Hidden 18+ Character)")("innerText","(Hidden 18+)")}function pe(t,d){if(t&1&&h(0,"span",13),t&2){let e=c(2);s("title",e.name())("innerText",e.name())}}function _e(t,d){if(t&1&&(r(0,"div",0)(1,"div",1)(2,"div",2),m(3,ue,1,2,"span",3)(4,pe,1,2,"span",13),r(5,"span",27),h(6,"mat-icon",28),a()()(),r(7,"div",6),h(8,"img",29),a(),r(9,"div",9)(10,"div",11),h(11,"mat-icon",28),a()()()),t&2){let e=c();o(3),u(e.character().adult&&e.mudaeSettings().hideAdultCharacters?3:4),o(5),s("title",e.name())("alt",e.name())}}var Be=(()=>{class t{constructor(e){this.changeRef=e,this.characterService=v(B),this.resourceService=v(J),this.toastService=v(T),this.me=O.required(),this.character=O.required(),this.showStatus=O(!1),this.mudaeIcons=L,this.characterStatus={favorited:!1,claimStatus:0},this.isHovered=p(!1),this.subs=[],this.mudaeSettings=this.resourceService.settings$,this.name=w(()=>{let n=this.character().name,i=n.match(/{(?<name>[\S]+)}$/)?.groups;return!i&&n.includes("{")&&console.log(n),i?n.replace(/{([\S]+)}$/,`(${i.name})`):n})}ngOnInit(){this.getStatus(this.me()),this.getFavorited(this.me())}ngOnDestroy(){for(let e of this.subs)e.unsubscribe()}get isFavorited(){return this.characterStatus.favorited}get claimStatus(){return this.characterStatus.claimStatus}toggleFavorite(){if(this.me().id=="anonymous"){this.toastService.show({header:"Nope~ ",body:"Login to Favorite.",type:"warning",source_feature:"mudae",link:"/mudae/login",linkText:"Go to Login"});return}let e;this.characterStatus.favorited?e=this.characterService.unfavoriteCharacter$(this.character()):e=this.characterService.favoriteCharacter$(this.character()),this.updateCharacter(e)}toggleClaimStatus(){if(this.me().id=="anonymous"){this.toastService.show({header:"Nope~ ",body:"Login to Mark.",type:"warning",source_feature:"mudae",link:"/mudae/login",linkText:"Go to Login"});return}let e;switch(this.characterStatus.claimStatus){case 0:e=this.characterService.setCharacterAsOwned$(this.character());break;case 1:e=this.characterService.setCharacterAsLost$(this.character());break;case-1:e=this.characterService.setCharacterAsUnclaimed$(this.character());break}this.updateCharacter(e)}updateCharacter(e){e?.subscribe({next:n=>{switch(this.characterService.characterStatusUpdate(n),n.action){case"FAVORITE":this.characterStatus.favorited=!0;break;case"UNFAVORITE":this.characterStatus.favorited=!1;break;case"UNCLAIMED":this.characterStatus.claimStatus=0;break;case"OWNED":this.characterStatus.claimStatus=1;break;case"LOST":this.characterStatus.claimStatus=-1;break}this.changeRef.markForCheck()},error:n=>{this.toastService.show({header:"Error",body:"An unexpected error has occured.",type:"danger",source_feature:"mudae"}),console.log(n)}})}gender(e){return e=="Other"||!e?"transgender":e.toLowerCase()}getStatus(e){var n=e.owned.findIndex(l=>l==this.character().id),i=e.lost.findIndex(l=>l==this.character().id);return n>-1?this.characterStatus.claimStatus=1:i>-1?this.characterStatus.claimStatus=-1:this.characterStatus.claimStatus=0,this.characterStatus.claimStatus}getFavorited(e){var n=e.favorites.findIndex(i=>i==this.character().id);return n>-1?this.characterStatus.favorited=!0:this.characterStatus.favorited=!1,this.characterStatus.favorited}get mudaeUrl(){return D.mudae()}onHover(){this.isHovered.set(!0)}onLeave(){this.isHovered.set(!1)}static{this.\u0275fac=function(n){return new(n||t)(P(j))}}static{this.\u0275cmp=y({type:t,selectors:[["mudae-character"]],hostBindings:function(n,i){n&1&&_("mouseenter",function(){return i.onHover()})("mouseleave",function(){return i.onLeave()})},inputs:{me:[1,"me"],character:[1,"character"],showStatus:[1,"showStatus"]},decls:4,vars:0,consts:[[1,"mudae-character"],[1,"character-header"],[1,"header-container"],[1,"character-name",3,"title","innerText"],[3,"className"],[3,"fontIcon"],[1,"image-container"],[1,"plus18-hidden-character"],[1,"character-rank"],[1,"character-footer"],[1,"series-name"],[1,"icon-list"],[1,"plus18-hidden-icon",3,"icon","hoverIcon"],["copyOnClick","",1,"character-name",3,"title","innerText"],[1,"character-image",3,"title","alt","src"],[1,"site-hint"],["title","Unfavorite",1,"favorite-icon",3,"icon","hoverIcon"],["title","Favorite",1,"unfavorite-icon",3,"icon","hoverIcon"],["copyOnClick","",3,"scrollWhen"],["title","Set Unclaimed",1,"lost-icon",3,"icon","hoverIcon"],["title","Set Owned",1,"unclaimed-icon",3,"icon","hoverIcon"],["title","Set Lost",1,"owned-icon",3,"icon","hoverIcon"],["title","Set Unclaimed",1,"lost-icon",3,"click","icon","hoverIcon"],["title","Set Owned",1,"unclaimed-icon",3,"click","icon","hoverIcon"],["title","Set Lost",1,"owned-icon",3,"click","icon","hoverIcon"],["title","Unfavorite",1,"favorite-icon",3,"click","icon","hoverIcon"],["title","Favorite",1,"unfavorite-icon",3,"click","icon","hoverIcon"],[1,"transgender"],["fontIcon","pending"],[1,"character-image",3,"title","alt"]],template:function(n,i){n&1&&(U(0,me,2,1)(1,_e,12,3),V(2,0,K,null,1),R(0,-1))},dependencies:[k,b,z,N],styles:[".mudae-character[_ngcontent-%COMP%]{width:10rem;color:var(--mudae-character-text-color);border:1px solid var(--mudae-character-border-color);border-radius:3px;box-sizing:border-box;box-shadow:var(--mudae-character-shadow)}.character-header[_ngcontent-%COMP%]{padding:.25rem .5rem;border-bottom:1px solid var(--mudae-character-inner-border-color);box-sizing:border-box}.header-container[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap}.character-name[_ngcontent-%COMP%]{flex-grow:1;text-overflow:ellipsis;text-wrap:nowrap;overflow:hidden}.male[_ngcontent-%COMP%], .female[_ngcontent-%COMP%], .transgender[_ngcontent-%COMP%]{display:flex;flex-shrink:0}.male[_ngcontent-%COMP%]{color:var(--mudae-male)}.female[_ngcontent-%COMP%]{color:var(--mudae-female)}.transgender[_ngcontent-%COMP%]{color:var(--mudae-transgender)}.image-container[_ngcontent-%COMP%]{position:relative;padding:0rem .5rem;min-height:var(--mudae-character-image-height);background-color:var(--mudae-character-inner-bg-color);box-sizing:border-box}.plus18-hidden-character[_ngcontent-%COMP%]{position:absolute;top:50%;left:0rem;transform:translateY(-50%);font-variant-caps:all-small-caps;letter-spacing:.5px;word-spacing:1px;text-align:center;background-color:var(--mudae-medium)}.plus18-hidden-icon[_ngcontent-%COMP%]{visibility:hidden}.character-image[_ngcontent-%COMP%]{width:100%;height:var(--mudae-character-image-height);background-image:var(--mudae-character-loading-image);background-size:contain}.character-rank[_ngcontent-%COMP%]{position:absolute;left:.75rem;bottom:.35rem;padding:0rem .25rem;font-size:1.2rem;color:var(--mudae-text-color);border-radius:3px;background-color:var(--mudae-character-inner-bg-color);box-shadow:2px 3px #00000059}.character-footer[_ngcontent-%COMP%]{padding:.25rem .5rem;border-top:1px solid var(--mudae-character-inner-border-color)}.series-name[_ngcontent-%COMP%]{text-align:center;text-wrap:nowrap;overflow:hidden;font-size:.85rem;font-weight:700;font-variant-caps:all-small-caps;letter-spacing:.25px}.icon-list[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;justify-content:space-between}.site-hint[_ngcontent-%COMP%]{margin:auto}.favorite-icon[_ngcontent-%COMP%], .unfavorite-icon[_ngcontent-%COMP%]{margin-left:auto}.favorite-icon[_ngcontent-%COMP%]{color:var(--mudae-favorite-color)}.owned-icon[_ngcontent-%COMP%]{color:var(--mudae-owned-color)}.lost-icon[_ngcontent-%COMP%]{color:var(--mudae-lost-color)}mudae-icon[_ngcontent-%COMP%]:hover{scale:1.15;cursor:pointer}.placeholder-img[_ngcontent-%COMP%]{width:100%;height:220px}"],changeDetection:0})}}return t})();export{E as a,B as b,J as c,Be as d};
