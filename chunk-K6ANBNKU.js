import{a as b,b as T}from"./chunk-QCGIDFDQ.js";import{d as z}from"./chunk-RA5YA7SP.js";import{a as k}from"./chunk-C5RMYWSX.js";import{a as O}from"./chunk-P4ZELJWN.js";import{b as j}from"./chunk-OQ23N4OO.js";import{$ as v,$a as F,Ba as M,Bc as N,Db as P,Fa as _,Gb as V,Ib as s,Lb as R,Ob as m,Tb as a,Ub as i,Vb as l,Xb as x,Zb as u,_b as c,cb as o,db as L,fa as p,jc as f,k as A,kc as I,ma as C,na as g,pb as w,wb as h,xc as U}from"./chunk-UUT3EF6T.js";var $=(()=>{class t{constructor(){this.url=O.mudae(),this.http=p(j),this.toastService=p(k)}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=v({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var H=(()=>{class t extends ${constructor(){super(),this.characterChanges=new A(1),this.characterChanges$=this.characterChanges.asObservable()}getCharacter$(e){return this.http.get(`${this.url}/api/characters/${e}`)}searchCharacter$(e){return this.http.get(`${this.url}/api/characters/search`,{params:e})}favoriteCharacter$(e){return this.http.post(`${this.url}/api/characters/favorite`,e.id)}unfavoriteCharacter$(e){return this.http.post(`${this.url}/api/characters/unfavorite`,e.id)}setCharacterAsLost$(e){return this.http.post(`${this.url}/api/characters/lost`,e.id)}setCharacterAsOwned$(e){return this.http.post(`${this.url}/api/characters/owned`,e.id)}setCharacterAsUnclaimed$(e){return this.http.post(`${this.url}/api/characters/unclaimed`,e.id)}characterStatusUpdate(e){this.characterChanges.next(e)}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=v({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var D=function(t){return t.FAVORITE="favorite",t.UNFAVORITE="heart_broken",t.UNCLAIMED="radio_button_unchecked",t.OWNED="check_circle",t.LOST="cancel",t}(D||{}),y=function(t){return t.FAVORITE="#dc3545",t.UNFAVORITE="#999696",t.UNCLAIMED="#999696",t.OWNED="green",t.LOST="red",t.favorite="#dc3545",t.heart_broken="#999696",t.radio_button_unchecked="#999696",t.check_circle="green",t.cancel="red",t}(y||{}),W=(()=>{class t{constructor(){}ngOnInit(){let e;for(e in y)e==this.icon&&(this.iconColor=y[e]);if(this.hoverIcon){let r;for(r in y)r==this.hoverIcon&&(this.hoverIconColor=y[r])}this.displayIcon=this.icon,this.displayColor=this.iconColor}hover(){this.hoverIcon&&(this.displayIcon=this.hoverIcon,this.displayColor=this.hoverIconColor)}leave(){this.displayIcon=this.icon,this.displayColor=this.iconColor}get color(){return this.displayColor?{color:this.displayColor}:""}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=w({type:t,selectors:[["mudae-icon"]],inputs:{icon:"icon",hoverIcon:"hoverIcon",iconColor:"iconColor",hoverIconColor:"hoverIconColor"},decls:1,vars:3,consts:[[3,"mouseenter","mouseleave","fontIcon"]],template:function(r,n){r&1&&(a(0,"mat-icon",0),u("mouseenter",function(){return n.hover()})("mouseleave",function(){return n.leave()}),i()),r&2&&(R(n.color),s("fontIcon",n.displayIcon))},dependencies:[T,b],styles:["[_nghost-%COMP%]{display:flex}"]})}}return t})();function J(){return{hideAdultSeries:!0,hideAdultCharacters:!0,displayCharacterRank:!0,displayCharacterSeries:!0,preserveFiltersInHistory:!1}}var q=(()=>{class t extends ${constructor(){super(),this.serverLoading$=_(!1),this.updateLoading$=_(!1),this.settingsLoading$=_(!1),this.servers=_([]),this.servers$=this.servers.asReadonly(),this.updates=_([]),this.updates$=this.updates.asReadonly();let e=localStorage.getItem("mudae-settings");this.settings=_(e?JSON.parse(e):J()),this.settings$=this.settings.asReadonly(),this.loading$=N(()=>this.serverLoading$()||this.updateLoading$()||this.settingsLoading$()),this.serverLoading$.set(!0),this.myServers$().subscribe({next:r=>{this.servers.set(r)}}).add(()=>this.serverLoading$.set(!1)),this.updateLoading$.set(!0),this.mudaeUpdates$().subscribe({next:r=>{this.updates.set(r)}}).add(()=>this.updateLoading$.set(!1))}mudaeUpdates$(){return this.http.get(`${this.url}/api/updates`)}myServers$(){return this.http.get(`${this.url}/api/servers`)}saveSettings(e){this.settings.set(e),localStorage.setItem("mudae-settings",JSON.stringify(e))}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=v({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var Y=()=>[b,W];function G(t,d){if(t&1&&(a(0,"div",8),f(1),i()),t&2){let e=c(3);o(),I("#"+e.character().rank)}}function K(t,d){if(t&1&&(a(0,"div",0)(1,"div",1)(2,"div",2),l(3,"span",3),a(4,"span",4),l(5,"mat-icon",5),i()()(),a(6,"div",6)(7,"div",7)(8,"span"),f(9,"18+ Characters are hidden by default. This can be changed in settings."),i()(),h(10,G,2,1,"div",8),i(),a(11,"div",9)(12,"div",10)(13,"div"),f(14),i()(),a(15,"div",11),l(16,"mudae-icon",12),i()()()),t&2){let e=c(2);o(3),s("title","(Hidden 18+ Character)")("innerText","(Hidden 18+)"),o(),s("className",e.gender(e.character().gender)),o(),s("fontIcon",e.gender(e.character().gender)),o(5),m(e.mudaeSettings().displayCharacterRank?10:-1),o(4),I("(Hidden 18+ Series)"),o(2),s("icon",e.mudaeIcons.LOST)("hoverIcon",e.mudaeIcons.LOST)}}function Q(t,d){if(t&1&&(a(0,"div",8),f(1),i()),t&2){let e=c(3);o(),I("#"+e.character().rank)}}function X(t,d){if(t&1&&(a(0,"div",10)(1,"div"),f(2),i()()),t&2){let e=c(3);o(2),I(e.character().seriesName)}}function Z(t,d){if(t&1){let e=x();a(0,"mudae-icon",19),u("click",function(){C(e);let n=c(4);return g(n.toggleClaimStatus())}),i()}if(t&2){let e=c(4);s("icon",e.mudaeIcons.LOST)("hoverIcon",e.mudaeIcons.UNCLAIMED)}}function ee(t,d){if(t&1){let e=x();a(0,"mudae-icon",20),u("click",function(){C(e);let n=c(4);return g(n.toggleClaimStatus())}),i()}if(t&2){let e=c(4);s("icon",e.mudaeIcons.UNCLAIMED)("hoverIcon",e.mudaeIcons.OWNED)}}function te(t,d){if(t&1){let e=x();a(0,"mudae-icon",21),u("click",function(){C(e);let n=c(4);return g(n.toggleClaimStatus())}),i()}if(t&2){let e=c(4);s("icon",e.mudaeIcons.OWNED)("hoverIcon",e.mudaeIcons.LOST)}}function re(t,d){if(t&1&&h(0,Z,1,2,"mudae-icon",16)(1,ee,1,2,"mudae-icon",17)(2,te,1,2,"mudae-icon",18),t&2){let e,r=c(3);m((e=r.claimStatus)===-1?0:e===0?1:e===1?2:-1)}}function ae(t,d){if(t&1){let e=x();a(0,"mudae-icon",22),u("click",function(){C(e);let n=c(3);return g(n.toggleFavorite())}),i()}if(t&2){let e=c(3);s("icon",e.mudaeIcons.FAVORITE)("hoverIcon",e.mudaeIcons.UNFAVORITE)}}function ie(t,d){if(t&1){let e=x();a(0,"mudae-icon",23),u("click",function(){C(e);let n=c(3);return g(n.toggleFavorite())}),i()}if(t&2){let e=c(3);s("icon",e.mudaeIcons.UNFAVORITE)("hoverIcon",e.mudaeIcons.FAVORITE)}}function ne(t,d){if(t&1&&(a(0,"div",0)(1,"div",1)(2,"div",2),l(3,"span",3),a(4,"span",4),l(5,"mat-icon",5),i()()(),a(6,"div",6),l(7,"img",13),h(8,Q,2,1,"div",8),i(),a(9,"div",9),h(10,X,3,1,"div",10),a(11,"div",11),h(12,re,3,1)(13,ae,1,2,"mudae-icon",14)(14,ie,1,2,"mudae-icon",15),i()()()),t&2){let e,r=c(2);o(3),s("title",r.character().name)("innerText",r.character().name),o(),s("className",r.gender(r.character().gender)),o(),s("fontIcon",r.gender(r.character().gender)),o(2),s("title",r.character().name)("alt",r.character().name)("src",r.character().chestImage,F),o(),m(r.mudaeSettings().displayCharacterRank?8:-1),o(2),m(r.mudaeSettings().displayCharacterSeries?10:-1),o(2),m(r.showStatus()?12:-1),o(),m((e=r.isFavorited)===!0?13:e===!1?14:-1)}}function oe(t,d){if(t&1&&h(0,K,17,8,"div",0)(1,ne,15,11,"div",0),t&2){let e=c();m(e.character().adult&&e.mudaeSettings().hideAdultCharacters?0:1)}}function ce(t,d){if(t&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",24),f(4,"Character"),i(),a(5,"span",25),l(6,"mat-icon",26),i()()(),a(7,"div",6),l(8,"img",27),i(),a(9,"div",9)(10,"div",11),l(11,"mat-icon",26),i()()()),t&2){let e=c();o(8),s("title",e.character().name)("alt",e.character().name)}}var Le=(()=>{class t{constructor(e){this.changeRef=e,this.characterService=p(H),this.resourceService=p(q),this.toastService=p(k),this.me=M.required(),this.character=M.required(),this.showStatus=M(!1),this.mudaeIcons=D,this.characterStatus={favorited:!1,claimStatus:0},this.subs=[],this.mudaeSettings=this.resourceService.settings$}ngOnInit(){this.getStatus(this.me()),this.getFavorited(this.me())}ngOnDestroy(){for(let e of this.subs)e.unsubscribe()}get isFavorited(){return this.characterStatus.favorited}get claimStatus(){return this.characterStatus.claimStatus}toggleFavorite(){let e;this.characterStatus.favorited?e=this.characterService.unfavoriteCharacter$(this.character()):e=this.characterService.favoriteCharacter$(this.character()),this.updateCharacter(e)}toggleClaimStatus(){let e;switch(this.characterStatus.claimStatus){case 0:e=this.characterService.setCharacterAsOwned$(this.character());break;case 1:e=this.characterService.setCharacterAsLost$(this.character());break;case-1:e=this.characterService.setCharacterAsUnclaimed$(this.character());break}this.updateCharacter(e)}updateCharacter(e){e?.subscribe({next:r=>{switch(this.characterService.characterStatusUpdate(r),r.action){case"FAVORITE":this.characterStatus.favorited=!0;break;case"UNFAVORITE":this.characterStatus.favorited=!1;break;case"UNCLAIMED":this.characterStatus.claimStatus=0;break;case"OWNED":this.characterStatus.claimStatus=1;break;case"LOST":this.characterStatus.claimStatus=-1;break}this.changeRef.markForCheck()},error:r=>{this.toastService.show({header:"Error",body:"An unexpected error has occured.",type:"danger",source_feature:"mudae"}),console.log(r)}})}gender(e){return e=="Other"||!e?"transgender":e.toLowerCase()}getStatus(e){var r=e.owned.findIndex(S=>S==this.character().id),n=e.lost.findIndex(S=>S==this.character().id);return r>-1?this.characterStatus.claimStatus=1:n>-1?this.characterStatus.claimStatus=-1:this.characterStatus.claimStatus=0,this.characterStatus.claimStatus}getFavorited(e){var r=e.favorites.findIndex(n=>n==this.character().id);return r>-1?this.characterStatus.favorited=!0:this.characterStatus.favorited=!1,this.characterStatus.favorited}get mudaeUrl(){return O.mudae()}static{this.\u0275fac=function(r){return new(r||t)(L(U))}}static{this.\u0275cmp=w({type:t,selectors:[["mudae-character"]],inputs:{me:[1,"me"],character:[1,"character"],showStatus:[1,"showStatus"]},decls:4,vars:0,consts:[[1,"mudae-character"],[1,"character-header"],[1,"header-container"],[1,"character-name",3,"title","innerText"],[3,"className"],[3,"fontIcon"],[1,"image-container"],[1,"plus18-hidden-character"],[1,"character-rank"],[1,"character-footer"],[1,"series-name"],[1,"icon-list"],[1,"plus18-hidden-icon",3,"icon","hoverIcon"],[1,"character-image",3,"title","alt","src"],["title","Unfavorite",1,"favorite-icon",3,"icon","hoverIcon"],["title","Favorite",1,"unfavorite-icon",3,"icon","hoverIcon"],["title","Set Unclaimed",1,"lost-icon",3,"icon","hoverIcon"],["title","Set Owned",1,"unclaimed-icon",3,"icon","hoverIcon"],["title","Set Lost",1,"owned-icon",3,"icon","hoverIcon"],["title","Set Unclaimed",1,"lost-icon",3,"click","icon","hoverIcon"],["title","Set Owned",1,"unclaimed-icon",3,"click","icon","hoverIcon"],["title","Set Lost",1,"owned-icon",3,"click","icon","hoverIcon"],["title","Unfavorite",1,"favorite-icon",3,"click","icon","hoverIcon"],["title","Favorite",1,"unfavorite-icon",3,"click","icon","hoverIcon"],[1,"character-name"],[1,"transgender"],["fontIcon","pending"],[1,"character-image",3,"title","alt"]],template:function(r,n){r&1&&(h(0,oe,2,1)(1,ce,12,2),P(2,0,Y,null,1),V(0,-1))},dependencies:[T,b,z],styles:[".mudae-character[_ngcontent-%COMP%]{width:10rem;color:var(--mudae-character-text-color);border:1px solid var(--mudae-character-border-color);border-radius:3px;box-sizing:border-box;box-shadow:var(--mudae-character-shadow)}.character-header[_ngcontent-%COMP%]{padding:.25rem .5rem;border-bottom:1px solid var(--mudae-character-inner-border-color);box-sizing:border-box}.header-container[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap}.character-name[_ngcontent-%COMP%]{flex-grow:1;text-overflow:ellipsis;text-wrap:nowrap;overflow:hidden}.male[_ngcontent-%COMP%], .female[_ngcontent-%COMP%], .transgender[_ngcontent-%COMP%]{display:flex;flex-shrink:0}.male[_ngcontent-%COMP%]{color:var(--mudae-male)}.female[_ngcontent-%COMP%]{color:var(--mudae-female)}.transgender[_ngcontent-%COMP%]{color:var(--mudae-transgender)}.image-container[_ngcontent-%COMP%]{position:relative;padding:0rem .5rem;min-height:var(--mudae-character-image-height);background-color:var(--mudae-character-inner-bg-color);box-sizing:border-box}.plus18-hidden-character[_ngcontent-%COMP%]{position:absolute;top:50%;left:0rem;transform:translateY(-50%);font-variant-caps:all-small-caps;letter-spacing:.5px;word-spacing:1px;text-align:center;background-color:var(--mudae-medium)}.plus18-hidden-icon[_ngcontent-%COMP%]{visibility:hidden}.character-image[_ngcontent-%COMP%]{width:100%;height:var(--mudae-character-image-height);background-image:var(--mudae-character-loading-image);background-size:contain}.character-rank[_ngcontent-%COMP%]{position:absolute;left:.75rem;bottom:.35rem;padding:0rem .25rem;font-size:1.2rem;color:var(--mudae-text-color);border-radius:3px;background-color:var(--mudae-character-inner-bg-color);box-shadow:2px 3px #00000059}.character-footer[_ngcontent-%COMP%]{padding:.25rem .5rem;border-top:1px solid var(--mudae-character-inner-border-color)}.series-name[_ngcontent-%COMP%]{text-align:center;text-wrap:nowrap;overflow:hidden;font-size:.85rem;font-weight:700;font-variant-caps:all-small-caps;letter-spacing:.25px}.icon-list[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;justify-content:space-between}.favorite-icon[_ngcontent-%COMP%], .unfavorite-icon[_ngcontent-%COMP%]{margin-left:auto}.favorite-icon[_ngcontent-%COMP%]{color:var(--mudae-favorite-color)}.owned-icon[_ngcontent-%COMP%]{color:var(--mudae-owned-color)}.lost-icon[_ngcontent-%COMP%]{color:var(--mudae-lost-color)}mudae-icon[_ngcontent-%COMP%]:hover{scale:1.15;cursor:pointer}.placeholder-img[_ngcontent-%COMP%]{width:100%;height:220px}"],changeDetection:0})}}return t})();export{$ as a,H as b,q as c,Le as d};
