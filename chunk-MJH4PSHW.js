import{a as J,b as Dt,c as Et,d as At}from"./chunk-IQHVKVNE.js";import{a as Qe,b as We}from"./chunk-7KCNP7I7.js";import{a as Be,b as ze,c as Ue,d as Mt,e as bt,f as Pt,g as St,h as It}from"./chunk-FEXUPZQG.js";import{a as Tt}from"./chunk-GTLMDP7R.js";import{a as Oe}from"./chunk-MOY26VGU.js";import"./chunk-AJP6ELTP.js";import{a as Ot}from"./chunk-LZDPGLQC.js";import{a as Ft}from"./chunk-VE7E4CMI.js";import{a as kt}from"./chunk-RQELFUR7.js";import{h as xt,i as ke}from"./chunk-ZFOFE4YQ.js";import"./chunk-LUY36RVE.js";import{a as Q,b as G,c as ae,d as he,e as W,f as _e,g as Y,h as He,i as Ce,j as Fe}from"./chunk-INS7BFHF.js";import{a as yt}from"./chunk-6WBH7IPC.js";import{a as Ge}from"./chunk-H4J6WUUW.js";import{b as ut}from"./chunk-EVH4XK5I.js";import{a as wt,b as fe}from"./chunk-YQT2ZH4O.js";import{a as gt,c as Ct}from"./chunk-LDB6UGBE.js";import{j as E}from"./chunk-3PMNG65X.js";import{a as B,b as se,g as z,h as ye,i as U,j as H}from"./chunk-4P6JCT6G.js";import{B as j,C as ge,b as V,d as D,f as O,g as $,h as Pe,i as ie,j as F,k as re,l as q,m as ft,n as Ve,o as $e,p as ht,q as _t,r as qe,v as vt,w as de,x as Se,y as ue,z as je}from"./chunk-ESTKDGOR.js";import"./chunk-HU7WFQWJ.js";import{a as I,b as y}from"./chunk-QCGIDFDQ.js";import{a as P,b as dt,c as pe,d as x}from"./chunk-RA5YA7SP.js";import{O as pt}from"./chunk-AE4C5XQ6.js";import{a as Re}from"./chunk-C5RMYWSX.js";import"./chunk-P4ZELJWN.js";import{b as ce,c as mt,d as A,e as ne,f as ct,i as oe}from"./chunk-CG5ODPV4.js";import"./chunk-OQ23N4OO.js";import"./chunk-MB2EZ7OD.js";import{$ as nt,$a as me,C as Ke,Ca as ot,Db as xe,Eb as Me,Fa as ve,G as et,Ib as d,Ob as M,P as Xe,Pb as be,Rb as K,Sb as X,T as tt,Tb as o,Ub as i,Vb as m,Xb as b,Zb as g,_b as c,bb as Ne,bc as st,cb as l,db as h,dc as Z,ec as ee,fa as f,fc as te,ic as N,jc as s,kc as R,l as Ye,lc as T,ma as C,na as w,pb as _,qc as at,r as Je,rb as it,rc as lt,tb as L,wb as v,xb as rt}from"./chunk-UUT3EF6T.js";var Lt=(()=>{class n{constructor(){this.snsHttp=f(yt),this.userService=f(Oe),this.BASE_URL="/posts/feed",this.loadDate=new Date,this.lastUpdateDate=this.loadDate,this.view="top",this.top=ve([]),this.top$=this.top.asReadonly(),this.latest=ve([]),this.latest$=this.latest.asReadonly(),this.follows=ve([]),this.follows$=this.follows.asReadonly(),this.newTop=ve([]),this.newTop$=this.newTop.asReadonly(),this.newLatest=ve([]),this.newLatest$=this.newLatest.asReadonly(),this.newFollows=ve([]),this.newFollows$=this.newFollows.asReadonly(),this.pages={top:0,latest:0,follows:0},this.scrolls={top:0,latest:0,follows:0},this.loading={top:!1,latest:!1,follows:!1},this.subs=[],this.loading.top=!0,this.loading.latest=!0,this.loading.follows=!0,this.getTop({before:this.loadDate,page:0}).subscribe(e=>{this.top.set(e),this.pages.top=1}).add(()=>this.loading.top=!1),this.getLatest({before:this.loadDate,page:0}).subscribe(e=>{this.latest.set(e),this.pages.latest=1}).add(()=>this.loading.latest=!1),this.getFollows({before:this.loadDate,page:0}).subscribe(e=>{this.follows.set(e),this.pages.follows=1}).add(()=>this.loading.follows=!1)}ngOnDestroy(){for(let e of this.subs)e.unsubscribe()}setView(e){this.view=e}get currentView(){return this.view}loadMore(e){if(!this.loading[e]){var t;switch(e){case"top":t=this.getTop({before:this.loadDate,page:this.pages[e]});break;case"latest":t=this.getLatest({before:this.loadDate,page:this.pages[e]});break;case"follows":t=this.getFollows({before:this.loadDate,page:this.pages[e]});break}this.handleRequest(t,e)}}checkForUpdates(){this.getNewTop({after:this.lastUpdateDate,page:0}).subscribe(e=>{e.length>0&&this.newTop.update(t=>[...e,...t])}),this.getNewLatest({after:this.lastUpdateDate,page:0}).subscribe(e=>{e.length>0&&this.newLatest.update(t=>[...e,...t])}),this.getNewFollows({after:this.lastUpdateDate,page:0}).subscribe(e=>{e.length>0&&this.newFollows.update(t=>[...e,...t])}),this.lastUpdateDate=new Date}showNewPosts(e){switch(e){case"top":this.top.update(t=>[...this.newTop(),...t]),this.newTop.set([]);break;case"latest":this.latest.update(t=>[...this.newLatest(),...t]),this.newLatest.set([]);break;case"follows":this.follows.update(t=>[...this.newFollows(),...t]),this.newFollows.set([]);break}}updateScroll(e,t){switch(e){case"top":this.scrolls[e]=t;break;case"latest":this.scrolls[e]=t;break;case"follows":this.scrolls[e]=t;break}}getScroll(e){switch(e){case"top":return this.scrolls[e];case"latest":return this.scrolls[e];case"follows":return this.scrolls[e]}return 0}getTop(e){return this.get(`${this.BASE_URL}/top?${this.params(e)}`)}getLatest(e){return this.get(`${this.BASE_URL}/latest?${this.params(e)}`)}getFollows(e){return this.get(`${this.BASE_URL}/follows?${this.params(e)}`)}getNewTop(e){return this.get(`${this.BASE_URL}/top/new?${this.params(e)}`)}getNewLatest(e){return this.get(`${this.BASE_URL}/latest/new?${this.params(e)}`)}getNewFollows(e){return this.get(`${this.BASE_URL}/follows/new?${this.params(e)}`)}handleRequest(e,t){let r=this.pages[t];this.loading[t]=!0,e.subscribe({next:a=>{switch(this.pages[t]=r+1,t){case"top":this.top.update(u=>this.appendMorePosts(u,a));break;case"latest":this.latest.update(u=>this.appendMorePosts(u,a));break;case"follows":this.follows.update(u=>this.appendMorePosts(u,a));break}},error:a=>{console.log(a)}}).add(()=>this.loading[t]=!1)}appendMorePosts(e,t){let r=[...e];for(let a of t)r.findIndex(S=>S.id==a.id)<0&&r.push(a);return r}params(e){var t=[];return e.before&&t.push(`before=${e.before}`),e.after&&t.push(`after=${e.after}`),t.push(`page=${e.page}`),t.join("&")}get(e){return this.snsHttp.get$(e)}post(e,t){return this.snsHttp.post$(e,t)}delete(e){return this.snsHttp.delete$(e)}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var Ze=(n,p)=>p.id,en=()=>[import("./chunk-QKGE2KDD.js").then(n=>n.AnnouncementComponent),import("./chunk-3IAPCRJ6.js").then(n=>n.ArticleComponent),import("./chunk-UPV2CGER.js").then(n=>n.PictorialComponent),import("./chunk-OHVWT37R.js").then(n=>n.CommentComponent),import("./chunk-M3URHEY3.js").then(n=>n.BasicPostComponent)];function tn(n,p){if(n&1){let e=b();o(0,"div",9),g("click",function(){C(e);let r=c(2);return w(r.showNewPosts("top"))}),o(1,"span"),s(2),i()()}if(n&2){let e=c(2);l(2),R("Show "+e.newTop().length+" New Posts")}}function nn(n,p){if(n&1&&m(0,"sns-basic-post",10),n&2){let e=c().$implicit,t=c(2);d("post",e)("user",t.me())}}function on(n,p){if(n&1&&m(0,"sns-basic-post",10),n&2){let e=c().$implicit,t=c(2);d("post",e)("user",t.me())}}function rn(n,p){if(n&1&&m(0,"sns-announcement",10),n&2){let e=c().$implicit,t=c(2);d("post",t.announcement(e))("user",t.me())}}function sn(n,p){if(n&1&&m(0,"sns-comment",10),n&2){let e=c().$implicit,t=c(2);d("post",t.comment(e))("user",t.me())}}function an(n,p){if(n&1&&m(0,"sns-pictorial",10),n&2){let e=c().$implicit,t=c(2);d("post",t.pictorial(e))("user",t.me())}}function ln(n,p){if(n&1&&m(0,"sns-article",10),n&2){let e=c().$implicit,t=c(2);d("post",t.article(e))("user",t.me())}}function mn(n,p){if(n&1&&v(0,nn,1,2,"sns-basic-post",10)(1,on,1,2,"sns-basic-post",10)(2,rn,1,2,"sns-announcement",10)(3,sn,1,2,"sns-comment",10)(4,an,1,2,"sns-pictorial",10)(5,ln,1,2,"sns-article",10),n&2){let e,t=p.$implicit;M((e=t.type)==="basic"?0:e==="post"?1:e==="announcement"?2:e==="comment"?3:e==="pictorial"?4:e==="article"?5:-1)}}function cn(n,p){if(n&1){let e=b();o(0,"div",9),g("click",function(){C(e);let r=c(2);return w(r.showNewPosts("latest"))}),o(1,"span"),s(2),i()()}if(n&2){let e=c(2);l(2),R("Show "+e.newLatest().length+" New Posts")}}function pn(n,p){if(n&1&&m(0,"sns-basic-post",10),n&2){let e=c().$implicit,t=c(2);d("post",e)("user",t.me())}}function dn(n,p){if(n&1&&m(0,"sns-basic-post",10),n&2){let e=c().$implicit,t=c(2);d("post",e)("user",t.me())}}function un(n,p){if(n&1&&m(0,"sns-announcement",10),n&2){let e=c().$implicit,t=c(2);d("post",t.announcement(e))("user",t.me())}}function gn(n,p){if(n&1&&m(0,"sns-comment",10),n&2){let e=c().$implicit,t=c(2);d("post",t.comment(e))("user",t.me())}}function fn(n,p){if(n&1&&m(0,"sns-pictorial",10),n&2){let e=c().$implicit,t=c(2);d("post",t.pictorial(e))("user",t.me())}}function hn(n,p){if(n&1&&m(0,"sns-article",10),n&2){let e=c().$implicit,t=c(2);d("post",t.article(e))("user",t.me())}}function _n(n,p){if(n&1&&v(0,pn,1,2,"sns-basic-post",10)(1,dn,1,2,"sns-basic-post",10)(2,un,1,2,"sns-announcement",10)(3,gn,1,2,"sns-comment",10)(4,fn,1,2,"sns-pictorial",10)(5,hn,1,2,"sns-article",10),n&2){let e,t=p.$implicit;M((e=t.type)==="basic"?0:e==="post"?1:e==="announcement"?2:e==="comment"?3:e==="pictorial"?4:e==="article"?5:-1)}}function vn(n,p){if(n&1){let e=b();o(0,"div",9),g("click",function(){C(e);let r=c(2);return w(r.showNewPosts("follows"))}),o(1,"span"),s(2),i()()}if(n&2){let e=c(2);l(2),R("Show "+e.newFollows().length+" New Posts")}}function Cn(n,p){if(n&1&&m(0,"sns-basic-post",10),n&2){let e=c().$implicit,t=c(2);d("post",e)("user",t.me())}}function wn(n,p){if(n&1&&m(0,"sns-basic-post",10),n&2){let e=c().$implicit,t=c(2);d("post",e)("user",t.me())}}function xn(n,p){if(n&1&&m(0,"sns-announcement",10),n&2){let e=c().$implicit,t=c(2);d("post",t.announcement(e))("user",t.me())}}function Mn(n,p){if(n&1&&m(0,"sns-comment",10),n&2){let e=c().$implicit,t=c(2);d("post",t.comment(e))("user",t.me())}}function bn(n,p){if(n&1&&m(0,"sns-pictorial",10),n&2){let e=c().$implicit,t=c(2);d("post",t.pictorial(e))("user",t.me())}}function Pn(n,p){if(n&1&&m(0,"sns-article",10),n&2){let e=c().$implicit,t=c(2);d("post",t.article(e))("user",t.me())}}function Sn(n,p){if(n&1&&v(0,Cn,1,2,"sns-basic-post",10)(1,wn,1,2,"sns-basic-post",10)(2,xn,1,2,"sns-announcement",10)(3,Mn,1,2,"sns-comment",10)(4,bn,1,2,"sns-pictorial",10)(5,Pn,1,2,"sns-article",10),n&2){let e,t=p.$implicit;M((e=t.type)==="basic"?0:e==="post"?1:e==="announcement"?2:e==="comment"?3:e==="pictorial"?4:e==="article"?5:-1)}}function yn(n,p){if(n&1&&(o(0,"div",6),v(1,tn,3,1,"div",7),o(2,"div",8),K(3,mn,6,1,null,null,Ze),i()(),o(5,"div",6),v(6,cn,3,1,"div",7),o(7,"div",8),K(8,_n,6,1,null,null,Ze),i()(),o(10,"div",6),v(11,vn,3,1,"div",7),o(12,"div",8),K(13,Sn,6,1,null,null,Ze),i()()),n&2){let e=c();d("hidden",e.feedView.value!="top"),l(),M(e.newTop().length>0?1:-1),l(2),X(e.top()),l(2),d("hidden",e.feedView.value!="latest"),l(),M(e.newLatest().length>0?6:-1),l(2),X(e.latest()),l(2),d("hidden",e.feedView.value!="follows"),l(),M(e.newFollows().length>0?11:-1),l(2),X(e.follows())}}function On(n,p){n&1&&(o(0,"div",11),m(1,"mat-progress-spinner",12),i())}function Fn(n,p){n&1&&(o(0,"div"),s(1,"Failed to load posts"),i())}var Nt=(()=>{class n{constructor(){this.userService=f(Oe),this.feedService=f(Lt),this.feedView=new F("top"),this.throttler=new Ct,this.subs=[],this.announcement=Mt,this.comment=bt,this.pictorial=Pt,this.article=St,this.me=this.userService.me$,this.top=this.feedService.top$,this.latest=this.feedService.latest$,this.follows=this.feedService.follows$,this.newTop=this.feedService.newTop$,this.newLatest=this.feedService.newLatest$,this.newFollows=this.feedService.newFollows$,this.feedView.setValue(this.feedService.currentView),this.updateChecks=setInterval(()=>{this.feedService.checkForUpdates()},6e4)}ngOnInit(){}ngOnDestroy(){for(let e of this.subs)e.unsubscribe();clearInterval(this.updateChecks)}switchView(e){let t=e.value;switch(t){case"top":this.feedService.setView(t);break;case"latest":this.feedService.setView(t);break;case"follows":this.feedService.setView(t);break}window.scrollTo({top:this.feedService.getScroll(t),behavior:"instant"})}showNewPosts(e){this.feedService.showNewPosts(e)}onScroll(){let e=window.document.documentElement,t=e.scrollHeight-(e.scrollTop+e.offsetHeight);this.feedService.updateScroll(this.feedView.value,e.scrollTop),t<Math.min(2e3,e.scrollHeight*.1)&&this.throttler.throttle(()=>{let r=this.feedView.value;this.feedService.loadMore(r)},3e3)}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=_({type:n,selectors:[["sns-feed"]],hostBindings:function(t,r){t&1&&g("scroll",function(){return r.onScroll()},!1,Ne)},decls:13,vars:3,consts:[[1e3,null],["id","sns-feed"],["value","top",3,"change","formControl"],["value","top",3,"checked"],["value","latest"],["value","follows"],[3,"hidden"],[1,"view-new-posts"],[1,"post-feed"],[1,"view-new-posts",3,"click"],[3,"post","user"],[1,"loading"],["mode","indeterminate"]],template:function(t,r){t&1&&(o(0,"div",1)(1,"mat-button-toggle-group",2),g("change",function(u){return r.switchView(u)}),o(2,"mat-button-toggle",3),s(3,"Top"),i(),o(4,"mat-button-toggle",4),s(5,"Latest"),i(),o(6,"mat-button-toggle",5),s(7,"Follows"),i()(),v(8,yn,15,6)(9,On,2,0)(10,Fn,2,0),xe(11,8,en,9,null,10,0,null,rt),i()),t&2&&(l(),d("formControl",r.feedView),l(),d("checked",!0),l(9),Me(r.me))},dependencies:[y,Ue,Be,ze,x,gt,xt,ut,ge,O,Ve],styles:["#sns-feed[_ngcontent-%COMP%]{flex:1;display:flex;flex-flow:column;gap:1rem}mat-button-toggle-group[_ngcontent-%COMP%]{position:sticky;top:0%;width:100%;padding-top:1rem;border:none;border-radius:0;background-color:var(--sns-bg-trans);z-index:100}mat-button-toggle[_ngcontent-%COMP%]{color:var(--sns-text-color);width:100%;border:none!important}.post-feed[_ngcontent-%COMP%]{display:flex;flex-flow:column;gap:1rem}.new-post[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;gap:1rem;align-items:center}.loading[_ngcontent-%COMP%]{flex:1;display:flex;justify-content:center;padding-top:10rem}.view-new-posts[_ngcontent-%COMP%]{font-size:1.1rem;padding:1rem;margin:1rem 0rem 2rem;border:1px solid var(--sns-show-posts-border-color);border-radius:3px}.view-new-posts[_ngcontent-%COMP%]:hover{cursor:pointer;background-color:var(--sns-hover-color)}"]})}}return n})();var Rt=(()=>{class n{constructor(){}ngOnInit(){}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=_({type:n,selectors:[["sns-home"]],decls:3,vars:0,consts:[["id","sns-home"],[1,"main-content"],[1,"side-content"]],template:function(t,r){t&1&&(o(0,"div",0),m(1,"sns-feed",1)(2,"sns-search",2),i())},dependencies:[Nt,It],styles:["#sns-home[_ngcontent-%COMP%]{position:relative;display:flex;flex-flow:row nowrap;justify-content:center;width:100%;max-height:100%}@media (max-width:1080px){.main-content[_ngcontent-%COMP%]{min-width:10rem;padding-right:1rem}.side-content[_ngcontent-%COMP%]{flex:0!important;width:0px!important;min-width:0px!important;visibility:collapse}}"]})}}return n})();var Vt=(()=>{class n{constructor(e){this.eleRef=e}ngOnInit(){let e=this.eleRef.nativeElement;e.value=this.minNumber,console.log("her",this.minNumber)}onInput(e){let t=this.eleRef.nativeElement;t.value>this.maxNumber&&(t.value=this.maxNumber),t.value<this.minNumber&&(t.value=this.minNumber)}static{this.\u0275fac=function(t){return new(t||n)(h(ot))}}static{this.\u0275dir=it({type:n,selectors:[["","numberBounds",""]],hostBindings:function(t,r){t&1&&g("input",function(u){return r.onInput(u)})},inputs:{minNumber:"minNumber",maxNumber:"maxNumber"}})}}return n})();var kn=["postForm"];function In(n,p){n&1&&(o(0,"mat-form-field",14)(1,"mat-label"),s(2,"Duration"),i(),m(3,"input",21,4),o(5,"mat-hint",16),s(6,"Number of days (1-180) before the announcement is removed"),i()()),n&2&&(l(3),d("minNumber",1)("maxNumber",180))}var $t=(()=>{class n extends ke{constructor(e,t){super(),this.data=e,this.dialogRef=t,this.announcementService=f(Ot),this.user=e.user}createPost(){let e=new Date,t=this.postForm.value.permanent=="true",r={permanent:t,duration:t?0:this.postForm.value.duration,id:"",title:this.postForm.value.title,content:this.postForm.value.content,author:this.user,views:0,likes:0,comments:0,created_on:e,last_updated_on:e,type:"announcement"};console.log(r);let a=new FormData;a.append("post",new Blob([JSON.stringify(r)],{type:"application/json"})),this.announcementService.newPost$(a).subscribe({next:u=>{console.log(u),this.dialogRef.close({hasPosted:!0,post:u})},error:u=>{console.log(u);let S=u.error.message;S.toLowerCase().includes("one permanent")&&this.toastService.show({type:"danger",source_feature:"sns",header:"Failed to post",body:"You may only have one permanent announcement at a time"}),S.toLowerCase().includes("two announcement")&&this.toastService.show({type:"danger",source_feature:"sns",header:"Failed to post",body:"You may only have two announcements at a time"})}})}close(){this.dialogRef.close({hasPosted:!0})}static{this.\u0275fac=function(t){return new(t||n)(h(G),h(Q))}}static{this.\u0275cmp=_({type:n,selectors:[["compose-announcement"]],viewQuery:function(t,r){if(t&1&&Z(kn,5),t&2){let a;ee(a=te())&&(r.postForm=a.first)}},features:[L],decls:42,vars:8,consts:[["postForm","ngForm"],["title",""],["content",""],["permament",""],["duration",""],[1,"compose-post"],[1,"compose-header"],["mat-icon-button","","mat-dialog-close","",1,"compose-cancel"],["fontIcon","close"],[1,"compose-description"],[3,"submit"],[1,"create-post"],[1,"avatar-wrapper"],[1,"avatar",3,"title","src"],["appearance","outline",1,"compose-input"],["name","title","matInput","","ngModel","","maxlength","256","placeholder","Title...","minlength","8","cdkFocusInitial","","required",""],["align","end"],["name","content","rich-input","","matInput","","ngModel","","maxlength","512","placeholder","Announcement content...","required",""],["name","permanent","matSelect","","ngModel","","placeholder","Is Announcement Permament...","required",""],[3,"value"],["type","submit","mat-button","",3,"disabled"],["name","duration","type","number","numberBounds","","matInput","","ngModel","","max","180","placeholder","Duration...","required","",3,"minNumber","maxNumber"]],template:function(t,r){if(t&1){let a=b();o(0,"div",5)(1,"div",6)(2,"button",7),m(3,"mat-icon",8),i(),o(4,"div",9)(5,"span"),s(6,"Creating Announcement"),i()()(),o(7,"form",10,0),g("submit",function(){return C(a),w(r.createPost())}),o(9,"div",11)(10,"div",12),m(11,"img",13),i(),o(12,"mat-dialog-content")(13,"mat-form-field",14)(14,"mat-label"),s(15,"Title"),i(),m(16,"input",15,1),o(18,"mat-hint",16),s(19),i()(),o(20,"mat-form-field",14)(21,"mat-label"),s(22,"Content"),i(),m(23,"textarea",17,2),o(25,"mat-hint",16),s(26),i()(),o(27,"mat-form-field",14)(28,"mat-label"),s(29,"Is Announcement Permament?"),i(),o(30,"mat-select",18,3)(32,"mat-option",19),s(33,"No"),i(),o(34,"mat-option",19),s(35,"Yes"),i()(),o(36,"mat-hint",16),s(37,"You may only have one permament at a time"),i()(),v(38,In,7,2,"mat-form-field",14),i()(),o(39,"mat-dialog-actions")(40,"button",20),s(41,"Done"),i()()()()}if(t&2){let a=N(8),u=N(17),S=N(24),Le=N(31);l(11),d("title","avatar")("src",r.user.avatar,me),l(8),T("",u.value.length," / 256 (Min: 8)"),l(7),T("",S.value.length," / 512"),l(6),d("value","false"),l(2),d("value","true"),l(4),M(Le.value=="false"?38:-1),l(2),d("disabled",a.invalid)}},dependencies:[j,q,V,ft,O,$,de,Se,ue,vt,re,ie,Vt,H,U,z,B,se,fe,wt,pt,ye,x,P,pe,y,I,Y,he,_e,W],styles:["mat-card-actions[_ngcontent-%COMP%]{justify-content:end;gap:1rem;padding:0rem 1rem}.post[_ngcontent-%COMP%]{color:#000;border-color:var(--sns-post-border-color);border-radius:5px;overflow:hidden;background-color:var(--sns-post-bg-color)}.post[_ngcontent-%COMP%]:hover{cursor:pointer;background-color:var(--sns-hover-color)}.post-title[_ngcontent-%COMP%], .author-identification[_ngcontent-%COMP%], .post-date[_ngcontent-%COMP%], .post-content[_ngcontent-%COMP%], .post-summary[_ngcontent-%COMP%]{color:var(--sns-post-text-color)}.post-title[_ngcontent-%COMP%]{text-wrap:nowrap;text-overflow:ellipsis;overflow:hidden}.author-identification[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;gap:.5rem}.author-displayname[_ngcontent-%COMP%]{text-wrap:nowrap;text-overflow:ellipsis;overflow:hidden}.author-username[_ngcontent-%COMP%]{text-wrap:nowrap;color:var(--sns-username-color)}.post-media[_ngcontent-%COMP%]{max-height:700px;object-fit:cover}.post-action[_ngcontent-%COMP%]{height:1.75rem;box-shadow:none!important;background-color:transparent;color:var(--sns-post-text-color)}.post-action[_ngcontent-%COMP%]:hover{scale:1.05}.delete-post[_ngcontent-%COMP%]{position:absolute;left:1rem}.action-like[_ngcontent-%COMP%]{color:var(--sns-like-post-color)}.action-comment[_ngcontent-%COMP%]{color:var(--sns-comment-post-color)}.action-delete[_ngcontent-%COMP%]{color:red}.post-date[_ngcontent-%COMP%]{flex:1;justify-self:end;text-align:end;text-wrap:nowrap}.post-categories[_ngcontent-%COMP%]{flex:1;font-size:.9rem;display:flex;flex-flow:row nowrap;gap:.5rem;text-overflow:ellipsis}.post-categories[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.post-purpose[_ngcontent-%COMP%], .post-topic[_ngcontent-%COMP%], .post-mood[_ngcontent-%COMP%]{padding:.2rem;border:1px solid rgba(0,0,0,35%);border-radius:.3rem}.post-purpose[_ngcontent-%COMP%]{background-color:var(--sns-post-purpose-color)}.post-topic[_ngcontent-%COMP%]{background-color:var(--sns-post-topic-color)}.post-mood[_ngcontent-%COMP%]{background-color:var(--sns-post-mood-color)}.post-footer[_ngcontent-%COMP%]{padding-top:1rem;padding-bottom:.5rem}@media (max-width:1080px){.post-title[_ngcontent-%COMP%]{font-size:1.25rem}.author-identification[_ngcontent-%COMP%], .post-date[_ngcontent-%COMP%]{font-size:.9rem}.post-content[_ngcontent-%COMP%], .post-summary[_ngcontent-%COMP%]{font-size:1rem}.post-action[_ngcontent-%COMP%]{padding:.25rem}}.compose-post[_ngcontent-%COMP%]{--avatar-size: 3rem;min-width:30rem;border-radius:0rem!important}.compose-header[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;justify-content:space-between;align-items:center;padding:.1rem 0rem}.compose-cancel[_ngcontent-%COMP%]{margin:0rem .25rem}.compose-cancel[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-bottom:5px}.compose-description[_ngcontent-%COMP%]{margin:0rem 1rem}.create-post[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;gap:.5rem;align-items:start;padding:.5rem}.avatar-wrapper[_ngcontent-%COMP%]{position:relative;float:left;flex-shrink:0;width:var(--avatar-size);height:var(--avatar-size);margin-top:.75rem;border-radius:100%;overflow:hidden}.avatar[_ngcontent-%COMP%]{width:var(--avatar-size);height:var(--avatar-size);object-fit:cover}.compose-input[_ngcontent-%COMP%]{width:100%}.upload-media[_ngcontent-%COMP%]{position:relative;margin-right:auto}.add-file-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:0px;width:0px;overflow:hidden}.upload-label[_ngcontent-%COMP%]:hover{cursor:pointer;scale:1.05}.selected-media-list[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;gap:.5rem}.selected-media[_ngcontent-%COMP%]{position:relative}.selected-media-media[_ngcontent-%COMP%]{height:150px;border:1px solid;border-radius:3px}.remove-media[_ngcontent-%COMP%]{position:absolute;top:.1rem;right:.1rem;border-radius:100%;background-color:#00000080}.remove-media[_ngcontent-%COMP%]:hover{background-color:#00000059}.remove-media[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{color:red}mat-dialog-content[_ngcontent-%COMP%]{padding:1rem .75rem .25rem!important}mat-dialog-actions[_ngcontent-%COMP%]{padding-top:.25rem!important}@media (max-width:32rem){.compose-post[_ngcontent-%COMP%]{min-width:unset;width:400px}}"]})}}return n})();var Dn=["postForm"];function En(n,p){n&1&&(o(0,"div",14),s(1,"Pictorials require 1 or more media attachments"),i())}function Tn(n,p){if(n&1){let e=b();o(0,"div",16)(1,"div",22)(2,"button",23),g("click",function(){let r=C(e),a=r.$implicit,u=r.$index,S=c();return w(S.removeMedia(a,u))}),m(3,"mat-icon",5),i()(),m(4,"img",24),i()}if(n&2){let e=p.$implicit;l(4),d("src",e.data,me)}}var qt=(()=>{class n extends ke{constructor(e,t){super(),this.data=e,this.dialogRef=t,this.postService=f(Ft),this.user=e.user}createPost(){let e=new Date,t={id:"",title:this.postForm.value.title,content:this.postForm.value.content,author:this.user,views:0,likes:0,comments:0,created_on:e,last_updated_on:e,type:"pictorial"};console.log(t);let r=new FormData;r.append("post",new Blob([JSON.stringify(t)],{type:"application/json"}));for(let a of this.media)r.append("media",a);this.postService.newPost$(r).subscribe({next:a=>{console.log(a),this.dialogRef.close({hasPosted:!0,post:a})},error:a=>{console.log(a);let u=a.error.message;this.toastService.show({type:"danger",source_feature:"sns",header:"Failed to post"})}})}close(){this.dialogRef.close({hasPosted:!0})}get invalidMediaCount(){return this.media.length<1||9<this.media.length}static{this.\u0275fac=function(t){return new(t||n)(h(G),h(Q))}}static{this.\u0275cmp=_({type:n,selectors:[["compose-pictorial"]],viewQuery:function(t,r){if(t&1&&Z(Dn,5),t&2){let a;ee(a=te())&&(r.postForm=a.first)}},features:[L],decls:31,vars:6,consts:[["postForm","ngForm"],["title",""],[1,"compose-post"],[1,"compose-header"],["mat-icon-button","","mat-dialog-close","",1,"compose-cancel"],["fontIcon","close"],[1,"compose-description"],[3,"submit"],[1,"create-post"],[1,"avatar-wrapper"],[1,"avatar",3,"title","src"],["appearance","outline",1,"compose-input"],["name","title","matInput","","ngModel","","maxlength","256","placeholder","Title...","minlength","8","cdkFocusInitial","","required",""],["align","end"],[1,"hint-error"],[1,"selected-media-list"],[1,"selected-media"],["title","Add Media",1,"upload-media"],["for","add-image"],["fontIcon","image",1,"upload-label"],["id","add-image","type","file",1,"add-file-image",3,"change","accept"],["type","submit","mat-button","",3,"disabled"],[1,"remove-media"],["mat-icon-button","","title","Remove Media",3,"click"],[1,"selected-media-media",3,"src"]],template:function(t,r){if(t&1){let a=b();o(0,"div",2)(1,"div",3)(2,"button",4),m(3,"mat-icon",5),i(),o(4,"div",6)(5,"span"),s(6,"Creating Pictorial"),i()()(),o(7,"form",7,0),g("submit",function(){return C(a),w(r.createPost())}),o(9,"div",8)(10,"div",9),m(11,"img",10),i(),o(12,"mat-dialog-content")(13,"mat-form-field",11)(14,"mat-label"),s(15,"Title"),i(),m(16,"input",12,1),o(18,"mat-hint",13),s(19),i()(),v(20,En,2,0,"div",14),o(21,"div",15),K(22,Tn,5,1,"div",16,be),i()()(),o(24,"mat-dialog-actions")(25,"div",17)(26,"label",18),m(27,"mat-icon",19),i(),o(28,"input",20),g("change",function(S){return C(a),w(r.addMedia(S))}),i()(),o(29,"button",21),s(30,"Done"),i()()()()}if(t&2){let a=N(8),u=N(17);l(11),d("title","avatar")("src",r.user.avatar,me),l(8),T("",u.value.length," / 256 (Min: 8)"),l(),M(r.invalidMediaCount?20:-1),l(2),X(r.selectedMedia),l(6),d("accept",r.validMediaTypes),l(),d("disabled",a.invalid||r.invalidMediaCount)}},dependencies:[j,q,V,O,$,de,Se,ue,re,ie,H,U,z,B,se,fe,ye,x,P,pe,y,I,Y,he,_e,W],styles:["mat-card-actions[_ngcontent-%COMP%]{justify-content:end;gap:1rem;padding:0rem 1rem}.post[_ngcontent-%COMP%]{color:#000;border-color:var(--sns-post-border-color);border-radius:5px;overflow:hidden;background-color:var(--sns-post-bg-color)}.post[_ngcontent-%COMP%]:hover{cursor:pointer;background-color:var(--sns-hover-color)}.post-title[_ngcontent-%COMP%], .author-identification[_ngcontent-%COMP%], .post-date[_ngcontent-%COMP%], .post-content[_ngcontent-%COMP%], .post-summary[_ngcontent-%COMP%]{color:var(--sns-post-text-color)}.post-title[_ngcontent-%COMP%]{text-wrap:nowrap;text-overflow:ellipsis;overflow:hidden}.author-identification[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;gap:.5rem}.author-displayname[_ngcontent-%COMP%]{text-wrap:nowrap;text-overflow:ellipsis;overflow:hidden}.author-username[_ngcontent-%COMP%]{text-wrap:nowrap;color:var(--sns-username-color)}.post-media[_ngcontent-%COMP%]{max-height:700px;object-fit:cover}.post-action[_ngcontent-%COMP%]{height:1.75rem;box-shadow:none!important;background-color:transparent;color:var(--sns-post-text-color)}.post-action[_ngcontent-%COMP%]:hover{scale:1.05}.delete-post[_ngcontent-%COMP%]{position:absolute;left:1rem}.action-like[_ngcontent-%COMP%]{color:var(--sns-like-post-color)}.action-comment[_ngcontent-%COMP%]{color:var(--sns-comment-post-color)}.action-delete[_ngcontent-%COMP%]{color:red}.post-date[_ngcontent-%COMP%]{flex:1;justify-self:end;text-align:end;text-wrap:nowrap}.post-categories[_ngcontent-%COMP%]{flex:1;font-size:.9rem;display:flex;flex-flow:row nowrap;gap:.5rem;text-overflow:ellipsis}.post-categories[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.post-purpose[_ngcontent-%COMP%], .post-topic[_ngcontent-%COMP%], .post-mood[_ngcontent-%COMP%]{padding:.2rem;border:1px solid rgba(0,0,0,35%);border-radius:.3rem}.post-purpose[_ngcontent-%COMP%]{background-color:var(--sns-post-purpose-color)}.post-topic[_ngcontent-%COMP%]{background-color:var(--sns-post-topic-color)}.post-mood[_ngcontent-%COMP%]{background-color:var(--sns-post-mood-color)}.post-footer[_ngcontent-%COMP%]{padding-top:1rem;padding-bottom:.5rem}@media (max-width:1080px){.post-title[_ngcontent-%COMP%]{font-size:1.25rem}.author-identification[_ngcontent-%COMP%], .post-date[_ngcontent-%COMP%]{font-size:.9rem}.post-content[_ngcontent-%COMP%], .post-summary[_ngcontent-%COMP%]{font-size:1rem}.post-action[_ngcontent-%COMP%]{padding:.25rem}}.compose-post[_ngcontent-%COMP%]{--avatar-size: 3rem;min-width:30rem;border-radius:0rem!important}.compose-header[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;justify-content:space-between;align-items:center;padding:.1rem 0rem}.compose-cancel[_ngcontent-%COMP%]{margin:0rem .25rem}.compose-cancel[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-bottom:5px}.compose-description[_ngcontent-%COMP%]{margin:0rem 1rem}.create-post[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;gap:.5rem;align-items:start;padding:.5rem}.avatar-wrapper[_ngcontent-%COMP%]{position:relative;float:left;flex-shrink:0;width:var(--avatar-size);height:var(--avatar-size);margin-top:.75rem;border-radius:100%;overflow:hidden}.avatar[_ngcontent-%COMP%]{width:var(--avatar-size);height:var(--avatar-size);object-fit:cover}.compose-input[_ngcontent-%COMP%]{width:100%}.upload-media[_ngcontent-%COMP%]{position:relative;margin-right:auto}.add-file-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:0px;width:0px;overflow:hidden}.upload-label[_ngcontent-%COMP%]:hover{cursor:pointer;scale:1.05}.selected-media-list[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;gap:.5rem}.selected-media[_ngcontent-%COMP%]{position:relative}.selected-media-media[_ngcontent-%COMP%]{height:150px;border:1px solid;border-radius:3px}.remove-media[_ngcontent-%COMP%]{position:absolute;top:.1rem;right:.1rem;border-radius:100%;background-color:#00000080}.remove-media[_ngcontent-%COMP%]:hover{background-color:#00000059}.remove-media[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{color:red}mat-dialog-content[_ngcontent-%COMP%]{padding:1rem .75rem .25rem!important}mat-dialog-actions[_ngcontent-%COMP%]{padding-top:.25rem!important}@media (max-width:32rem){.compose-post[_ngcontent-%COMP%]{min-width:unset;width:400px}}.hint-error[_ngcontent-%COMP%]{color:red}"]})}}return n})();var An=["postForm"];function Ln(n,p){if(n&1){let e=b();o(0,"div",17)(1,"div",23)(2,"button",24),g("click",function(){let r=C(e),a=r.$implicit,u=r.$index,S=c();return w(S.removeMedia(a,u))}),m(3,"mat-icon",6),i()(),m(4,"img",25),i()}if(n&2){let e=p.$implicit;l(4),d("src",e.data,me)}}var jt=(()=>{class n extends ke{constructor(e,t){super(),this.data=e,this.dialogRef=t,this.postService=f(kt),this.user=e.user}createPost(){let e=new Date,t={id:"",title:this.postForm.value.title,content:this.postForm.value.content,author:this.user,views:0,likes:0,comments:0,created_on:e,last_updated_on:e,type:"post"};console.log(t);let r=new FormData;r.append("post",new Blob([JSON.stringify(t)],{type:"application/json"})),r.append("media",this.media[0]),this.postService.newPost$(r).subscribe({next:a=>{console.log(a),this.dialogRef.close({hasPosted:!0,post:a})},error:a=>{console.log(a);let u=a.error.message;this.toastService.show({type:"danger",source_feature:"sns",header:"Failed to post"})}})}addMedia(e){this.selectedMedia.length=0,this.media.length=0,super.addMedia(e)}close(){this.dialogRef.close({hasPosted:!0})}static{this.\u0275fac=function(t){return new(t||n)(h(G),h(Q))}}static{this.\u0275cmp=_({type:n,selectors:[["compose-post"]],viewQuery:function(t,r){if(t&1&&Z(An,5),t&2){let a;ee(a=te())&&(r.postForm=a.first)}},features:[L],decls:37,vars:6,consts:[["postForm","ngForm"],["title",""],["content",""],[1,"compose-post"],[1,"compose-header"],["mat-icon-button","","mat-dialog-close","",1,"compose-cancel"],["fontIcon","close"],[1,"compose-description"],[3,"submit"],[1,"create-post"],[1,"avatar-wrapper"],[1,"avatar",3,"title","src"],["appearance","outline",1,"compose-input"],["name","title","matInput","","ngModel","","maxlength","256","placeholder","Title...","minlength","8","cdkFocusInitial","","required",""],["align","end"],["name","content","rich-input","","matInput","","ngModel","","maxlength","512","placeholder","Post content...","required",""],[1,"selected-media-list"],[1,"selected-media"],["title","Add Media",1,"upload-media"],["for","add-image"],["fontIcon","image",1,"upload-label"],["id","add-image","type","file",1,"add-file-image",3,"change","accept"],["type","submit","mat-button","",3,"disabled"],[1,"remove-media"],["mat-icon-button","","title","Remove Media",3,"click"],[1,"selected-media-media",3,"src"]],template:function(t,r){if(t&1){let a=b();o(0,"div",3)(1,"div",4)(2,"button",5),m(3,"mat-icon",6),i(),o(4,"div",7)(5,"span"),s(6,"Creating Post"),i()()(),o(7,"form",8,0),g("submit",function(){return C(a),w(r.createPost())}),o(9,"div",9)(10,"div",10),m(11,"img",11),i(),o(12,"mat-dialog-content")(13,"mat-form-field",12)(14,"mat-label"),s(15,"Title"),i(),m(16,"input",13,1),o(18,"mat-hint",14),s(19),i()(),o(20,"mat-form-field",12)(21,"mat-label"),s(22,"Content"),i(),m(23,"textarea",15,2),o(25,"mat-hint",14),s(26),i()(),o(27,"div",16),K(28,Ln,5,1,"div",17,be),i()()(),o(30,"mat-dialog-actions")(31,"div",18)(32,"label",19),m(33,"mat-icon",20),i(),o(34,"input",21),g("change",function(S){return C(a),w(r.addMedia(S))}),i()(),o(35,"button",22),s(36,"Done"),i()()()()}if(t&2){let a=N(8),u=N(17),S=N(24);l(11),d("title","avatar")("src",r.user.avatar,me),l(8),T("",u.value.length," / 256 (Min: 8)"),l(7),T("",S.value.length," / 512"),l(2),X(r.selectedMedia),l(6),d("accept",r.validMediaTypes),l(),d("disabled",a.invalid)}},dependencies:[j,q,V,O,$,de,Se,ue,re,ie,H,U,z,B,se,fe,ye,x,P,pe,y,I,Y,he,_e,W],styles:["mat-card-actions[_ngcontent-%COMP%]{justify-content:end;gap:1rem;padding:0rem 1rem}.post[_ngcontent-%COMP%]{color:#000;border-color:var(--sns-post-border-color);border-radius:5px;overflow:hidden;background-color:var(--sns-post-bg-color)}.post[_ngcontent-%COMP%]:hover{cursor:pointer;background-color:var(--sns-hover-color)}.post-title[_ngcontent-%COMP%], .author-identification[_ngcontent-%COMP%], .post-date[_ngcontent-%COMP%], .post-content[_ngcontent-%COMP%], .post-summary[_ngcontent-%COMP%]{color:var(--sns-post-text-color)}.post-title[_ngcontent-%COMP%]{text-wrap:nowrap;text-overflow:ellipsis;overflow:hidden}.author-identification[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;gap:.5rem}.author-displayname[_ngcontent-%COMP%]{text-wrap:nowrap;text-overflow:ellipsis;overflow:hidden}.author-username[_ngcontent-%COMP%]{text-wrap:nowrap;color:var(--sns-username-color)}.post-media[_ngcontent-%COMP%]{max-height:700px;object-fit:cover}.post-action[_ngcontent-%COMP%]{height:1.75rem;box-shadow:none!important;background-color:transparent;color:var(--sns-post-text-color)}.post-action[_ngcontent-%COMP%]:hover{scale:1.05}.delete-post[_ngcontent-%COMP%]{position:absolute;left:1rem}.action-like[_ngcontent-%COMP%]{color:var(--sns-like-post-color)}.action-comment[_ngcontent-%COMP%]{color:var(--sns-comment-post-color)}.action-delete[_ngcontent-%COMP%]{color:red}.post-date[_ngcontent-%COMP%]{flex:1;justify-self:end;text-align:end;text-wrap:nowrap}.post-categories[_ngcontent-%COMP%]{flex:1;font-size:.9rem;display:flex;flex-flow:row nowrap;gap:.5rem;text-overflow:ellipsis}.post-categories[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.post-purpose[_ngcontent-%COMP%], .post-topic[_ngcontent-%COMP%], .post-mood[_ngcontent-%COMP%]{padding:.2rem;border:1px solid rgba(0,0,0,35%);border-radius:.3rem}.post-purpose[_ngcontent-%COMP%]{background-color:var(--sns-post-purpose-color)}.post-topic[_ngcontent-%COMP%]{background-color:var(--sns-post-topic-color)}.post-mood[_ngcontent-%COMP%]{background-color:var(--sns-post-mood-color)}.post-footer[_ngcontent-%COMP%]{padding-top:1rem;padding-bottom:.5rem}@media (max-width:1080px){.post-title[_ngcontent-%COMP%]{font-size:1.25rem}.author-identification[_ngcontent-%COMP%], .post-date[_ngcontent-%COMP%]{font-size:.9rem}.post-content[_ngcontent-%COMP%], .post-summary[_ngcontent-%COMP%]{font-size:1rem}.post-action[_ngcontent-%COMP%]{padding:.25rem}}.compose-post[_ngcontent-%COMP%]{--avatar-size: 3rem;min-width:30rem;border-radius:0rem!important}.compose-header[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;justify-content:space-between;align-items:center;padding:.1rem 0rem}.compose-cancel[_ngcontent-%COMP%]{margin:0rem .25rem}.compose-cancel[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-bottom:5px}.compose-description[_ngcontent-%COMP%]{margin:0rem 1rem}.create-post[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;gap:.5rem;align-items:start;padding:.5rem}.avatar-wrapper[_ngcontent-%COMP%]{position:relative;float:left;flex-shrink:0;width:var(--avatar-size);height:var(--avatar-size);margin-top:.75rem;border-radius:100%;overflow:hidden}.avatar[_ngcontent-%COMP%]{width:var(--avatar-size);height:var(--avatar-size);object-fit:cover}.compose-input[_ngcontent-%COMP%]{width:100%}.upload-media[_ngcontent-%COMP%]{position:relative;margin-right:auto}.add-file-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:0px;width:0px;overflow:hidden}.upload-label[_ngcontent-%COMP%]:hover{cursor:pointer;scale:1.05}.selected-media-list[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;gap:.5rem}.selected-media[_ngcontent-%COMP%]{position:relative}.selected-media-media[_ngcontent-%COMP%]{height:150px;border:1px solid;border-radius:3px}.remove-media[_ngcontent-%COMP%]{position:absolute;top:.1rem;right:.1rem;border-radius:100%;background-color:#00000080}.remove-media[_ngcontent-%COMP%]:hover{background-color:#00000059}.remove-media[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{color:red}mat-dialog-content[_ngcontent-%COMP%]{padding:1rem .75rem .25rem!important}mat-dialog-actions[_ngcontent-%COMP%]{padding-top:.25rem!important}@media (max-width:32rem){.compose-post[_ngcontent-%COMP%]{min-width:unset;width:400px}}"]})}}return n})();var Bt=(()=>{class n extends Fe{constructor(e,t){super(),this.data=e,this.dialogRef=t,this.feedView=new F("basic"),this.dialog=f(ae),this.user=e.user}ngOnInit(){}startComposition(){var e;switch(this.feedView.value){case"basic":e=this.dialog.open(jt,{scrollStrategy:new E,data:{user:this.user}});break;case"announcement":e=this.dialog.open($t,{scrollStrategy:new E,data:{user:this.user}});break;case"pictorial":e=this.dialog.open(qt,{scrollStrategy:new E,data:{user:this.user}});break}e&&e.afterClosed().pipe(et(1)).subscribe(t=>{t.hasPosted?this.dialogRef.close({hasPosted:t.hasPosted,post:t.post}):this.dialogRef.close({hasPosted:t.hasPosted})})}close(){this.dialogRef.close({hasPosted:!1})}static{this.\u0275fac=function(t){return new(t||n)(h(G),h(Q))}}static{this.\u0275cmp=_({type:n,selectors:[["choose-compose"]],features:[L],decls:19,vars:3,consts:[[1,"compose-post"],[1,"compose-header"],["mat-icon-button","","mat-dialog-close","",1,"compose-cancel"],["fontIcon","close"],[1,"compose-description"],[1,"create-post"],["value","basic",3,"formControl"],["value","basic",3,"checked"],["value","announcement"],["value","pictorial"],["type","submit","mat-button","",3,"click","disabled"]],template:function(t,r){t&1&&(o(0,"div",0)(1,"div",1)(2,"button",2),m(3,"mat-icon",3),i(),o(4,"div",4)(5,"span"),s(6,"Choose Type of Post"),i()()(),o(7,"div",5)(8,"mat-dialog-content")(9,"mat-button-toggle-group",6)(10,"mat-button-toggle",7),s(11,"Basic"),i(),o(12,"mat-button-toggle",8),s(13,"Announcement"),i(),o(14,"mat-button-toggle",9),s(15,"Pictorial"),i()()()(),o(16,"mat-dialog-actions")(17,"button",10),g("click",function(){return r.startComposition()}),s(18,"Start Composing"),i()()()),t&2&&(l(9),d("formControl",r.feedView),l(),d("checked",!0),l(7),d("disabled",r.feedView.invalid))},dependencies:[ge,O,Ve,x,P,pe,y,I,Ue,Be,ze,Y,he,_e,W],styles:["mat-card-actions[_ngcontent-%COMP%]{justify-content:end;gap:1rem;padding:0rem 1rem}.post[_ngcontent-%COMP%]{color:#000;border-color:var(--sns-post-border-color);border-radius:5px;overflow:hidden;background-color:var(--sns-post-bg-color)}.post[_ngcontent-%COMP%]:hover{cursor:pointer;background-color:var(--sns-hover-color)}.post-title[_ngcontent-%COMP%], .author-identification[_ngcontent-%COMP%], .post-date[_ngcontent-%COMP%], .post-content[_ngcontent-%COMP%], .post-summary[_ngcontent-%COMP%]{color:var(--sns-post-text-color)}.post-title[_ngcontent-%COMP%]{text-wrap:nowrap;text-overflow:ellipsis;overflow:hidden}.author-identification[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;gap:.5rem}.author-displayname[_ngcontent-%COMP%]{text-wrap:nowrap;text-overflow:ellipsis;overflow:hidden}.author-username[_ngcontent-%COMP%]{text-wrap:nowrap;color:var(--sns-username-color)}.post-media[_ngcontent-%COMP%]{max-height:700px;object-fit:cover}.post-action[_ngcontent-%COMP%]{height:1.75rem;box-shadow:none!important;background-color:transparent;color:var(--sns-post-text-color)}.post-action[_ngcontent-%COMP%]:hover{scale:1.05}.delete-post[_ngcontent-%COMP%]{position:absolute;left:1rem}.action-like[_ngcontent-%COMP%]{color:var(--sns-like-post-color)}.action-comment[_ngcontent-%COMP%]{color:var(--sns-comment-post-color)}.action-delete[_ngcontent-%COMP%]{color:red}.post-date[_ngcontent-%COMP%]{flex:1;justify-self:end;text-align:end;text-wrap:nowrap}.post-categories[_ngcontent-%COMP%]{flex:1;font-size:.9rem;display:flex;flex-flow:row nowrap;gap:.5rem;text-overflow:ellipsis}.post-categories[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.post-purpose[_ngcontent-%COMP%], .post-topic[_ngcontent-%COMP%], .post-mood[_ngcontent-%COMP%]{padding:.2rem;border:1px solid rgba(0,0,0,35%);border-radius:.3rem}.post-purpose[_ngcontent-%COMP%]{background-color:var(--sns-post-purpose-color)}.post-topic[_ngcontent-%COMP%]{background-color:var(--sns-post-topic-color)}.post-mood[_ngcontent-%COMP%]{background-color:var(--sns-post-mood-color)}.post-footer[_ngcontent-%COMP%]{padding-top:1rem;padding-bottom:.5rem}@media (max-width:1080px){.post-title[_ngcontent-%COMP%]{font-size:1.25rem}.author-identification[_ngcontent-%COMP%], .post-date[_ngcontent-%COMP%]{font-size:.9rem}.post-content[_ngcontent-%COMP%], .post-summary[_ngcontent-%COMP%]{font-size:1rem}.post-action[_ngcontent-%COMP%]{padding:.25rem}}.compose-post[_ngcontent-%COMP%]{--avatar-size: 3rem;min-width:30rem;border-radius:0rem!important}.compose-header[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;justify-content:space-between;align-items:center;padding:.1rem 0rem}.compose-cancel[_ngcontent-%COMP%]{margin:0rem .25rem}.compose-cancel[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-bottom:5px}.compose-description[_ngcontent-%COMP%]{margin:0rem 1rem}.create-post[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;gap:.5rem;align-items:start;padding:.5rem}.avatar-wrapper[_ngcontent-%COMP%]{position:relative;float:left;flex-shrink:0;width:var(--avatar-size);height:var(--avatar-size);margin-top:.75rem;border-radius:100%;overflow:hidden}.avatar[_ngcontent-%COMP%]{width:var(--avatar-size);height:var(--avatar-size);object-fit:cover}.compose-input[_ngcontent-%COMP%]{width:100%}.upload-media[_ngcontent-%COMP%]{position:relative;margin-right:auto}.add-file-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:0px;width:0px;overflow:hidden}.upload-label[_ngcontent-%COMP%]:hover{cursor:pointer;scale:1.05}.selected-media-list[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;gap:.5rem}.selected-media[_ngcontent-%COMP%]{position:relative}.selected-media-media[_ngcontent-%COMP%]{height:150px;border:1px solid;border-radius:3px}.remove-media[_ngcontent-%COMP%]{position:absolute;top:.1rem;right:.1rem;border-radius:100%;background-color:#00000080}.remove-media[_ngcontent-%COMP%]:hover{background-color:#00000059}.remove-media[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{color:red}mat-dialog-content[_ngcontent-%COMP%]{padding:1rem .75rem .25rem!important}mat-dialog-actions[_ngcontent-%COMP%]{padding-top:.25rem!important}@media (max-width:32rem){.compose-post[_ngcontent-%COMP%]{min-width:unset;width:400px}}mat-button-toggle-group[_ngcontent-%COMP%]{width:100%;padding-bottom:1rem;border:none;border-radius:0;background-color:var(--sns-bg-trans);z-index:100}mat-button-toggle[_ngcontent-%COMP%]{color:var(--sns-text-color);width:100%;border:none!important}"]})}}return n})();var zt=(()=>{class n{constructor(e,t){this.router=e,this.route=t,this.width=window.innerWidth}ngOnInit(){}toProfile(){window.getSelection()?.toString().length==0&&this.router.navigate([this.user.username],{relativeTo:this.route.parent})}get avatarSize(){return this.width<1295?"4rem":"5rem"}get avatarOverrides(){let e={};return this.width<1295&&(e["justify-self"]="center"),e}onResize(){this.width=window.innerWidth}static{this.\u0275fac=function(t){return new(t||n)(h(A),h(ce))}}static{this.\u0275cmp=_({type:n,selectors:[["sns-user-summary"]],hostBindings:function(t,r){t&1&&g("resize",function(){return r.onResize()},!1,Ne)},inputs:{user:"user"},decls:21,vars:9,consts:[[1,"user-summary"],[1,"avatar-name",3,"click"],[1,"avatar",3,"username","avatar","size","styleOverrides"],[1,"name"],[1,"username"],[1,"stats"],["title","Posts","aria-hidden","false","aria-label","number posts","fontIcon","article"],["title","Pictorials","aria-hidden","false","aria-label","number pictorials","fontIcon","image"],["title","Comments","aria-hidden","false","aria-label","number comments","fontIcon","comment"]],template:function(t,r){t&1&&(o(0,"div",0)(1,"div",1),g("click",function(){return r.toProfile()}),m(2,"sns-user-avatar",2),o(3,"div",3)(4,"span"),s(5),i()()(),o(6,"div",4),s(7),i(),o(8,"div",5)(9,"div"),s(10,"#"),m(11,"mat-icon",6),s(12),i(),o(13,"div"),s(14,"#"),m(15,"mat-icon",7),s(16),i(),o(17,"div"),s(18,"#"),m(19,"mat-icon",8),s(20),i()()()),t&2&&(l(2),d("username",r.user.username)("avatar",r.user.avatar)("size",r.avatarSize)("styleOverrides",r.avatarOverrides),l(3),R(r.user.displayName),l(2),T(" @",r.user.username," "),l(5),T(": ",r.user.posts," "),l(4),T(": ",r.user.pictorials,""),l(4),T(": ",r.user.comments,""))},dependencies:[y,I,Tt],styles:["mat-icon[_ngcontent-%COMP%]{vertical-align:text-bottom}.user-summary[_ngcontent-%COMP%]{width:100%}.avatar-name[_ngcontent-%COMP%]{margin-top:1rem;border-bottom:2px solid;border-bottom-right-radius:2px}.avatar-name[_ngcontent-%COMP%]:hover{cursor:pointer}.name[_ngcontent-%COMP%]{font-size:1.2rem;letter-spacing:.15rem;align-content:end}.avatar[_ngcontent-%COMP%]{position:relative;float:left;transform:translateY(-20%);margin-right:.5rem}.username[_ngcontent-%COMP%]{letter-spacing:.15rem;color:var(--sns-username-color)}.stats[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;justify-content:space-between;gap:.5rem;opacity:80%;text-wrap:nowrap}@media (max-width: 1295px){.stats[_ngcontent-%COMP%], .username[_ngcontent-%COMP%], .name[_ngcontent-%COMP%]{display:none}.avatar-name[_ngcontent-%COMP%]{border-bottom:none}.avatar[_ngcontent-%COMP%]{float:none;margin:unset;justify-self:center}}"]})}}return n})();var Nn=n=>["/sns",n],Rn=()=>["/sns/settings"],Ut=(()=>{class n{constructor(e){this.router=e,this.userService=f(Oe),this.authService=f(J),this.sessionService=f(Qe),this.user=this.userService.me$,this.dialog=f(ae),this.subs=[],this.userService.refreshMe(),this.validLoginSessionCheck=setInterval(()=>{this.authService.isLoggedIn$().subscribe(r=>this.loginCheck(r))},1e3*60*5);let t=this.sessionService.loginSession$.pipe(tt(1)).subscribe(r=>this.checkSession(r));this.subs.push(t)}ngOnInit(){}ngOnDestroy(){clearInterval(this.validLoginSessionCheck);for(let e of this.subs)e.unsubscribe()}createPost(){this.dialog.open(Bt,{scrollStrategy:new E,data:{user:this.user()}})}promptLogout(){this.dialog.open(Dt,{disableClose:!0,restoreFocus:!1,scrollStrategy:new E,data:{state:this.router.routerState.snapshot}})}loginCheck(e){e||this.sessionService.sessionExpired("login")}checkSession(e){!e&&this.dialogRef==null&&(this.dialogRef=this.dialog.open(Et,{disableClose:!0,restoreFocus:!1,scrollStrategy:new E,data:{session:"login",state:this.router.routerState.snapshot}}),this.dialogRef.afterClosed().subscribe(t=>{this.dialogRef=void 0}))}static{this.\u0275fac=function(t){return new(t||n)(h(A))}}static{this.\u0275cmp=_({type:n,selectors:[["sns-index"]],decls:41,vars:6,consts:[["id","sns-index",1,"index"],[1,"index-sections"],["id","sns-nav"],[1,"logo"],[3,"user"],["mat-fab","","extended","",1,"new-post-btn",3,"click"],["aria-hidden","false","aria-label","new post","fontIcon","post_add"],[1,"nav-list"],["title","Home","routerLink","/sns/home","routerLinkActive","active-link",1,"nav-link"],["aria-hidden","false","aria-label","home","fontIcon","home",1,"link-icon"],[1,"link-text"],["title","search","routerLink","/sns/search","routerLinkActive","active-link",1,"nav-link"],["aria-hidden","false","aria-label","search","fontIcon","search",1,"link-icon"],["title","notifications TBA",1,"nav-link"],["aria-hidden","false","aria-label","notifications","fontIcon","notifications",1,"link-icon","TBA"],[1,"link-text","TBA"],["title","bookmarks TBA",1,"nav-link"],["aria-hidden","false","aria-label","bookmarks","fontIcon","bookmarks",1,"link-icon","TBA"],["title","Profile","routerLinkActive","active-link",1,"nav-link",3,"routerLink"],["aria-hidden","false","aria-label","profile","fontIcon","person",1,"link-icon"],["title","settings","routerLinkActive","active-link",1,"nav-link",3,"routerLink"],["aria-hidden","false","aria-label","settings","fontIcon","settings",1,"link-icon"],["title","logout",1,"nav-link","logout",3,"click"],["aria-hidden","false","aria-label","logout","fontIcon","logout",1,"link-icon"],["id","content"]],template:function(t,r){t&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),s(4," Logo "),i(),m(5,"sns-user-summary",4),o(6,"button",5),g("click",function(){return r.createPost()}),m(7,"mat-icon",6),o(8,"span"),s(9,"New post"),i()(),o(10,"div",7)(11,"div",8),m(12,"mat-icon",9),o(13,"span",10),s(14,"Home"),i()(),o(15,"div",11),m(16,"mat-icon",12),o(17,"span",10),s(18,"Search"),i()(),o(19,"div",13),m(20,"mat-icon",14),o(21,"span",15),s(22,"Notifications TBA"),i()(),o(23,"div",16),m(24,"mat-icon",17),o(25,"span",15),s(26,"Bookmarks TBA"),i()(),o(27,"div",18),m(28,"mat-icon",19),o(29,"span",10),s(30,"Profile"),i()(),o(31,"div",20),m(32,"mat-icon",21),o(33,"span",10),s(34,"Settings"),i()(),o(35,"div",22),g("click",function(){return r.promptLogout()}),m(36,"mat-icon",23),o(37,"span",10),s(38,"Logout"),i()()()(),o(39,"section",24),m(40,"router-outlet"),i()()()),t&2&&(l(5),d("user",r.user()),l(22),d("routerLink",lt(3,Nn,r.user().username)),l(4),d("routerLink",at(5,Rn)))},dependencies:[y,I,x,dt,oe,mt,ne,ct,zt],styles:[".index[_ngcontent-%COMP%]{--nav-width: 20rem;width:100%;min-height:100%;padding-left:calc(100vw - 100%);color:#c8c8c8;background-color:var(--sns-bg)}.index-sections[_ngcontent-%COMP%]{position:relative;height:100%;width:100%;max-width:fit-content;margin:auto}#sns-nav[_ngcontent-%COMP%]{position:fixed;top:0rem;display:flex;flex-direction:column;align-items:center;gap:1rem;width:var(--nav-width);height:calc(100% - 2rem);padding:1rem;box-sizing:border-box}.logo[_ngcontent-%COMP%]{height:3rem;text-align:center}sns-user-summary[_ngcontent-%COMP%]{width:100%}.new-post-btn[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;height:3rem;width:100%}.nav-list[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;gap:1.5rem;margin-top:1.5rem}.nav-link[_ngcontent-%COMP%]{font-size:1.15rem;display:flex;flex-flow:row nowrap;gap:.25rem;align-items:end;text-decoration:none;color:transparent}.nav-link[_ngcontent-%COMP%]:hover{cursor:pointer;color:#5f92b2}.link-icon[_ngcontent-%COMP%]{margin:auto 0rem;-webkit-text-stroke-color:lightskyblue;-webkit-text-stroke-width:1px}.TBA[_ngcontent-%COMP%]{color:#f08080!important;-webkit-text-stroke-color:lightcoral!important}.link-text[_ngcontent-%COMP%], .active-link[_ngcontent-%COMP%]{color:#87cefa}.logout[_ngcontent-%COMP%]{margin-top:auto}#content[_ngcontent-%COMP%]{width:calc(100% - var(--nav-width));min-height:calc(100vh - 2rem);margin-left:var(--nav-width)}@media (max-width: 1295px){.index[_ngcontent-%COMP%]{--nav-width: 5rem}.nav-list[_ngcontent-%COMP%]{gap:2.5rem}.nav-link[_ngcontent-%COMP%]{justify-content:center;transform:scale(1.2)}.nav-link[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:none}.new-post-btn[_ngcontent-%COMP%]{align-self:center;justify-content:center;padding:unset}.new-post-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin:auto}.new-post-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:none}}"]})}}return n})();var Ht=(()=>{class n extends Fe{constructor(e,t){super(),this.data=e,this.dialogRef=t}ngOnInit(){}close(){}logout(){this.dialogRef.close(),this.router.navigate(["/sns/logout"])}returnToHome(){this.dialogRef.close(),this.router.navigate(["/sns/home"])}static{this.\u0275fac=function(t){return new(t||n)(h(G),h(Q))}}static{this.\u0275cmp=_({type:n,selectors:[["already-logged-in"]],features:[L],decls:13,vars:0,consts:[[1,"logged-in"],[1,"logged-in-header"],[1,"logged-in-content"],["mat-flat-button","",1,"return-btn",3,"click"]],template:function(t,r){t&1&&(o(0,"div",0)(1,"div",1)(2,"div")(3,"h5"),s(4,"Already Logged In"),i()()(),o(5,"mat-dialog-content")(6,"div",2)(7,"div"),s(8,"You are already logged in. Would you like to logout?"),i(),o(9,"button",3),g("click",function(){return r.logout()}),s(10,"Logout"),i(),o(11,"button",3),g("click",function(){return r.returnToHome()}),s(12,"Return to home"),i()()()())},dependencies:[Y,W,x,P],styles:[".logged-in[_ngcontent-%COMP%]{padding:1rem 0rem;box-sizing:border-box}.logged-in-header[_ngcontent-%COMP%]{padding:0rem 1rem;border-bottom:1px solid rgba(30,30,30,.5)}.logged-in-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem;font-size:1.25rem;text-align:center}.return-btn[_ngcontent-%COMP%]{border-radius:3px}"]})}}return n})();var $n=["loginForm"],Qt=(()=>{class n{constructor(e,t,r){this.authService=e,this.router=t,this.route=r,this.sessionService=f(Qe),this.dialog=f(ae),this.returnTo=this.route.snapshot.queryParams.returnTo}ngOnInit(){this.authService.isLoggedIn$().subscribe(e=>{e&&this.dialog.open(Ht,{disableClose:!0,restoreFocus:!0,scrollStrategy:new E})})}onSubmit(){let e=this.loginForm.value;this.authService.login$(e.username,e.password).subscribe({next:t=>{console.log(t),this.authService.refresh(),this.redirect()}})}redirect(){this.sessionService.newSession("login"),this.returnTo?this.router.navigateByUrl(this.returnTo):this.router.navigate(["../home"],{relativeTo:this.route})}static{this.\u0275fac=function(t){return new(t||n)(h(J),h(A),h(ce))}}static{this.\u0275cmp=_({type:n,selectors:[["sns-login"]],viewQuery:function(t,r){if(t&1&&Z($n,5),t&2){let a;ee(a=te())&&(r.loginForm=a.first)}},decls:18,vars:0,consts:[["loginForm","ngForm"],[1,"sns-login"],[1,"sns-login-form",3,"submit"],["appearance","outline"],["name","username","ngModel","","matInput","","lowerCaseInput","","placeholder","Username..."],["name","password","type","password","ngModel","","matInput","","placeholder","Password..."],["mat-raised-button",""],["routerLink","/sns/register",1,"link"]],template:function(t,r){if(t&1){let a=b();o(0,"div",1)(1,"div")(2,"form",2,0),g("submit",function(){return C(a),w(r.onSubmit())}),o(4,"h3"),s(5,"Login"),i(),o(6,"mat-form-field",3)(7,"mat-label"),s(8,"Username"),i(),m(9,"input",4),i(),o(10,"mat-form-field",3)(11,"mat-label"),s(12,"Password"),i(),m(13,"input",5),i(),o(14,"button",6),s(15,"Submit"),i(),o(16,"a",7),s(17,"No account? Register here"),i()()()()}},dependencies:[oe,ne,j,q,V,O,$,re,ie,H,U,z,B,x,P,Ge],styles:[".sns-login[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem}.sns-login-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;min-width:10rem;max-width:30rem;width:100%;margin:auto;margin-top:3rem;padding:1rem;color:#000;border:1px solid black;border-radius:3px;background-color:#c8c8c8}.link[_ngcontent-%COMP%]{color:#00008b}"]})}}return n})();var qn=()=>[ne,P];function jn(n,p){n&1&&(o(0,"div",0)(1,"div",1)(2,"h5"),s(3,"Successfully Logged Out"),i(),o(4,"a",2),s(5,"No account? Register here"),i(),o(6,"a",3),s(7,"Already have an account? Login here"),i()()())}function Bn(n,p){if(n&1){let e=b();o(0,"div",0)(1,"div",1)(2,"h5"),s(3,"Would you like to logout?"),i(),o(4,"button",4),g("click",function(){C(e);let r=c(2);return w(r.logout())}),s(5,"Logout"),i(),o(6,"a",5),s(7,"Cancel"),i()()()}}function zn(n,p){if(n&1&&v(0,jn,8,0,"div",0)(1,Bn,8,0,"div",0),n&2){let e=c();M(e.isLoggedIn=="no"?0:1)}}function Un(n,p){n&1&&(o(0,"div",0)(1,"div",1)(2,"h5"),s(3,"Checking login status"),i()()())}var Gt=(()=>{class n{constructor(){this.authService=f(J),this.authService.isLoggedIn$().pipe(Xe(3)).subscribe(e=>{e?this.isLoggedIn="yes":this.isLoggedIn="no"})}ngOnInit(){}logout(){this.authService.logout$().pipe(Xe(3)).subscribe(()=>{this.isLoggedIn="no"})}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=_({type:n,selectors:[["logout-page"]],decls:4,vars:1,consts:[[1,"sns-logout"],[1,"sns-logout-form"],["routerLink","/sns/register",1,"link"],["routerLink","/sns/login",1,"link"],["mat-flat-button","",3,"click"],["routerLink","/sns/home",1,"link"]],template:function(t,r){t&1&&(v(0,zn,2,1)(1,Un,4,0),xe(2,0,qn,null,1)),t&2&&(l(2),Me(r.isLoggedIn))},dependencies:[oe,x],styles:[".sns-logout[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem}.sns-logout-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;min-width:10rem;max-width:30rem;width:100%;margin:auto;margin-top:3rem;padding:1rem;color:#000;border:1px solid black;border-radius:3px;background-color:#c8c8c8}.link[_ngcontent-%COMP%]{color:#00008b}"]})}}return n})();var Wt=(()=>{class n extends Fe{constructor(e,t){super(),this.data=e,this.dialogRef=t}ngOnInit(){}close(){}return(){this.dialogRef.close(),this.router.navigate(["/sns/login"],{queryParams:{returnTo:this.data.returnTo}})}static{this.\u0275fac=function(t){return new(t||n)(h(G),h(Q))}}static{this.\u0275cmp=_({type:n,selectors:[["registration-success"]],features:[L],decls:11,vars:0,consts:[[1,"registration-success"],[1,"success-header"],[1,"success-content"],["mat-flat-button","",1,"return-btn",3,"click"]],template:function(t,r){t&1&&(o(0,"div",0)(1,"div",1)(2,"div")(3,"h5"),s(4,"Registration Succcessful"),i()()(),o(5,"mat-dialog-content")(6,"div",2)(7,"div"),s(8,"You've succesfully registered, you may return to login."),i(),o(9,"button",3),g("click",function(){return r.return()}),s(10,"Return to login"),i()()()())},dependencies:[Y,W,x,P],styles:[".registration-success[_ngcontent-%COMP%]{padding:1rem 0rem;box-sizing:border-box}.success-header[_ngcontent-%COMP%]{padding:0rem 1rem;border-bottom:1px solid rgba(30,30,30,.5)}.success-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem;font-size:1.25rem;text-align:center}.return-btn[_ngcontent-%COMP%]{border-radius:3px}"]})}}return n})();var Hn=()=>[ne,q,V,O,$,$e,qe,U,z,B,se,P,import("./chunk-7ZB256TU.js").then(n=>n.LowercaseInputDirective),import("./chunk-KDRJXZTY.js").then(n=>n.SecurityQuestionsFormComponent)];function Qn(n,p){n&1&&(o(0,"mat-hint"),s(1,"Enter a username"),i())}function Gn(n,p){n&1&&(o(0,"mat-hint"),s(1,"Username contains invalid characters"),i())}function Wn(n,p){n&1&&(o(0,"mat-hint"),s(1,"Invalid username. Must not start with '.', '_' OR be consecutive"),i())}function Yn(n,p){n&1&&(o(0,"mat-hint"),s(1,"Enter a password"),i())}function Jn(n,p){n&1&&(o(0,"mat-hint"),s(1,"Password cannot contain spaces"),i())}function Kn(n,p){n&1&&(o(0,"mat-hint"),s(1,"Enter a display name"),i())}function Xn(n,p){if(n&1){let e=b();o(0,"div")(1,"form",1),g("submit",function(){C(e);let r=c();return w(r.register())}),o(2,"h3"),s(3,"Register"),i(),o(4,"mat-form-field",2)(5,"mat-label"),s(6,"Username"),i(),m(7,"input",3),v(8,Qn,2,0,"mat-hint")(9,Gn,2,0,"mat-hint")(10,Wn,2,0,"mat-hint"),i(),o(11,"mat-form-field",2)(12,"mat-label"),s(13,"Password"),i(),m(14,"input",4),v(15,Yn,2,0,"mat-hint")(16,Jn,2,0,"mat-hint"),i(),o(17,"mat-form-field",2)(18,"mat-label"),s(19,"DisplayName"),i(),m(20,"input",5),v(21,Kn,2,0,"mat-hint"),i(),m(22,"security-questions-form",6),o(23,"button",7),s(24,"Submit"),i(),o(25,"a",8),s(26,"Already have an account? Login Here"),i()()()}if(n&2){let e=c();l(),d("formGroup",e.registrationForm),l(7),M(e.username.hasError("required")?8:e.username.hasError("invalidUsernameCharacter")?9:e.username.hasError("invalidUsernameSeq")?10:-1),l(7),M(e.password.hasError("required")?15:e.password.hasError("invalidPassword")?16:-1),l(6),M(e.password.hasError("required")?21:-1),l(),d("form",e.registrationForm)("questions",e.questions())("numberQuestions",e.numberQuestions)}}var Yt=(()=>{class n{constructor(e,t,r){this.authService=e,this.router=t,this.route=r,this.userVerifyService=f(We),this.toastService=f(Re),this.numberQuestions=He.NUMBER_REGISTRATION_QUESTIONS,this.dialog=f(ae),this.returnTo=this.route.snapshot.queryParams.returnTo,this.questions=this.userVerifyService.questions$;let a=new Pe({username:new F(void 0,[D.required,D.minLength(He.USERNAME_MIN_LENGTH),Ce.invalidUsernameCharacter(),Ce.invalidUsernameSeq()]),password:new F(void 0,[D.required,D.minLength(He.PASSWORD_MIN_LENGTH),Ce.invalidPassword()]),displayName:new F(void 0,D.required),questions:new je([])});for(let u=0;u<this.numberQuestions;u++)a.controls.questions.push(new Pe({question:new F(void 0,{nonNullable:!0,validators:D.required}),answer:new F(void 0,{nonNullable:!0,validators:[D.required,Ce.invalidSecurityQuestionAnswerSeq()]})}));this.registrationForm=a}ngOnInit(){}getQuestion(e,t){return t?this.questionsFormArray.at(e).controls.answer:this.questionsFormArray.at(e).controls.question}register(){let e=this.registrationForm.value,t=this.questionsArrayToMap(this.formatQuestions());this.authService.register$(e.username,e.password,e.displayName,t).subscribe({next:r=>{let a=this.dialog.open(Wt,{restoreFocus:!1,scrollStrategy:new E,closeOnNavigation:!0,data:{state:this.returnTo}})},error:r=>{console.log(r),this.toastService.show({type:"danger",source_feature:"sns",header:"Error",body:"Failed to register"})}})}formatQuestions(){let e=[];for(let t=0;t<this.numberQuestions;t++){let r=this.getQuestion(t).value,a=this.getQuestion(t,!0).value;a&&e.push({question:r,answer:a.trim()})}return e}questionsArrayToMap(e){return e.reduce((t,r)=>(t[r.question]=r.answer,t),{})}get username(){return this.registrationForm.controls.username}get password(){return this.registrationForm.controls.password}get displayName(){return this.registrationForm.controls.displayName}get questionsFormArray(){return this.registrationForm.get("questions")}static{this.\u0275fac=function(t){return new(t||n)(h(J),h(A),h(ce))}}static{this.\u0275cmp=_({type:n,selectors:[["sns-register"]],decls:4,vars:1,consts:[[1,"sns-register"],[1,"sns-register-form",3,"submit","formGroup"],["appearance","outline"],["name","username","formControlName","username","matInput","","lowerCaseInput","","placeholder","Username...","cdkFocusInitial",""],["name","password","formControlName","password","type","password","matInput","","placeholder","Password..."],["name","displayName","formControlName","displayName","matInput","","placeholder","Display name..."],[3,"form","questions","numberQuestions"],["mat-raised-button","",1,"submit-btn"],["routerLink","/sns/login",1,"link"]],template:function(t,r){t&1&&(o(0,"div",0),v(1,Xn,27,7),xe(2,1,Hn),i()),t&2&&(l(2),Me(r.questions().length>0))},dependencies:[oe,ge,j,H,x,fe],styles:[".sns-register[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem}.sns-register-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;min-width:10rem;max-width:30rem;width:100%;margin:auto;margin-top:3rem;padding:1rem;color:#000;border:1px solid black;border-radius:3px;background-color:#c8c8c8}.link[_ngcontent-%COMP%]{color:#00008b}"]})}}return n})();var Jt=(n,p)=>{let e=f(A),t=f(J),r=()=>(console.log("Invalid credentials"),e.navigate(["/sns/login"],{queryParams:{returnTo:p.url}}),Ye);return t.isLoggedIn$().pipe(Je(a=>a||(r(),!1)),Ke((a,u)=>r()))},Kt=(n,p)=>{let e=f(A),t=f(We),r=()=>(console.log("User not confirmed"),e.navigate(["/sns/confirm-user"],{queryParams:{returnTo:p.url}}),Ye);return t.isSecured$().pipe(Je(a=>a||(r(),!1)),Ke((a,u)=>r()))};var Zn=["usernameForm"];function eo(n,p){if(n&1){let e=b();o(0,"div")(1,"form",2,0),g("submit",function(){C(e);let r=c();return w(r.submitUsername())}),o(3,"h3"),s(4,"Login"),i(),o(5,"mat-form-field",3)(6,"mat-label"),s(7,"Username"),i(),m(8,"input",4),i(),o(9,"button",5),s(10,"Submit"),i(),o(11,"a",6),s(12,"Return to login"),i()()()}}function to(n,p){n&1&&(o(0,"mat-hint"),s(1,"Enter answer"),i())}function no(n,p){if(n&1&&(o(0,"div",12)(1,"div")(2,"span"),s(3),i()(),o(4,"mat-form-field",13)(5,"mat-label"),s(6,"Answer"),i(),m(7,"input",17),v(8,to,2,0,"mat-hint"),i()()),n&2){let e=p.$index,t=c(2);st("formGroupName",e),l(3),R(t.getQuestion(e).value),l(5),M(-1)}}function oo(n,p){if(n&1&&(o(0,"mat-hint"),s(1),i()),n&2){let e=c(2);l(),R(e.minLengthHint)}}function io(n,p){if(n&1&&(o(0,"mat-hint"),s(1),i()),n&2){let e=c(2);l(),R(e.invalidPasswordHint)}}function ro(n,p){if(n&1&&(o(0,"mat-hint"),s(1),i()),n&2){let e=c(2);l(),R(e.unconfirmedHint)}}function so(n,p){if(n&1){let e=b();o(0,"div")(1,"form",7),g("submit",function(){C(e);let r=c();return w(r.resetPassword())}),o(2,"h3"),s(3,"Reset Password"),i(),o(4,"button",8),g("click",function(){C(e);let r=c();return w(r.notMe())}),m(5,"mat-icon",9),o(6,"span"),s(7,"Not You?"),i()(),o(8,"div",10)(9,"div"),s(10,"Username"),i(),o(11,"div"),s(12),i()(),o(13,"div",11),K(14,no,9,3,"div",12,be),i(),o(16,"div")(17,"mat-form-field",13)(18,"mat-label"),s(19,"New Password"),i(),m(20,"input",14),v(21,oo,2,1,"mat-hint")(22,io,2,1,"mat-hint"),i()(),o(23,"div")(24,"mat-form-field",13)(25,"mat-label"),s(26,"Confirm Password"),i(),m(27,"input",15),v(28,ro,2,1,"mat-hint"),i()(),o(29,"button",16),s(30,"Submit"),i()()()}if(n&2){let e=c();l(),d("formGroup",e.resetForm),l(11),R(e.username),l(2),X(e.questionsFormArray.controls),l(7),M(e.newPassword.hasError("minlength")?21:e.newPassword.hasError("invalidPassword")?22:-1),l(7),M(e.confirmPassword.hasError("notMatching")?28:-1),l(),d("disabled",e.resetForm.invalid)}}var Xt=(()=>{class n{constructor(e,t){this.route=e,this.router=t,this.authService=f(J),this.toastService=f(Re),this.dialog=f(ae),this.questions=[];let r=new F(void 0,[D.required,D.minLength(8),Ce.invalidPassword()]),a=new F(void 0,[D.required,this.passwordConfirmed(r)]),u=new Pe({newPassword:r,confirmPassword:a,questions:new je([])});this.resetForm=u}ngOnInit(){}submitUsername(){let e=this.loginForm.value.username;e&&this.authService.forgotPassword$(e).subscribe({next:t=>{this.username=e,this.questions=t,this.questionsFormArray.clear();for(let r of t)this.questionsFormArray.push(new Pe({question:new F(r,{nonNullable:!0,validators:D.required}),answer:new F(void 0,{nonNullable:!0,validators:D.required})}))},error:t=>{this.questionsFormArray.clear()}})}resetPassword(){if(!this.username)return;let e=this.username,t=this.newPassword.value,r=this.confirmPassword.value,a=[];for(let u=0;u<this.questionsFormArray.length;u++){let S=this.getQuestion(u).value,Le=this.getQuestion(u,!0).value;Le&&a.push({question:S,answer:Le.trim()})}this.authService.resetPassword$(e,t,r,a).subscribe({next:()=>{this.dialog.open(At,{disableClose:!0,restoreFocus:!1,scrollStrategy:new E,data:{confirmText:"Password Changed",navText:"Return to Login",navLink:"/sns/login"}})},error:u=>{this.toastService.show({header:"Error",source_feature:"sns",type:"danger",body:"Failed to reset password"})}})}getQuestion(e,t){return t?this.questionsFormArray.at(e).controls.answer:this.questionsFormArray.at(e).controls.question}notMe(){this.username=void 0,this.questionsFormArray.clear()}passwordConfirmed(e){return t=>t.value==e.value?null:{notMatching:{value:"Passwords do not match"}}}get isResettingPassword(){return this.username&&this.questionsFormArray.length>0}get newPassword(){return this.resetForm.controls.newPassword}get confirmPassword(){return this.resetForm.controls.confirmPassword}get questionsFormArray(){return this.resetForm.get("questions")}get minLengthHint(){return`Min Length: ${this.newPassword.getError("minlength").requiredLength}`}get invalidPasswordHint(){return`Invalid Character(s): ${this.newPassword.getError("invalidPassword").invalidCharacters.map(t=>`'${t}'`).join(", ")}`}get unconfirmedHint(){return this.confirmPassword.getError("notMatching").value}static{this.\u0275fac=function(t){return new(t||n)(h(ce),h(A))}}static{this.\u0275cmp=_({type:n,selectors:[["forgot-password-page"]],viewQuery:function(t,r){if(t&1&&Z(Zn,5),t&2){let a;ee(a=te())&&(r.loginForm=a.first)}},decls:3,vars:1,consts:[["usernameForm","ngForm"],[1,"sns-forgot-password"],[1,"sns-forgot-password-form",3,"submit"],["appearance","outline"],["name","username","ngModel","","matInput","","lowerCaseInput","","placeholder","Username..."],["mat-raised-button",""],["routerLink","/sns/login",1,"link"],[1,"sns-forgot-password-form",3,"submit","formGroup"],["mat-raised-button","",1,"not-you",3,"click"],["aria-hidden","false","aria-label","back","fontIcon","arrow_back",1,"link-icon"],[1,"input-group"],["formArrayName","questions",1,"questions"],[1,"input-group",3,"formGroupName"],["appearance","outline",1,"reset-input"],["formControlName","newPassword","type","password","matInput","","maxlength","256","placeholder","Password..."],["formControlName","confirmPassword","type","password","matInput","","maxlength","256","placeholder","Password..."],["mat-raised-button","",3,"disabled"],["formControlName","answer","type","password","matInput","","maxlength","256","placeholder","Answer...","required",""]],template:function(t,r){t&1&&(o(0,"div",1),v(1,eo,13,0,"div")(2,so,31,5,"div"),i()),t&2&&(l(),M(r.isResettingPassword?2:1))},dependencies:[oe,ne,ge,q,V,O,$,de,ue,$e,qe,ht,_t,j,re,ie,H,U,z,B,se,x,P,y,I,Ge],styles:[".sns-forgot-password[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem}.sns-forgot-password-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;min-width:10rem;max-width:30rem;width:100%;margin:auto;margin-top:3rem;padding:1rem;color:#000;border:1px solid black;border-radius:3px;background-color:#c8c8c8}.link[_ngcontent-%COMP%]{color:#00008b}.input-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.question[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;margin-bottom:1rem}.not-you[_ngcontent-%COMP%]{font-size:1.1rem;margin-bottom:1rem}.reset-input[_ngcontent-%COMP%]{width:100%}"]})}}return n})();var ao=[{path:"home",component:Rt},{path:"confirm-user",loadComponent:()=>import("./chunk-GLO5C3K5.js").then(n=>n.SnsVerifyUserComponent)},{path:"posts/:id",loadComponent:()=>import("./chunk-U5G6C47R.js").then(n=>n.SnsViewPostComponent)},{path:"settings",loadComponent:()=>import("./chunk-HGDLP3RI.js").then(n=>n.SnsSettingsComponent),canActivate:[Kt]},{path:"search",loadComponent:()=>import("./chunk-XU253OVZ.js").then(n=>n.SnsSearchPageComponent)},{path:":username",loadComponent:()=>import("./chunk-U2JV2FVM.js").then(n=>n.SnsProfileComponent)},{path:":username/:section",loadComponent:()=>import("./chunk-U2JV2FVM.js").then(n=>n.SnsProfileComponent)},{path:"**",redirectTo:"home",pathMatch:"full"}],xs=[{path:"login",component:Qt},{path:"logout",component:Gt},{path:"register",component:Yt},{path:"forgot-password",component:Xt},{path:"",component:Ut,loadChildren:()=>ao,canActivate:[Jt]}];export{ao as contentRoutes,xs as snsRoutes};
