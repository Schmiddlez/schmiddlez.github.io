import{a as _e}from"./chunk-FGTW4K4O.js";import{a as H,b as G,c as W,d as ae,e as me,f as ce,g as pe,h as we}from"./chunk-GB7HWWOR.js";import{a as ve}from"./chunk-63YY7Z3N.js";import{a as Y}from"./chunk-4SU4UW77.js";import{a as h}from"./chunk-AJP6ELTP.js";import{a as ue}from"./chunk-HDNE6JQB.js";import"./chunk-RMWOCHW2.js";import{a as fe}from"./chunk-YCJEZHKG.js";import{a as de}from"./chunk-Z7TNYMZJ.js";import"./chunk-5AXV247N.js";import{a as ge}from"./chunk-A5RJREYR.js";import{a as he}from"./chunk-WMMNOL7H.js";import"./chunk-FW3RU6FN.js";import"./chunk-VZ4ZKRGN.js";import"./chunk-U6BBX53N.js";import"./chunk-NXQNPUVW.js";import"./chunk-YLX6JSE3.js";import"./chunk-QKYLMYUG.js";import"./chunk-HPQ4FWEG.js";import{c as le}from"./chunk-TF3S5RIE.js";import"./chunk-MAA5GSAZ.js";import"./chunk-OG2F7MK6.js";import"./chunk-CVYHWQ3C.js";import{D as L,f as j,k as A,p as q}from"./chunk-XT72EIBI.js";import{a as re,b as B}from"./chunk-WRSMBKFW.js";import{I as z,J as R}from"./chunk-KCLKHEQV.js";import"./chunk-RVDJVD4K.js";import"./chunk-EJWSQFFV.js";import"./chunk-JLWIDV3F.js";import{b as O,e as T,f as se,k as N}from"./chunk-E7SDSQEU.js";import"./chunk-KE4LITEF.js";import"./chunk-76PGFOOU.js";import{$a as ne,Hc as Z,Nc as C,Rb as y,Sb as M,Tc as V,Uc as v,Vb as F,Wb as P,Xb as a,Yb as s,Zb as r,_b as f,a as Q,b as X,bb as ie,ca as oe,db as i,dc as k,fc as g,ha as x,hc as l,ma as S,mb as _,na as b,ub as U,wc as m,xc as d,ya as w,yc as D}from"./chunk-W56RDURX.js";var Fe=["posts","comments","likes","follows","following","followers"],Pe=["posts","comments","likes"],ke=["follows","following","followers"],Ce=n=>Fe.includes(n),I=n=>Pe.includes(n),J=n=>ke.includes(n),K=(()=>{class n{constructor(){this.userService=x(Y),this.profilePosts$=C(()=>[...this.announcements(),...this.posts$()]),this.announcements=w([]),this.views={posts:w([]),comments:w([]),likes:w([]),follows:w([]),followers:w([])},this.pages={posts:0,comments:0,likes:0,follows:0,followers:0},this.more={posts:!0,comments:!0,likes:!0,follows:!0,followers:!0},this.loading={posts:!1,comments:!1,likes:!1,follows:!1,followers:!1},this.announcements$=this.announcements.asReadonly(),this.posts$=this.views.posts.asReadonly(),this.comments$=this.views.comments.asReadonly(),this.likes$=this.views.likes.asReadonly(),this.follows$=this.views.follows.asReadonly(),this.followers$=this.views.followers.asReadonly()}setUser(e){this.reset(),this.user=e,this.getMore(e,"posts"),this.getMore(e,"comments"),this.getMore(e,"likes"),this.getMore(e,"follows"),this.getMore(e,"followers"),this.userService.getUserAnnouncements(e,t=>this.announcements.set(t))}setView(e){this.view=e}reset(){this.announcements.set([]);for(let e in this.views)this.views[e].set([]);for(let e in this.pages)this.pages[e]=0;for(let e in this.more)this.more[e]=!0;for(let e in this.loading)this.loading[e]=!1}getMore(e,t){if(this.checkMoreRequest(t))return;let o=u=>{u.length>0?(this.views[t].update($=>[...$,...u]),this.pages[t]=this.pages[t]+1):this.more[t]=!1},p=()=>this.loading[t]=!1;switch(t){case"posts":this.loading[t]=!0,this.userService.getUserPostsForProfile(e,this.pages[t],o,p);break;case"comments":this.loading[t]=!0,this.userService.getUserComments(e,this.pages[t],o,p);break;case"likes":this.loading[t]=!0,this.userService.getUserLikes(e,this.pages[t],o,p);break;case"follows":this.loading[t]=!0,this.userService.getUserFollows(e,this.pages[t],o,p);break;case"followers":this.loading[t]=!0,this.userService.getUserFollowers(e,this.pages[t],o,p);break}}get currentProfile(){return this.user==h?void 0:this.user}get currentView(){return this.view}checkMoreRequest(e){return!this.more[e]||this.loading[e]}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var xe=(n,c)=>c.id;function Ee(n,c){if(n&1){let e=k();s(0,"div",20)(1,"button",22),g("click",function(o){S(e);let p=l().$implicit,u=l();return b(u.isFollowing(p)?u.unfollow(p,o):u.follow(p,o))}),s(2,"span"),m(3),r()()()}if(n&2){let e=l().$implicit,t=l();i(3),d(t.isFollowing(e)?"Unfollow":"Follow")}}function Ie(n,c){if(n&1){let e=k();s(0,"div",15),g("click",function(o){let p=S(e).$implicit,u=l();return b(u.toProfile(o,p.username))}),s(1,"div",16),f(2,"sns-user-avatar",4),s(3,"div",17)(4,"span",18),m(5),r(),s(6,"span",19),m(7),r()(),y(8,Ee,4,1,"div",20),r(),s(9,"div",21)(10,"p"),m(11),r()()()}if(n&2){let e=c.$implicit,t=l();i(2),a("username",e.username)("avatar",e.avatar)("size","3.5rem"),i(2),a("title",e.displayName),i(),d(e.displayName),i(),a("title",e.username),i(),d("@"+e.username),i(),M(e.id!=t.me().id?8:-1),i(3),d(e.about)}}function $e(n,c){if(n&1&&(s(0,"div",14)(1,"span"),m(2),r(),s(3,"span"),m(4,"is not following anyone"),r()()),n&2){let e=l();i(2),d(e.user().displayName)}}function De(n,c){if(n&1){let e=k();s(0,"div",20)(1,"button",22),g("click",function(o){S(e);let p=l().$implicit,u=l();return b(u.isFollowing(p)?u.unfollow(p,o):u.follow(p,o))}),s(2,"span"),m(3),r()()()}if(n&2){let e=l().$implicit,t=l();i(3),d(t.isFollowing(e)?"Unfollow":"Follow")}}function Ve(n,c){if(n&1){let e=k();s(0,"div",15),g("click",function(o){let p=S(e).$implicit,u=l();return b(u.toProfile(o,p.username))}),s(1,"div",16),f(2,"sns-user-avatar",4),s(3,"div",17)(4,"span",18),m(5),r(),s(6,"span",19),m(7),r()(),y(8,De,4,1,"div",20),r(),s(9,"div",21)(10,"p"),m(11),r()()()}if(n&2){let e=c.$implicit,t=l();i(2),a("username",e.username)("avatar",e.avatar)("size","3.5rem"),i(2),a("title",e.displayName),i(),d(e.displayName),i(),a("title",e.username),i(),d("@"+e.username),i(),M(e.id!=t.me().id?8:-1),i(3),d(e.about)}}function Ne(n,c){if(n&1&&(s(0,"div",14)(1,"span",23),m(2),r(),s(3,"span"),m(4,"is not followed by anyone ;("),r()()),n&2){let e=l();i(2),d(e.user().displayName)}}var be=(()=>{class n{constructor(e,t){this.route=e,this.router=t,this.me=v.required(),this.user=v.required(),this.follows=v.required(),this.followers=v.required(),this.onFollowChange=V(),this.view=new A("posts"),this.subs=[]}ngOnInit(){let e=this.route.params.subscribe(t=>{let o=t.section;J(o)&&o!=this.view.value&&(this.view.setValue(o),this.changeView(o))});this.subs.push(e)}follow(e,t){t?.stopPropagation(),this.onFollowChange.emit({action:"follow",data:e})}unfollow(e,t){t?.stopPropagation(),this.onFollowChange.emit({action:"unfollow",data:e})}isFollowing(e){return this.me().follows.includes(e.id)}contentChange(e){this.changeView(e.value)}toProfile(e,t){e?.stopPropagation(),window.getSelection()?.toString().length==0&&this.router.navigate([t],{relativeTo:this.route.parent})}goBack(){this.user()!=h&&this.router.navigate(["sns",this.user().username])}changeView(e){if(this.user()!=h)switch(e){case"follows":case"following":this.router.navigate(["sns",this.user().username,e]);break;case"followers":this.router.navigate(["sns",this.user().username,e]);break;default:this.router.navigate(["sns",this.user().username])}}static{this.\u0275fac=function(t){return new(t||n)(_(O),_(T))}}static{this.\u0275cmp=U({type:n,selectors:[["sns-user-follows"]],inputs:{me:[1,"me"],user:[1,"user"],follows:[1,"follows"],followers:[1,"followers"]},outputs:{onFollowChange:"onFollowChange"},decls:24,vars:11,consts:[[1,"sns-user-follows"],[1,"follows-header"],[1,"back-to-user",3,"click"],[1,"sns-user"],[3,"username","avatar","size"],[1,"user-info"],[1,"displayname"],[1,"username"],["value","following",1,"user-section-group",3,"change","formControl"],["value","following",1,"user-section",3,"checked"],["value","followers",1,"user-section"],[1,"follows-content"],[3,"hidden"],[1,"sns-follows-user"],[1,"empty-follows"],[1,"sns-follows-user",3,"click"],[1,"follows-user-info"],[1,"follows-user-name"],[1,"follows-displayname",3,"title"],[1,"follows-username",3,"title"],[1,"follow"],[1,"follows-about"],["mat-fab","","extended","",1,"follow-btn",3,"click"],[1,"empty-name"]],template:function(t,o){t&1&&(s(0,"div",0)(1,"div",1)(2,"div",2),g("click",function(){return o.goBack()}),s(3,"div",3),f(4,"sns-user-avatar",4),s(5,"div",5)(6,"div",6),m(7),r(),s(8,"div",7),m(9),r()()()(),s(10,"mat-button-toggle-group",8),g("change",function(u){return o.contentChange(u)}),s(11,"mat-button-toggle",9),m(12,"Following"),r(),s(13,"mat-button-toggle",10),m(14,"Followers"),r()()(),s(15,"div",11)(16,"div",12),F(17,Ie,12,9,"div",13,xe,!1,$e,5,1,"div",14),r(),s(20,"div",12),F(21,Ve,12,9,"div",13,xe,!1,Ne,5,1,"div",14),r()()()),t&2&&(i(4),a("username",o.user().username)("avatar",o.user().avatar)("size","4.5rem"),i(3),d(o.user().displayName),i(2),d("@"+o.user().username),i(),a("formControl",o.view),i(),a("checked",!0),i(5),a("hidden",o.view.value!="follows"&&o.view.value!="following"),i(),P(o.follows()),i(3),a("hidden",o.view.value!="followers"),i(),P(o.followers()))},dependencies:[W,H,G,R,z,B,N,L,j,q,ve],styles:[".follows-header[_ngcontent-%COMP%]{position:sticky;top:0;display:flex;flex-direction:column;gap:1rem;padding:.5rem 0rem 1.5rem;background-color:var(--sns-bg-trans);-webkit-backdrop-filter:blur(.25rem);backdrop-filter:blur(.25rem);z-index:100}.follows-content[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;padding:.25rem}.back-to-user[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;gap:1rem}.back-to-user[_ngcontent-%COMP%]:hover{cursor:pointer;background-color:var(--sns-hover-color)}.sns-user[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;gap:2rem;margin:auto}.user-info[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;align-items:center;margin:auto;font-size:1.3rem}.displayname[_ngcontent-%COMP%]{font-size:1.75rem;overflow:hidden;text-overflow:ellipsis;margin-right:1rem}.username[_ngcontent-%COMP%]{font-size:1.25rem;color:var(--sns-username-color)}.user-section-group[_ngcontent-%COMP%]{flex:1;border:none;border-radius:0;background-color:var(--sns-bg-trans)}mat-button-toggle[_ngcontent-%COMP%]{color:var(--sns-text-color);width:100%;border:none!important}.sns-follows-user[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;align-content:center;gap:1.25rem;padding:.5rem .25rem .05rem;border-bottom:1px solid rgba(200,200,200,.25)}.sns-follows-user[_ngcontent-%COMP%]:hover{cursor:pointer;scale:1.01;background-color:var(--sns-hover-color)}.follows-user-info[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;gap:.5rem}.follows-user-name[_ngcontent-%COMP%]{display:flex;flex-direction:column;overflow:hidden}.follows-displayname[_ngcontent-%COMP%]{font-size:1.25rem;margin-right:.5rem}.follows-displayname[_ngcontent-%COMP%]:hover{text-decoration:underline}.follows-username[_ngcontent-%COMP%]{font-size:1.15rem;color:var(--sns-username-color)}.follow[_ngcontent-%COMP%]{display:flex;align-items:flex-start;margin-left:auto}.follow-btn[_ngcontent-%COMP%]{height:2rem}.displayname[_ngcontent-%COMP%], .follows-displayname[_ngcontent-%COMP%], .follows-username[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;margin-right:1rem}.empty-follows[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;gap:.25rem;margin:auto;justify-content:center;align-items:center;font-size:1.25rem}.empty-name[_ngcontent-%COMP%]{font-size:1.45rem}"]})}}return n})();var ye=n=>[n],te=(n,c)=>c.id;function ze(n,c){if(n&1){let e=k();s(0,"div",10)(1,"button",27),g("click",function(){S(e);let o=l();return b(o.isFollowing()?o.unfollow():o.follow())}),s(2,"span"),m(3),r()()()}if(n&2){let e=l();i(3),d(e.isFollowing()?"Unfollow":"Follow")}}function Re(n,c){if(n&1&&f(0,"sns-basic-post",26),n&2){let e=l().$implicit,t=l();a("post",e)("user",t.me())}}function Be(n,c){if(n&1&&f(0,"sns-basic-post",26),n&2){let e=l().$implicit,t=l();a("post",e)("user",t.me())}}function je(n,c){if(n&1&&f(0,"sns-announcement",26),n&2){let e=l().$implicit,t=l();a("post",t.announcement(e))("user",t.me())}}function Ae(n,c){if(n&1&&f(0,"sns-comment",26),n&2){let e=l().$implicit,t=l();a("post",t.comment(e))("user",t.me())}}function qe(n,c){if(n&1&&f(0,"sns-pictorial",26),n&2){let e=l().$implicit,t=l();a("post",t.pictorial(e))("user",t.me())}}function Le(n,c){if(n&1&&f(0,"sns-article",26),n&2){let e=l().$implicit,t=l();a("post",t.article(e))("user",t.me())}}function He(n,c){if(n&1&&y(0,Re,1,2,"sns-basic-post",26)(1,Be,1,2,"sns-basic-post",26)(2,je,1,2,"sns-announcement",26)(3,Ae,1,2,"sns-comment",26)(4,qe,1,2,"sns-pictorial",26)(5,Le,1,2,"sns-article",26),n&2){let e,t=c.$implicit;M((e=t.type)==="basic"?0:e==="post"?1:e==="announcement"?2:e==="comment"?3:e==="pictorial"?4:e==="article"?5:-1)}}function Ge(n,c){if(n&1&&f(0,"sns-comment",26),n&2){let e=c.$implicit,t=l();a("post",t.comment(e))("user",t.me())}}function We(n,c){}function Ye(n,c){if(n&1&&f(0,"sns-announcement",26),n&2){let e=l().$implicit,t=l();a("post",t.announcement(e))("user",t.me())}}function Je(n,c){if(n&1&&f(0,"sns-comment",26),n&2){let e=l().$implicit,t=l();a("post",t.comment(e))("user",t.me())}}function Ke(n,c){if(n&1&&f(0,"sns-pictorial",26),n&2){let e=l().$implicit,t=l();a("post",t.pictorial(e))("user",t.me())}}function Qe(n,c){if(n&1&&f(0,"sns-article",26),n&2){let e=l().$implicit,t=l();a("post",t.article(e))("user",t.me())}}function Xe(n,c){if(n&1&&y(0,We,0,0)(1,Ye,1,2,"sns-announcement",26)(2,Je,1,2,"sns-comment",26)(3,Ke,1,2,"sns-pictorial",26)(4,Qe,1,2,"sns-article",26),n&2){let e,t=c.$implicit;M((e=t.type)==="basic"?0:e==="announcement"?1:e==="comment"?2:e==="pictorial"?3:e==="article"?4:-1)}}var Me=(()=>{class n{constructor(e,t){this.route=e,this.router=t,this.profileService=x(K),this.throttler=new le,this.me=v.required(),this.user=v.required(),this.posts=v.required(),this.comments=v.required(),this.likes=v.required(),this.onFollowChange=V(),this.view=new A("posts"),this.isFollowing=C(()=>this.me().follows.includes(this.user().id)),this.subs=[],this.announcement=ae,this.comment=me,this.pictorial=ce,this.article=pe}ngOnInit(){let e=this.route.params.subscribe(t=>{let o=t.section;I(o)&&o!=this.view.value&&(this.view.setValue(o),this.changeView(o))});this.subs.push(e)}ngOnDestroy(){for(let e of this.subs)e.unsubscribe()}contentChange(e){this.changeView(e.value)}onScroll(){let e=window.document.documentElement;e.scrollHeight-(e.scrollTop+e.offsetHeight)<Math.min(2e3,e.scrollHeight*.1)&&this.throttler.throttle(()=>{let o=this.view.value;o&&I(o)&&this.profileService.getMore(this.user(),o)},3e3)}follow(e=this.user()){this.onFollowChange.emit({action:"follow",data:e})}unfollow(e=this.user()){this.onFollowChange.emit({action:"unfollow",data:e})}changeView(e){if(this.user()!=h)switch(e){case"posts":this.router.navigate(["sns",this.user().username]);break;case"comments":this.router.navigate(["sns",this.user().username,"comments"]);break;case"likes":this.router.navigate(["sns",this.user().username,"likes"]);break;default:this.router.navigate(["sns",this.user().username])}}static{this.\u0275fac=function(t){return new(t||n)(_(O),_(T))}}static{this.\u0275cmp=U({type:n,selectors:[["sns-user"]],hostBindings:function(t,o){t&1&&g("scroll",function(){return o.onScroll()},ie)},inputs:{me:[1,"me"],user:[1,"user"],posts:[1,"posts"],comments:[1,"comments"],likes:[1,"likes"]},outputs:{onFollowChange:"onFollowChange"},decls:55,vars:22,consts:[[1,"sns-user"],[1,"profile-background"],[1,"profile-info"],[1,"user-general"],[1,"avatar-wrapper"],[1,"avatar",3,"title","src"],[1,"user-identification"],[1,"filler"],[1,"displayname"],[1,"username"],[1,"follow"],[1,"user-more"],[1,"stats"],[1,"post-stats"],["title","Posts","aria-hidden","false","aria-label","number posts","fontIcon","article"],["title","Pictorials","aria-hidden","false","aria-label","number pictorials","fontIcon","image"],["title","Comments","aria-hidden","false","aria-label","number comments","fontIcon","comment"],[1,"follow-stats"],[3,"routerLink"],[1,"profile-content"],["value","posts",1,"user-section-group",3,"change","formControl"],["value","posts",1,"user-section",3,"checked"],["value","comments",1,"user-section"],["value","likes",1,"user-section"],[3,"hidden"],[1,"user-feed"],[3,"post","user"],["mat-fab","","extended","",1,"follow-btn",3,"click"]],template:function(t,o){t&1&&(s(0,"div",0),f(1,"div",1),s(2,"div",2)(3,"div",3)(4,"div",4),f(5,"img",5),r(),s(6,"div",6),f(7,"span",7),s(8,"span",8),m(9),r(),s(10,"span",9),m(11),r(),y(12,ze,4,1,"div",10),r()(),s(13,"div",11)(14,"div"),m(15),r(),s(16,"div",12)(17,"div",13)(18,"div"),m(19,"#"),f(20,"mat-icon",14),m(21),r(),s(22,"div"),m(23,"#"),f(24,"mat-icon",15),m(25),r(),s(26,"div"),m(27,"#"),f(28,"mat-icon",16),m(29),r()(),s(30,"div",17)(31,"span",18),m(32),r(),s(33,"span",18),m(34),r()()()()(),s(35,"div",19)(36,"mat-button-toggle-group",20),g("change",function(u){return o.contentChange(u)}),s(37,"mat-button-toggle",21),m(38,"Posts"),r(),s(39,"mat-button-toggle",22),m(40,"Comments"),r(),s(41,"mat-button-toggle",23),m(42,"Likes"),r()(),s(43,"div",24)(44,"div",25),F(45,He,6,1,null,null,te),r()(),s(47,"div",24)(48,"div",25),F(49,Ge,1,2,"sns-comment",26,te),r()(),s(51,"div",24)(52,"div",25),F(53,Xe,5,1,null,null,te),r()()()()),t&2&&(i(5),a("title","avatar")("src",o.user().avatar,ne),i(4),d(o.user().displayName),i(2),d("@"+o.user().username),i(),M(o.user().id!=o.me().id?12:-1),i(3),d(o.user().about),i(6),D(": ",o.user().posts," "),i(4),D(": ",o.user().pictorials),i(4),D(": ",o.user().comments),i(2),a("routerLink",Z(18,ye,"/sns/"+o.user().username+"/followers")),i(),d("Followers: "+o.user().followCount),i(),a("routerLink",Z(20,ye,"/sns/"+o.user().username+"/following")),i(),d("Following: "+o.user().follows.length),i(2),a("formControl",o.view),i(),a("checked",!0),i(6),a("hidden",o.view.value!="posts"),i(2),P(o.posts()),i(2),a("hidden",o.view.value!="comments"),i(2),P(o.comments()),i(2),a("hidden",o.view.value!="likes"),i(2),P(o.likes()))},dependencies:[W,H,G,R,z,B,re,L,j,q,N,se,ue,ge,de,fe,he],styles:[".sns-user[_ngcontent-%COMP%]{flex:1;display:flex;flex-flow:column}.profile-background[_ngcontent-%COMP%]{height:12rem;background-color:var(--mudae-light)}.profile-info[_ngcontent-%COMP%]{position:relative;padding:0rem .5rem .5rem;margin-bottom:1rem}.follow[_ngcontent-%COMP%]{position:absolute;top:.75rem;right:.25rem}.follow-btn[_ngcontent-%COMP%]{height:2rem}.user-general[_ngcontent-%COMP%]{position:relative;display:flex;flex-flow:row wrap;gap:.5rem;letter-spacing:.125rem;margin-bottom:1rem}.avatar-wrapper[_ngcontent-%COMP%]{--avatar-size: 6rem;position:absolute;flex-shrink:0;width:var(--avatar-size);height:var(--avatar-size);margin-right:.5rem;transform:translateY(calc(var(--avatar-size) / -2));border-radius:100%;overflow:hidden}.avatar[_ngcontent-%COMP%]{width:var(--avatar-size);height:var(--avatar-size);object-fit:cover}.user-identification[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-self:flex-end;overflow:hidden}.filler[_ngcontent-%COMP%]{width:7rem;height:3rem}.displayname[_ngcontent-%COMP%]{font-size:1.75rem;overflow:hidden;text-overflow:ellipsis}.username[_ngcontent-%COMP%]{font-size:1.25rem;color:#ffffff80}.user-more[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.stats[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;gap:1rem;justify-content:space-between;opacity:80%}.post-stats[_ngcontent-%COMP%], .follow-stats[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;gap:1.5rem;text-wrap:nowrap}.follow-stats[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]:hover{cursor:pointer;color:#fff}mat-icon[_ngcontent-%COMP%]{vertical-align:text-bottom}.profile-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.user-section-group[_ngcontent-%COMP%]{flex:1;border:none;border-radius:0;background-color:#1e1e1ebf}mat-button-toggle[_ngcontent-%COMP%]{color:#fff;width:100%;border:none!important}.user-feed[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.loading[_ngcontent-%COMP%]{flex:1;display:flex;justify-content:center;padding-top:10rem}"]})}}return n})();var qt=(()=>{class n{constructor(e,t){this.route=e,this.router=t,this.userService=x(Y),this.profileService=x(K),this.me=w(h),this.user=w(h),this.section=w("posts"),this.sameProfile=C(()=>this.me()!=h&&this.user().username==this.profileService.currentProfile?.username),this.isValid=C(()=>this.me()!=h&&this.user()!=h),this.profileInfo=C(()=>({user:this.user(),posts:this.posts(),comments:this.comments(),likes:this.likes(),follows:this.follows(),followers:this.followers()})),this.subs=[],this.isProfileMainSection=I,this.isProfileFollowSection=J,this.me=this.userService.me$,this.posts=this.profileService.profilePosts$,this.comments=this.profileService.comments$,this.likes=this.profileService.likes$,this.follows=this.profileService.follows$,this.followers=this.profileService.followers$;let o=this.route.params.subscribe(p=>{let u=p.username,$=p.section;if(Ce($)&&this.section.set($),this.profileService.currentProfile&&u==this.profileService.currentProfile?.username){let E=this.profileService.currentProfile;this.user.set(E)}else this.user.set(h),this.userService.getUserByUsername$(u).subscribe({next:E=>{this.user.set(E),this.profileService.setUser(E)},error:E=>{}})});this.subs.push(o)}ngOnInit(){}ngOnDestroy(){for(let e of this.subs)e.unsubscribe()}onFollowChange(e){e.action=="follow"?this.follow(e.data):e.action=="unfollow"&&this.unfollow(e.data)}follow(e){this.userService.followUser$(e).subscribe({next:t=>{this.userService.updateFollows(t),this.user.update(o=>X(Q({},o),{followCount:o.followCount+1}))},error:t=>{console.log(t)}})}unfollow(e){this.userService.unfollowUser$(e).subscribe({next:t=>{this.userService.removeFollows(t),this.user.update(o=>X(Q({},o),{followCount:o.followCount-1}))},error:t=>{console.log(t)}})}static{this.\u0275fac=function(t){return new(t||n)(_(O),_(T))}}static{this.\u0275cmp=U({type:n,selectors:[["sns-profile"]],decls:6,vars:15,consts:[["id","sns-profile"],[3,"hidden"],["hasLoading","",1,"main-content",3,"onFollowChange","me","user","posts","comments","likes","loadUntil","immediate"],["hasLoading","",1,"main-content",3,"onFollowChange","me","user","follows","followers","loadUntil","immediate"],[1,"side-content"]],template:function(t,o){t&1&&(s(0,"div",0)(1,"div",1)(2,"sns-user",2),g("onFollowChange",function(u){return o.onFollowChange(u)}),r()(),s(3,"div",1)(4,"sns-user-follows",3),g("onFollowChange",function(u){return o.onFollowChange(u)}),r()(),f(5,"sns-search",4),r()),t&2&&(i(),a("hidden",!o.isProfileMainSection(o.section())),i(),a("me",o.me())("user",o.user())("posts",o.posts())("comments",o.comments())("likes",o.likes())("loadUntil",o.isValid())("immediate",o.sameProfile()),i(),a("hidden",!o.isProfileFollowSection(o.section())),i(),a("me",o.me())("user",o.user())("follows",o.follows())("followers",o.followers())("loadUntil",o.isValid())("immediate",o.sameProfile()))},dependencies:[Me,we,be,_e],styles:["#sns-profile[_ngcontent-%COMP%]{position:relative;display:flex;flex-flow:row nowrap;justify-content:center;width:100%;max-height:100%}@media(max-width:1080px){sns-user[_ngcontent-%COMP%]{min-width:10rem;padding-right:1rem}.side-content[_ngcontent-%COMP%]{flex:0!important;width:0px!important;min-width:0px!important;visibility:collapse}}"]})}}return n})();export{qt as SnsProfileComponent};
