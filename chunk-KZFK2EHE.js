import{a as Je}from"./chunk-IG64557V.js";import{a as ve,b as ke,c as de}from"./chunk-ZUWKRBQH.js";import{a as Ve}from"./chunk-AJGG4FPL.js";import{a as qe}from"./chunk-RFHZPYFY.js";import{a as he}from"./chunk-QE36J6DD.js";import{a as We}from"./chunk-GGYXFCSL.js";import{a as B,b as N,c as ze,d as be}from"./chunk-XFLXBRIR.js";import{b as K,c as b,e as V,f as Q,g as D,i as g,k as ee,l as ge,m as Be,n as te,q as ie,r as re,s as q,t as W,v as He,y as A}from"./chunk-TNQGBTTS.js";import{a as ne,b as me,c as pe,d as xe,e as Ye}from"./chunk-2XN2X2Z5.js";import{b as P}from"./chunk-6LAHZWAR.js";import{a as U}from"./chunk-LE6ER5HQ.js";import{b as I,c as fe,d as M,e as E,i as $}from"./chunk-BT2GGWQX.js";import{a as Ue}from"./chunk-R7EBFGLF.js";import"./chunk-B6GQN5TU.js";import{m as ue}from"./chunk-BLCVZY47.js";import{$a as s,Ab as Ae,B as Oe,Ca as ye,Db as m,Gb as Ne,Hb as Se,Jb as H,Kb as je,Lb as y,Mb as S,Nb as r,Ob as n,Pb as c,Rb as J,Tb as x,Ub as f,Ya as le,Z as Te,_a as Y,ab as u,da as v,dc as a,ec as h,fc as Ge,ia as Le,k as Me,ka as F,kc as R,l as Pe,la as O,lb as C,lc as G,nc as X,oc as Z,qa as Ie,r as Fe,sa as De,sb as _,wc as we,xc as $e,yb as T,zb as L}from"./chunk-X7EC65UH.js";function Ee(t,d){!d?.injector&&Le(Ee);let e=d?.injector??v(Ie),i=new Me(1),o=$e(()=>{let l;try{l=t()}catch(p){we(()=>i.error(p));return}we(()=>i.next(l))},{injector:e,manualCleanup:!0});return e.get(De).onDestroy(()=>{o.destroy(),i.complete()}),i.asObservable()}var gt=(t,d)=>d.id,vt=()=>[ee,q,W,K,ge,re,V,Q,te,ie,E],Xe=()=>["/loa-assistant/home"];function bt(t,d){if(t&1&&(r(0,"option",22),a(1),n()),t&2){let e=d.$implicit;m("value",e.name),s(),h(e.name)}}function xt(t,d){if(t&1){let e=J();r(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"div",6)(5,"h5",7),a(6,"Add Character"),n(),r(7,"div",8),c(8,"img",9),n(),c(9,"button",10),n()(),r(10,"div",11)(11,"div",8)(12,"form",12),x("submit",function(){F(e);let o=f();return O(o.submit())}),r(13,"div",13)(14,"div",14),c(15,"input",15),r(16,"label",16),a(17,"Name"),n()(),r(18,"div",17),c(19,"input",18),r(20,"label",19),a(21,"Item Level"),n()()(),r(22,"div",20)(23,"select",21),y(24,bt,2,2,"option",22,gt),n(),r(26,"label",23),a(27,"Class"),n()(),r(28,"div",24),c(29,"input",25),r(30,"label",26),a(31,"Player"),n()(),r(32,"div",27)(33,"button",28),x("click",function(){F(e);let o=f();return O(o.reset())}),a(34,"Reset"),n(),r(35,"button",29),a(36,"Add Character"),n()()()()(),r(37,"div",30)(38,"button",31),a(39,"Cancel"),n()()()()()}if(t&2){let e=f();s(8),m("title",e.character().loaClass.name)("src",e.getLoaClassImage(e.character().loaClass),le),s(),m("routerLink",R(6,Xe)),s(3),m("formGroup",e.characterForm),s(12),S(e.loaClasses()),s(11),m("disabled",e.characterForm.invalid),s(3),m("routerLink",R(7,Xe))}}var Ze=(()=>{class t{constructor(e,i,o){this.toastService=e,this.route=i,this.router=o,this.playerService=v(P),this.characterService=v(B),this.subs=[],this.getLoaClassImage=de,this.characterForm=new D({name:new g("",[b.required,b.pattern("[a-zA-Z]*")]),itemlevel:new g("",[b.required,b.min(0),b.max(ve)]),loaClass:new g("",[b.required]),player:new g("",b.required)}),this.playerChanges=Ee(this.playerService.me$),this.player=this.playerService.me$,this.character=ye(structuredClone(ke)),this.loaClasses=this.characterService.loaClasses$}ngOnInit(){var e=this.playerChanges.subscribe(o=>{o&&(this.character().player=o,this.characterForm.controls.player.setValue(o.name))}),i=this.characterService.characterChanges$.subscribe(o=>{o.change=="add"&&o.character.name==this.character.name&&(this.character.set(o.character),this.router.navigate([`/loa-assistant/characters/${o.character.id}`]))});this.subs.push(e,i)}ngOnDestroy(){for(let e of this.subs)e.unsubscribe()}cancel(){this.router.navigate(["."],{relativeTo:this.route.parent})}submit(){let e=this.character();e.name=this.characterForm.controls.name.value,e.itemlevel=this.characterForm.controls.itemlevel.value;var i=this.loaClasses().find(o=>o.name==this.characterForm.controls.loaClass.value);i?e.loaClass=i:this.toastService.show({header:"Character Creation Error",body:"Invalid Character Class",type:"warning",source_feature:"loa-assistant"}),this.character.set(e),console.log(this.character()),this.characterService.addCharacter(e)}reset(){let e=structuredClone(ke),i=this.player();i&&(e.player=i),this.character.set(e),this.characterForm.controls.name.reset(),this.characterForm.controls.itemlevel.reset(),this.characterForm.controls.loaClass.reset(),this.characterForm.controls.player.reset(i?.name)}static{this.\u0275fac=function(i){return new(i||t)(u(U),u(I),u(M))}}static{this.\u0275cmp=C({type:t,selectors:[["character-add"]],hostBindings:function(i,o){i&1&&x("keydown.escape",function(p){return o.cancel(p)},!1,Y)},decls:6,vars:1,consts:[[1,"_color-discord-content-text"],[1,"modal-backdrop"],[1,"modal","loa-character-add",2,"display","block"],[1,"modal-dialog","modal-dialog-centered","modal-dialog-scrollable","mw-75","_minw-25r","mx-auto"],[1,"modal-content","border","_minh-75"],[1,"modal-header","flex-column","gap-2"],[1,"d-flex","align-items-center","w-100","px-3"],[1,"modal-title","flex-grow-1"],[1,"flex-grow-1"],[1,"img-fluid","_class-image",3,"title","src"],["type","button","data-bs-backdrop","static","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"routerLink"],[1,"modal-body","d-flex"],[1,"d-flex","h-100","flex-column","gap-3",3,"submit","formGroup"],[1,"d-flex","gap-2"],[1,"form-floating","flex-grow-1"],["type","text","id","cName","formControlName","name","placeholder","Name",1,"form-control"],["for","cName"],[1,"form-floating","flex-shrink-0","w-10r"],["type","number","id","cLevel","formControlName","itemlevel","placeholder","Item Level",1,"form-control"],["for","cLevel"],[1,"form-floating","flex-shrink-0"],["formControlName","loaClass","id","cClass",1,"form-select"],[3,"value"],["for","cClass"],[1,"form-floating"],["type","text","readonly","","id","cPlayer","formControlName","player","placeholder","Player",1,"form-control-plaintext"],["for","cPlayer"],[1,"d-flex","flex-grow-1","align-items-end","justify-content-center","gap-2"],["type","button",1,"btn","btn-warning","flex-grow-1","mw-15r",3,"click"],["type","submit",1,"btn","btn-success","flex-grow-1","mw-15r",3,"disabled"],[1,"modal-footer","justify-content-end"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary",3,"routerLink"]],template:function(i,o){i&1&&(r(0,"div",0),a(1,"Loa Character Add / Edit"),n(),c(2,"div",1),_(3,xt,40,8),T(4,3,vt)),i&2&&(s(4),L(o.character))},dependencies:[A],styles:[".loa-character-add[_ngcontent-%COMP%]   .form-floating[_ngcontent-%COMP%]   .form-control-plaintext[_ngcontent-%COMP%]{color:var(--discord-menu-text)}._class-image[_ngcontent-%COMP%]{line-height:0;max-height:3rem;opacity:.5}"]})}}return t})();var Ct=(t,d)=>d.id,_t=()=>[ee,q,W,K,ge,re,V,Q,te,ie,E,import("./chunk-SBTALXUT.js").then(t=>t.CharacterRaidsEditComponent),import("./chunk-I26YH7JW.js").then(t=>t.CharacterRepeatsEditComponent)],Ke=()=>["/loa-assistant/home"];function yt(t,d){if(t&1&&(r(0,"option",28),a(1),n()),t&2){let e=d.$implicit;m("value",e.name),s(),h(e.name)}}function St(t,d){if(t&1){let e=J();r(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"div",6)(5,"h5",7),a(6),n(),r(7,"div",8),c(8,"img",9),n(),c(9,"button",10),n(),r(10,"ul",11)(11,"li",12)(12,"span",13),a(13,"Info"),n()(),r(14,"li",12)(15,"span",14),a(16,"Raids"),n()(),r(17,"li",12)(18,"span",15),a(19,"Repeats"),n()()()(),r(20,"div",16)(21,"div",17)(22,"form",18),x("submit",function(){F(e);let o=f();return O(o.submit(o.characterForm))}),r(23,"div",19)(24,"div",20),c(25,"input",21),r(26,"label",22),a(27,"Name"),n()(),r(28,"div",23),c(29,"input",24),r(30,"label",25),a(31,"Item Level"),n()()(),r(32,"div",26)(33,"select",27),y(34,yt,2,2,"option",28,Ct),n(),r(36,"label",29),a(37,"Class"),n()(),r(38,"div",30),c(39,"input",31),r(40,"label",32),a(41,"Player"),n()(),r(42,"div",33)(43,"button",34),x("click",function(){F(e);let o=f();return O(o.reset(o.characterForm))}),a(44,"Reset"),n(),r(45,"button",35),a(46,"Save Changes"),n()()()(),r(47,"div",36),c(48,"character-raids-edit",37),n(),r(49,"div",38),c(50,"character-repeats-edit",37),n()(),r(51,"div",39)(52,"button",40),x("click",function(){F(e);let o=f();return O(o.characterDelete())}),a(53,"Delete"),n(),r(54,"button",41),a(55,"Cancel"),n()()()()()}if(t&2){let e=f();s(6),h(e.character.name),s(2),m("title",e.character.loaClass.name)("src",e.getLoaClassImage(e.character.loaClass),le),s(),m("routerLink",R(9,Ke)),s(13),m("formGroup",e.characterForm),s(12),S(e.loaClasses()),s(11),m("disabled",e.characterForm.invalid),s(3),m("character",e.character),s(2),m("character",e.character),s(4),m("routerLink",R(10,Ke))}}var Qe=(()=>{class t{constructor(e,i,o){this.route=e,this.router=i,this.toastService=o,this.playerService=v(P),this.characterService=v(B),this.raidService=v(N),this.subs=[],this.getLoaClassImage=de,this.characterForm=new D({name:new g("",[b.required,b.pattern("[a-zA-Z]*")]),itemlevel:new g("",[b.required,b.min(0),b.max(ve)]),loaClass:new g("",[b.required]),player:new g("",b.required)}),this.loaClasses=this.characterService.loaClasses$}ngOnInit(){let e=this.route.snapshot.params.id;this.characterService.getById(e).subscribe({next:i=>this.characterFound(i),error:i=>this.characterNotFound(i)})}ngOnDestroy(){for(let e of this.subs)e.unsubscribe()}cancel(){this.router.navigate(["."],{relativeTo:this.route.parent})}characterFound(e){console.log(e),this.character=e;for(let[i,o]of Object.entries(this.characterForm.controls))switch(i){case"name":o.setValue(this.character.name);break;case"itemlevel":o.setValue(this.character.itemlevel);break;case"loaClass":break;case"player":o.setValue(this.character.player.name);break}this.characterForm.controls.loaClass.setValue(this.character.loaClass.name)}characterNotFound(e){console.log(e),this.toastService.show({header:"Character",body:`Character with id:${this.route.snapshot.params.id} not found`,type:"danger",source_feature:"loa-assistant"}),this.router.navigate(["."],{relativeTo:this.route.parent})}submit(e){e===this.characterForm&&this.characterEdit()}reset(e){e===this.characterForm&&this.characterReset()}characterEdit(){for(let[i,o]of Object.entries(this.characterForm.controls))switch(i){case"name":this.character.name=o.value;break;case"itemlevel":this.character.itemlevel=o.value;break;case"loaClass":var e=this.loaClasses().find(l=>l.name===o.value);e&&(this.character.loaClass=e);break;case"player":break}this.characterService.editCharacter(this.character)}characterReset(){for(let[e,i]of Object.entries(this.characterForm.controls))switch(e){case"name":i.reset(this.character.name);break;case"itemlevel":i.reset(this.character.itemlevel);break;case"loaClass":i.reset(this.character.loaClass.name);break;case"player":i.reset(this.character.player.name);break}}characterDelete(){confirm(`Are you sure wish to delete this character: '${this.character.name}' ?`)&&(this.characterService.deleteCharacter(this.character),this.router.navigate(["."],{relativeTo:this.route.parent}))}static{this.\u0275fac=function(i){return new(i||t)(u(I),u(M),u(U))}}static{this.\u0275cmp=C({type:t,selectors:[["loa-character-edit"]],hostBindings:function(i,o){i&1&&x("keydown.escape",function(p){return o.cancel(p)},!1,Y)},decls:6,vars:1,consts:[[1,"_color-discord-content-text"],[1,"modal-backdrop"],[1,"modal","loa-character-edit",2,"display","block"],[1,"modal-dialog","modal-dialog-centered","modal-dialog-scrollable","mw-75","_minw-25r","mx-auto"],[1,"modal-content","border","_minh-75"],[1,"modal-header","flex-column","gap-2"],[1,"d-flex","align-items-center","w-100","px-3"],[1,"modal-title","flex-grow-1"],[1,"flex-grow-1"],[1,"img-fluid","_class-image",3,"title","src"],["type","button","data-bs-backdrop","static","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"routerLink"],["role","tablist",1,"nav","nav-tabs","w-100","flex-nowrap","px-3"],["role","presentation",1,"nav-item"],["id","chrInfoTab","data-bs-toggle","tab","data-bs-target","#chrInfo","role","tab","aria-controls","chrInfo","aria-selected","false",1,"nav-link"],["id","chrRaidsTab","data-bs-toggle","tab","data-bs-target","#chrRaids","role","tab","aria-controls","chrRaids","aria-selected","true",1,"nav-link","active"],["id","chrRepeatsTab","data-bs-toggle","tab","data-bs-target","#chrRepeats","role","tab","aria-controls","chrRepeats","aria-selected","false",1,"nav-link"],[1,"modal-body","d-flex","tab-content"],["id","chrInfo","role","tabpanel","aria-labelledby","chrInfoTab",1,"tab-pane","fade","flex-grow-1"],[1,"d-flex","h-100","flex-column","gap-3",3,"submit","formGroup"],[1,"d-flex","gap-2"],[1,"form-floating","flex-grow-1"],["type","text","id","cName","formControlName","name","placeholder","Name",1,"form-control"],["for","cName"],[1,"form-floating","flex-shrink-0","w-10r"],["type","number","id","cLevel","formControlName","itemlevel","placeholder","Item Level",1,"form-control"],["for","cLevel"],[1,"form-floating","flex-shrink-0"],["formControlName","loaClass","id","cClass",1,"form-select"],[3,"value"],["for","cClass"],[1,"form-floating"],["type","text","readonly","","id","cPlayer","formControlName","player","placeholder","Player",1,"form-control-plaintext"],["for","cPlayer"],[1,"d-flex","flex-grow-1","align-items-end","justify-content-center","gap-2"],["type","button",1,"btn","btn-warning","flex-grow-1","mw-15r",3,"click"],["type","submit",1,"btn","btn-success","flex-grow-1","mw-15r",3,"disabled"],["id","chrRaids","role","tabpanel","aria-labelledby","chrRaidsTab",1,"tab-pane","fade","flex-grow-1","show","active"],[3,"character"],["id","chrRepeats","role","tabpanel","aria-labelledby","chrRepeatsTab",1,"tab-pane","fade","flex-grow-1"],[1,"modal-footer","justify-content-between"],["type","button",1,"btn","btn-danger",3,"click"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary",3,"routerLink"]],template:function(i,o){i&1&&(r(0,"div",0),a(1,"Loa Character Add / Edit"),n(),c(2,"div",1),_(3,St,56,11),T(4,3,_t)),i&2&&(s(4),L(o.character))},dependencies:[ue,A,$],styles:[".loa-character-edit[_ngcontent-%COMP%]   .nav-tabs[_ngcontent-%COMP%]{border-color:var(--discord-menu-text)}.loa-character-edit[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{color:var(--discord-content-text)}.loa-character-edit[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover{cursor:pointer;border-color:var(--discord-menu-text)}.loa-character-edit[_ngcontent-%COMP%] > .modal-dialog[_ngcontent-%COMP%] > .modal-content[_ngcontent-%COMP%] > .modal-header[_ngcontent-%COMP%]{padding:1rem 0rem 0rem}.loa-character-edit[_ngcontent-%COMP%] > .modal-dialog[_ngcontent-%COMP%] > .modal-content[_ngcontent-%COMP%] > .modal-header[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{border-color:var(--discord-menu-text);border-bottom-color:transparent;background-color:var(--discord-menu)}.loa-character-edit[_ngcontent-%COMP%]   .form-floating[_ngcontent-%COMP%]   .form-control-plaintext[_ngcontent-%COMP%]{color:var(--discord-menu-text)}._class-image[_ngcontent-%COMP%]{line-height:0;max-height:3rem;opacity:.5}"]})}}return t})();var Re=(t,d)=>d.id,wt=()=>[E],kt=()=>[import("./chunk-527MARKQ.js").then(t=>t.GroupEditComponent),import("./chunk-PT4XS6NT.js").then(t=>t.LoaCharacterComponent),import("./chunk-43GZZAQW.js").then(t=>t.NonMutatingOrderByPipe),q,W,re,V,Be,E],Et=()=>[import("./chunk-5N3FTQAW.js").then(t=>t.OrderByPipe),q,W],Rt=()=>["/loa-assistant"],et=t=>["/loa-assistant/home/raids",t];function Mt(t,d){if(t&1&&(r(0,"li",4)(1,"a",5),a(2,"Raids"),n()(),r(3,"li",6),a(4,"Groups"),n()),t&2){let e=f();s(),m("routerLink",G(1,et,e.raidpost.id))}}function Pt(t,d){if(t&1&&(r(0,"option",38),a(1),n()),t&2){let e=d.$implicit;m("value",e.name),s(),h(e.loaClass.name+" | "+e.itemlevel+" - "+e.player.name)}}function Ft(t,d){if(t&1&&(r(0,"datalist",37),y(1,Pt,2,2,"option",38,Re),X(3,"orderBy"),n()),t&2){let e=f(2);s(),S(Z(3,0,e.available,e.sortSignups))}}function Ot(t,d){if(t&1&&c(0,"loa-character",24),t&2){let e=d.$implicit;m("character",e)("showPlayer",!0)}}function Tt(t,d){if(t&1&&c(0,"group-edit",29),t&2){let e=d.$implicit,i=f(2);m("groupsFormArray",i.groupsFormArray)("raidpost",i.raidpost)("group",e)("available",i.available)}}function Lt(t,d){t&1&&(r(0,"div",30)(1,"h5"),a(2,"Raidpost currently has no groups"),n()())}function It(t,d){if(t&1){let e=J();_(0,Ft,4,3),T(1,0,Et),Ae(),r(3,"div",7)(4,"section",8)(5,"div",9)(6,"h5"),a(7),n(),r(8,"h5"),a(9),n(),r(10,"h5"),a(11),n()(),r(12,"div",10)(13,"select",11)(14,"option",12),a(15,"Full Auto"),n(),r(16,"option",13),a(17,"Semi Auto"),n(),r(18,"option",14),a(19,"Full Manual"),n()(),r(20,"label",15),a(21,"Mode"),n()()(),r(22,"section",16)(23,"div",17)(24,"div",18)(25,"div",19)(26,"h5",20)(27,"button",21),a(28,"Sign-ups"),n()(),r(29,"div",22)(30,"div",23),y(31,Ot,1,2,"loa-character",24,Re),X(33,"nonMutatingOrderBy"),n()()()(),r(34,"div",25)(35,"div",26)(36,"div",27)(37,"h3"),a(38,"Post mode must be set to 'Manual' to save changes"),n()()(),r(39,"div",28),y(40,Tt,1,4,"group-edit",29,Re,!1,Lt,3,0,"div",30),n()()(),r(43,"div")(44,"div",31)(45,"div",32)(46,"button",33),x("click",function(){F(e);let o=f();return O(o.addGroup())}),a(47,"Add Group"),n(),r(48,"button",34),x("click",function(){F(e);let o=f();return O(o.reset())}),a(49,"Reset"),n()(),r(50,"div",32)(51,"button",35),x("click",function(){F(e);let o=f();return O(o.submit())}),a(52,"Save Changes"),n(),r(53,"button",36),a(54,"Cancel"),n()()()()()()}if(t&2){let e=f();s(7),h(e.raidpost.name),s(2),h(e.raidpost.properties.loaRaid.name),s(2),h(e.raidTime(e.raidpost.properties.startTime)),s(2),m("formControl",e.raidMode),s(18),S(Z(33,8,e.raidpost.signups,e.sortSignups)),s(4),m("hidden",e.validMode),s(5),S(e.raidpost.groups),s(11),m("disabled",!e.validMode),s(2),m("routerLink",G(11,et,e.raidpost.id))}}var tt=(()=>{class t{constructor(e,i,o,l){this.route=e,this.router=i,this.toastService=o,this.idGen=l,this.playerService=v(P),this.groupEditService=v(Je),this.loaRaidService=v(N),this.available=[],this.raidTime=ne,this.subs=[],this.groupsFormArray=new He([]),this.raidForm=new D({groups:this.groupsFormArray}),this.raidMode=new g("FULL_AUTO")}ngOnInit(){let e=this.route.snapshot.params.id;var i=this.loaRaidService.getById(e).subscribe({next:l=>{this.raidpost=l,this.raidMode.reset(l.properties.mode),this.groupsBackup=[...this.raidpost.groups],this.available=[...this.raidpost.signups]},error:l=>{this.router.navigate(["loa-assistant"]),console.log(l)}}),o=this.loaRaidService.raidChanges$.subscribe(l=>{l.change=="groups"?(console.log(l.raidpost),this.groupsBackup=l.raidpost.groups,this.groupEditService.save()):l.change=="edit"&&(this.raidpost=l.raidpost,this.groupsBackup=l.raidpost.groups,this.raidMode.reset(this.raidpost.properties.mode))});this.subs.push(i,o)}ngOnDestroy(){for(let e of this.subs)e.unsubscribe();this.toastService.clear()}get validMode(){return this.raidMode.value.toLowerCase().includes("manual")}addGroup(){this.raidpost.groups.push({id:this.idGen.nextGroupId,name:`Group ${this.raidpost.groups.length+1}`,parties:[],raid:this.raidpost}),console.log(this.raidpost.groups)}submit(){if(!this.validMode){this.raidpost.properties.mode=this.raidMode.value,this.toastService.show({header:"Raid Mode",body:"Mode for post must be set to MANUAL to edit groups",type:"warning",source_feature:"loa-assistant",delay:5e3});return}let e=this.parseGroupInput(this.groupsFormArray.value);this.raidpost.groups=e,this.loaRaidService.groups(this.raidpost)}reset(){this.raidpost.groups=[...this.groupsBackup],Object.assign(this.available,this.raidpost.signups),this.groupsFormArray.clear(),this.groupEditService.reset()}sortC(e,i){return e.name.localeCompare(i.name,void 0,{sensitivity:"base"})}sortSignups(e,i){let o=e.player.name.localeCompare(i.player.name,void 0,{sensitivity:"base"});return o!=0?o:e.name.localeCompare(i.name,void 0,{sensitivity:"base"})}notAssigned(e){for(let i of this.groupsFormArray.controls)for(let o of i.get("partys").controls)for(let l of o.controls)if(l.value==e.id)return!1;return!0}cloneRaidpost(e){let i=structuredClone(e);return delete i.groups,i}parseGroupInput(e){var i=[];let o=this.cloneRaidpost(this.raidpost);for(let l of e){let p={id:l.groupId,name:`Group ${i.length+1}`,raid:o},k=this.parsePartyInput(l.partys);for(let w of k)w.group=structuredClone(p);p.parties=k,i.push(p)}return i}parsePartyInput(e){let i=[];if(e.length==0)return i;for(let o of e){let l=this.parseMemberInput(o),p={id:0,name:`Party ${i.length+1}`,members:l};i.push(p)}return i}parseMemberInput(e){let i=[];console.log(e);for(let o of e){let l=this.raidpost.signups.find(p=>p.id==o);if(l){i.push(l);continue}l=this.raidpost.signups.find(p=>p.name.toLowerCase()==o.toLowerCase()),l&&i.push(l)}return i}static{this.\u0275fac=function(i){return new(i||t)(u(I),u(M),u(U),u(ze))}}static{this.\u0275cmp=C({type:t,selectors:[["edit-raid-groups"]],inputs:{raidpost:"raidpost"},decls:13,vars:4,consts:[[1,"container-xxl","d-flex","flex-column","raid-group-edit"],[1,"d-flex","w-100","pt-2","border-secondary","border-bottom"],["aria-label","breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],[3,"routerLink"],["aria-current","page",1,"breadcrumb-item","active"],[1,"raid-group-edit","d-flex","flex-column","gap-3","_color-discord-menu-text"],[1,"d-flex","flex-column","gap-2","pt-3"],[1,"d-flex","justify-content-between","align-items-center"],[1,"form-floating"],["id","raidMode",1,"form-select","form-select-lg",3,"formControl"],["value","FULL_AUTO"],["value","SEMI_AUTO"],["value","FULL_MANUAL"],["for","raidMode"],[1,"vh-100","edit-section"],[1,"group-edit-section","flex-grow-1","overflow-hidden"],["id","signupsSection",1,"signups-section","accordion","overflow-y-auto"],[1,"accordion-item"],["id","signupListHeader",1,"accordion-header"],["data-bs-toggle","collapse","href","#signupList","role","button","aria-expanded","true","aria-controls","signupList",1,"accordion-button"],["id","signupList","aria-labelledby","signupListHeader","data-bs-parent","signupsSection",1,"accordion-collapse","collapse","collapse","show"],[1,"signups-list"],[1,"",3,"character","showPlayer"],[1,"groups","overflow-y-scroll"],[1,"position-sticky","sticky-top",3,"hidden"],[1,"text-center","bg-warning","text-black","p-2"],[1,"d-flex","flex-column","gap-3","px-2"],[1,"w-100",3,"groupsFormArray","raidpost","group","available"],[1,"text-center"],[1,"row","g-3"],[1,"col-6","d-flex","gap-2"],[1,"btn","btn-primary","flex-grow-1",3,"click"],[1,"btn","btn-warning","flex-grow-1",3,"click"],[1,"btn","btn-success","flex-grow-1",3,"click","disabled"],[1,"btn","btn-secondary","flex-grow-1",3,"routerLink"],["id","raidSignups"],[3,"value"]],template:function(i,o){i&1&&(r(0,"div",0)(1,"div",1)(2,"nav",2)(3,"ol",3)(4,"li",4)(5,"a",5),a(6,"Home"),n()(),_(7,Mt,5,3),T(8,7,wt),n()()(),_(10,It,55,13),T(11,10,kt),n()),i&2&&(s(5),m("routerLink",R(3,Rt)),s(3),L(o.raidpost),s(3),L(o.raidpost))},dependencies:[A,$,E],styles:[".edit-section[_ngcontent-%COMP%]{display:grid;grid-template-rows:1fr auto;gap:1rem}.group-edit-section[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto 1fr;gap:.5rem;padding-top:.5rem;padding-bottom:.5rem}.raid-group-edit[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:var(--discord-type)}.signups-section[_ngcontent-%COMP%]   .accordion-button[_ngcontent-%COMP%]{border:none;box-shadow:none}.signups-section[_ngcontent-%COMP%]   .accordion-item[_ngcontent-%COMP%]{border:none}.signups-list[_ngcontent-%COMP%]{display:flex;max-width:28rem;flex-flow:row wrap;gap:.75rem;padding:.25rem;overflow-y:auto}.ttt[_ngcontent-%COMP%]{height:100%;position:relative}.groups[_ngcontent-%COMP%]::-webkit-scrollbar, .signups-list[_ngcontent-%COMP%]::-webkit-scrollbar{width:10px}.groups[_ngcontent-%COMP%]::-webkit-scrollbar-track   .signups-list[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent;margin:0}.groups[_ngcontent-%COMP%]::-webkit-scrollbar-thumb, .signups-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#888;background:var(--discord-menu-text);border-radius:3px}.groups[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover, .signups-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#555}@media (max-width:1000px){.group-edit-section[_ngcontent-%COMP%]{grid-template-columns:14rem 1fr}}@media (max-width:780px){.group-edit-section[_ngcontent-%COMP%]{grid-template-columns:1fr}.signups-section[_ngcontent-%COMP%]{order:2;align-self:end}.signups-list[_ngcontent-%COMP%]{max-width:none;flex-flow:row nowrap}}"]})}}return t})();var it=(t,d)=>d.id,rt=()=>["/loa-assistant/home"];function Dt(t,d){t&1&&c(0,"i",7)}function At(t,d){if(t&1&&(r(0,"option",22),a(1),n()),t&2){let e=d.$implicit;m("value",e.name),s(),h(e.name)}}function Nt(t,d){if(t&1&&(r(0,"option",22),a(1),n()),t&2){let e=d.$implicit;m("value",e.name),s(),h(e.name)}}var nt=(()=>{class t{constructor(e,i,o){this.route=e,this.router=i,this.toastService=o,this.playerService=v(P),this.raidService=v(N),this.subs=[],this.raidForm=new D({}),this.raidForm.setControl("name",new g("",b.required)),this.raidForm.setControl("server",new g("",b.required)),this.raidForm.setControl("loaRaid",new g("",b.required)),this.raidForm.setControl("startTime",new g("",b.required)),this.raidForm.setControl("type",new g("",b.required)),this.loaRaids=this.raidService.loaRaids$,this.servers=this.playerService.myServers$}ngOnInit(){var e=this.raidService.raidChanges$.subscribe(i=>{i.change=="add"&&i.raidpost.name==this.raidpost?.name&&(this.raidpost=i.raidpost,this.router.navigate([`/loa-assistant/raids/${this.raidpost.id}`]))});this.subs.push(e)}ngOnDestroy(){for(let e of this.subs)e.unsubscribe()}cancel(){this.router.navigate(["."],{relativeTo:this.route.parent})}reset(){this.raidForm.reset(),this.raidpost=void 0}submit(){var e=this.raidForm.controls.name.value,i=this.servers().find(w=>w.name==this.raidForm.controls.server.value);i||this.toastService.show({header:"Raidpost Creation Error",body:"Invalid Server",type:"warning",source_feature:"loa-assistant"});var o=this.loaRaids().find(w=>w.name==this.raidForm.controls.loaRaid.value);o||this.toastService.show({header:"Raidpost Creation Error",body:"Invalid Raid",type:"warning",source_feature:"loa-assistant"});var l=this.raidForm.controls.startTime.value,p=this.raidForm.controls.type.value;if(!(!i||!o)){var k={type:p,id:"0",name:e,server:i,postProperties:{postTime:new Date,channelId:"",messageId:"",mentions:[]},properties:{startTime:pe(l),publishMessageId:"",remainderMessageId:"",loaRaid:o,playerCount:o.playerCount,mode:"FULL_AUTO"},signups:[],groups:[],remainders:[]};console.log(k),this.raidpost=k,this.raidService.addPost(this.raidpost)}}static{this.\u0275fac=function(i){return new(i||t)(u(I),u(M),u(U))}}static{this.\u0275cmp=C({type:t,selectors:[["raid-add"]],hostBindings:function(i,o){i&1&&x("keydown.escape",function(p){return o.cancel(p)},!1,Y)},decls:56,vars:7,consts:[[1,"modal-backdrop"],[1,"modal","raid-post-edit",2,"display","block"],[1,"modal-dialog","modal-dialog-centered","modal-dialog-scrollable","mw-75","_minw-25r","mx-auto"],[1,"modal-content","border","_minh-75"],[1,"modal-header","flex-column","gap-2"],[1,"edit-modal-header-top","w-100","px-3"],[1,"my-auto","flex-grow-1"],[1,"bi-arrow-clockwise","repeat-symbol"],["type","button","data-bs-backdrop","static","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"routerLink"],[1,"modal-body","d-flex"],["id","raidEdit",1,"flex-grow-1"],[1,"h-100","d-flex","flex-column"],[1,"alert","alert-warning","d-flex","align-items-center","justify-content-center","p-0","text-center","border-2","border-warning"],[1,"bi-exclamation","float-start","fs-2"],[1,"bi-exclamation","float-end","fs-2"],[1,"d-flex","flex-grow-1","flex-column","gap-3",3,"submit","formGroup"],[1,"form-floating"],["type","text","id","rName","formControlName","name","placeholder","Name",1,"form-control"],["for","rName"],[1,"d-flex","gap-2"],[1,"form-floating","flex-grow-1"],["id","rServer","formControlName","server",1,"form-select"],[3,"value"],["for","rServer"],[1,"form-floating","flex-shrink-0","w-10r"],["id","rLoaRaid","formControlName","loaRaid",1,"form-select"],["for","rLoaRaid"],["type","datetime-local","id","rStartTime","formControlName","startTime","placeholder","Start Time",1,"form-control"],["for","rStartTime"],["id","rType","formControlName","type",1,"form-select"],["value","raidpost"],["value","repeatingpost"],["for","rType"],[1,"d-flex","flex-grow-1","align-items-end","justify-content-center","gap-2"],["type","button",1,"btn","btn-warning","flex-grow-1","mw-15r",3,"click"],["type","submit",1,"btn","btn-success","flex-grow-1","mw-15r",3,"disabled"],[1,"modal-footer","justify-content-end"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary",3,"routerLink"]],template:function(i,o){i&1&&(c(0,"div",0),r(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"h5",6),a(7,"Add Raidpost"),n(),_(8,Dt,1,0,"i",7),c(9,"button",8),n()(),r(10,"div",9)(11,"div",10)(12,"div",11)(13,"div",12),c(14,"i",13),r(15,"span"),a(16,"Note that you must have permissions to manage raids in this post's Discord server"),n(),c(17,"i",14),n(),r(18,"form",15),x("submit",function(){return o.submit()}),r(19,"div",16),c(20,"input",17),r(21,"label",18),a(22,"Name"),n()(),r(23,"div",19)(24,"div",20)(25,"select",21),y(26,At,2,2,"option",22,it),n(),r(28,"label",23),a(29,"Server"),n()(),r(30,"div",24)(31,"select",25),y(32,Nt,2,2,"option",22,it),n(),r(34,"label",26),a(35,"Raid"),n()()(),r(36,"div",16),c(37,"input",27),r(38,"label",28),a(39,"Start Time"),n()(),r(40,"div",16)(41,"select",29)(42,"option",30),a(43,"No"),n(),r(44,"option",31),a(45,"Yes"),n()(),r(46,"label",32),a(47,"Repeating Post?"),n()(),r(48,"div",33)(49,"button",34),x("click",function(){return o.reset()}),a(50,"Reset"),n(),r(51,"button",35),a(52,"Add Post"),n()()()()()(),r(53,"div",36)(54,"button",37),a(55,"Cancel"),n()()()()()),i&2&&(s(8),H((o.raidpost==null?null:o.raidpost.type)=="repeatingpost"?8:-1),s(),m("routerLink",R(5,rt)),s(9),m("formGroup",o.raidForm),s(8),S(o.servers()),s(6),S(o.loaRaids()),s(19),m("disabled",!o.raidForm.valid),s(3),m("routerLink",R(6,rt)))},dependencies:[A,ee,q,W,K,re,V,Q,te,ie,E],styles:[".edit-modal-header-top[_ngcontent-%COMP%]{position:relative;display:flex;flex-flow:row nowrap;align-items:center}.repeat-symbol[_ngcontent-%COMP%]{position:absolute;left:50%;transform:translate(-50%);font-size:2rem;line-height:0;animation:_ngcontent-%COMP%_spin 4s linear infinite}.loaClassImage[_ngcontent-%COMP%]{height:1.5rem}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}"]})}}return t})();var jt=(t,d)=>d.id,Gt=()=>[E,ee,K,V,Q,te,ie,import("./chunk-3QOTLZIP.js").then(t=>t.RaidGroupComponent)],ot=()=>["/loa-assistant/home"],$t=t=>[t];function Vt(t,d){t&1&&c(0,"i",7)}function Ut(t,d){if(t&1&&(r(0,"div",19)(1,"span",18),a(2),n(),r(3,"span",18),a(4),n(),r(5,"span",18),a(6),n()()),t&2){let e=f(2);s(2),h("Me : "+e.counts.me.total),s(2),h("DPS : "+e.counts.me.dps),s(2),h("SUP : "+e.counts.me.sup)}}function Bt(t,d){if(t&1&&(r(0,"div")(1,"div"),c(2,"img",53),n(),r(3,"div",54),a(4),n(),r(5,"div"),a(6),n()()),t&2){let e=d.$implicit,i=f(2);s(2),m("title",e.loaClass.name)("alt",e.loaClass.name)("src",i.getLoaClassImage(e.loaClass),le),s(),Ne(i.characterIsMine$(e)),m("title",e.name),s(),h(e.name),s(2),h(e.itemlevel)}}function Ht(t,d){t&1&&(r(0,"div")(1,"span"),a(2,"No Remainders"),n()())}function qt(t,d){if(t&1&&c(0,"raid-group",24),t&2){let e=d.$implicit;m("group",e)}}function Wt(t,d){t&1&&(r(0,"div")(1,"span"),a(2,"No Current Groups"),n()())}function zt(t,d){if(t&1){let e=J();r(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"h5",6),a(6),n(),_(7,Vt,1,0,"i",7),c(8,"button",8),n(),r(9,"ul",9)(10,"li",10)(11,"span",11),a(12,"Info"),n()(),r(13,"li",10)(14,"span",12),a(15,"Groups"),n()(),r(16,"li",10)(17,"span",13),a(18,"Edit"),n()()()(),r(19,"div",14)(20,"div",15)(21,"div")(22,"h4"),a(23),n()(),r(24,"div")(25,"strong"),a(26),n()(),r(27,"div"),a(28),n(),r(29,"div",16)(30,"div",17)(31,"span",18),a(32),n(),r(33,"span",18),a(34),n(),r(35,"span",18),a(36),n()(),_(37,Ut,7,3,"div",19),n(),r(38,"div",20)(39,"h5"),a(40,"Remainders"),n(),r(41,"div",21),y(42,Bt,7,8,"div",null,jt,!1,Ht,3,0,"div"),n()()(),r(45,"div",22)(46,"div",23),y(47,qt,1,1,"raid-group",24,je,!1,Wt,3,0,"div"),n()(),r(50,"div",25)(51,"div",26)(52,"div",27),c(53,"i",28),r(54,"span"),a(55,"Note that you must have permissions to manage raids in this post's Discord server"),n(),c(56,"i",29),n(),r(57,"form",30),x("submit",function(){F(e);let o=f();return O(o.submit())}),r(58,"div",31),c(59,"input",32),r(60,"label",33),a(61,"Name"),n()(),r(62,"div",34)(63,"div",35),c(64,"input",36),r(65,"label",37),a(66,"Server"),n()(),r(67,"div",38),c(68,"input",39),r(69,"label",40),a(70,"Raid"),n()()(),r(71,"div",31),c(72,"input",41),r(73,"label",42),a(74,"Post Time"),n()(),r(75,"div",31),c(76,"input",43),r(77,"label",44),a(78,"Start Time"),n()(),r(79,"div",45)(80,"a",46),a(81,"Edit Groups"),n()(),r(82,"div",47)(83,"button",48),x("click",function(){F(e);let o=f();return O(o.reset())}),a(84,"Reset"),n(),r(85,"button",49),a(86,"Save Changes"),n()()()()()(),r(87,"div",50)(88,"button",51),x("click",function(){F(e);let o=f();return O(o.delete())}),a(89,"Delete"),n(),r(90,"button",52),a(91,"Cancel"),n()()()()()}if(t&2){let e=f();s(6),h(e.raidpost.properties.loaRaid.name),s(),H(e.raidpost.type=="repeatingpost"?7:-1),s(),m("routerLink",R(16,ot)),s(15),h(e.raidpost.name),s(3),h(e.raidTime(e.raidpost.properties.startTime)),s(2),h(e.raidpost.server.name),s(4),h("All : "+e.counts.all.total),s(2),h("DPS : "+e.counts.all.dps),s(2),h("SUP : "+e.counts.all.sup),s(),H(e.player()?37:-1),s(5),S(e.raidpost.remainders),s(5),S(e.groups),s(10),m("formGroup",e.raidForm),s(23),m("routerLink",G(17,$t,e.editGroupsLink)),s(5),m("disabled",!e.raidForm.valid),s(5),m("routerLink",R(19,ot))}}var at=(()=>{class t{constructor(e,i){this.route=e,this.router=i,this.playerService=v(P),this.characterService=v(B),this.raidService=v(N),this.subs=[],this.raidTime=ne,this.getLoaClassImage=de,this.raidForm=new D({}),this.player=this.playerService.me$}ngOnInit(){let e=this.route.snapshot.params.id;this.raidService.getById(e).subscribe({next:o=>this.raidpostFound(o),error:o=>this.raidpostNotFound(o)});var i=this.raidService.raidChanges$.subscribe(o=>{o.change=="edit"&&o.raidpost.id==this.raidpost?.id&&(this.backupPost=structuredClone(o.raidpost),this.raidpost=o.raidpost)});this.subs.push(i)}ngOnDestroy(){for(let e of this.subs)e.unsubscribe()}cancel(){this.router.navigate(["."],{relativeTo:this.route.parent})}raidpostFound(e){console.log(e),this.raidpost=e,this.backupPost=structuredClone(e),this.groups=e.groups,this.editGroupsLink=`/loa-assistant/raids/${this.raidpost.id}/edit/groups`,this.raidForm.setControl("name",new g(this.backupPost.name,b.required)),this.raidForm.setControl("server",new g(this.backupPost.server.name,b.required)),this.raidForm.setControl("loaRaid",new g(this.backupPost.properties.loaRaid.name,b.required)),this.raidForm.setControl("postTime",new g(me(this.backupPost.postProperties.postTime),b.required)),this.raidForm.setControl("startTime",new g(me(this.backupPost.properties.startTime),b.required))}raidpostNotFound(e){this.router.navigate(["."],{relativeTo:this.route.parent}),console.log(e)}get counts(){return Ye(this.raidpost,this.player())}submit(){let e=this.raidpost;for(let[i,o]of Object.entries(this.raidForm.controls))switch(i){case"name":e.name=o.value;break;case"server":break;case"loaRaid":break;case"postTime":e.postProperties.postTime=pe(o.value);break;case"startTime":e.properties.startTime=pe(o.value);break}this.raidService.editPost(this.raidpost)}reset(){this.raidForm.controls.name.reset(this.backupPost.name),this.raidForm.controls.server.reset(this.backupPost.server.name),this.raidForm.controls.loaRaid.reset(this.backupPost.properties.loaRaid.name),this.raidForm.controls.postTime.reset(me(this.backupPost.postProperties.postTime)),this.raidForm.controls.startTime.reset(me(this.backupPost.properties.startTime))}delete(){confirm(`Are you sure wish to delete this raidpost: '${this.raidpost.name}' ?`)&&(this.raidService.deletePost(this.raidpost),this.router.navigate(["."],{relativeTo:this.route.parent}))}characterIsMine$(e){return e.player.id===this.player()?.id?{color:"lightskyblue"}:{}}static{this.\u0275fac=function(i){return new(i||t)(u(I),u(M))}}static{this.\u0275cmp=C({type:t,selectors:[["raid-edit"]],hostBindings:function(i,o){i&1&&x("keydown.escape",function(p){return o.cancel(p)},!1,Y)},decls:4,vars:1,consts:[[1,"modal-backdrop"],[1,"modal","raid-post-edit",2,"display","block"],[1,"modal-dialog","modal-dialog-centered","modal-dialog-scrollable","mw-75","_minw-25r","mx-auto"],[1,"modal-content","border","_minh-75"],[1,"modal-header","flex-column","gap-2"],[1,"edit-modal-header-top","w-100","px-3"],[1,"my-auto","flex-grow-1"],[1,"bi-arrow-clockwise","repeat-symbol"],["type","button","data-bs-backdrop","static","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"routerLink"],["role","tablist",1,"nav","nav-tabs","w-100","flex-nowrap","px-3"],["role","presentation",1,"nav-item"],["id","raidInfoTab","data-bs-toggle","tab","data-bs-target","#raidInfo","role","tab","aria-controls","raidInfo","aria-selected","true",1,"nav-link","active"],["id","raidGroupsTab","data-bs-toggle","tab","data-bs-target","#raidGroups","role","tab","aria-controls","raidGroups","aria-selected","false",1,"nav-link"],["id","raidEditTab","data-bs-toggle","tab","data-bs-target","#raidEdit","role","tab","aria-controls","raidEdit","aria-selected","false",1,"nav-link"],[1,"modal-body","d-flex","tab-content"],["id","raidInfo","role","tabpanel","aria-labelledby","raidInfoTab",1,"tab-pane","fade","flex-grow-1","show","active"],[1,"border-top","border-secondary","pt-1","gap-1","my-2"],[1,"row"],[1,"col-4"],[1,"row","text-success"],[1,"text-center","pt-3"],[1,"d-flex","flex-wrap","gap-3","justify-content-center"],["id","raidGroups","role","tabpanel","aria-labelledby","raidGroupsTab",1,"tab-pane","fade","flex-grow-1"],[1,"d-flex","flex-wrap","gap-4","align-items-center","justify-content-center"],[3,"group"],["id","raidEdit","role","tabpanel","aria-labelledby","raidEditTab",1,"tab-pane","fade","flex-grow-1"],[1,"h-100","d-flex","flex-column"],[1,"alert","alert-warning","d-flex","align-items-center","justify-content-center","p-0","text-center","border-2","border-warning"],[1,"bi-exclamation","float-start","fs-2"],[1,"bi-exclamation","float-end","fs-2"],[1,"d-flex","flex-grow-1","flex-column","gap-3",3,"submit","formGroup"],[1,"form-floating"],["type","text","id","rName","formControlName","name","placeholder","Name",1,"form-control"],["for","rName"],[1,"d-flex","gap-2"],[1,"form-floating","flex-grow-1"],["type","text","readonly","","id","rServer","formControlName","server","placeholder","Server",1,"form-control-plaintext"],["for","rServer"],[1,"form-floating","flex-shrink-0","w-10r"],["type","text","readonly","","id","rLoaRaid","formControlName","loaRaid","placeholder","LoaRaid",1,"form-control-plaintext"],["for","rLoaRaid"],["type","datetime-local","id","rPostTime","formControlName","postTime","placeholder","Post Time",1,"form-control"],["for","rPostTime"],["type","datetime-local","id","rStartTime","formControlName","startTime","placeholder","Start Time",1,"form-control"],["for","rStartTime"],[1,"text-center"],[3,"routerLink"],[1,"d-flex","flex-grow-1","align-items-end","justify-content-center","gap-2"],["type","button",1,"btn","btn-warning","flex-grow-1","mw-15r",3,"click"],["type","submit",1,"btn","btn-success","flex-grow-1","mw-15r",3,"disabled"],[1,"modal-footer","justify-content-between"],["type","button",1,"btn","btn-danger",3,"click"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary",3,"routerLink"],[1,"loaClassImage",3,"title","alt","src"],[1,"flex-grow-1","text-truncate",3,"title"]],template:function(i,o){i&1&&(c(0,"div",0),_(1,zt,92,20),T(2,1,Gt)),i&2&&(s(2),L(o.raidpost))},dependencies:[ue,$,A],styles:[".raid-post-edit[_ngcontent-%COMP%]   .nav-tabs[_ngcontent-%COMP%]{border-color:var(--discord-menu-text)}.raid-post-edit[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{color:var(--discord-content-text)}.raid-post-edit[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover{cursor:pointer;border-color:var(--discord-menu-text)}.raid-post-edit[_ngcontent-%COMP%] > .modal-dialog[_ngcontent-%COMP%] > .modal-content[_ngcontent-%COMP%] > .modal-header[_ngcontent-%COMP%]{padding:1rem 0rem 0rem}.raid-post-edit[_ngcontent-%COMP%] > .modal-dialog[_ngcontent-%COMP%] > .modal-content[_ngcontent-%COMP%] > .modal-header[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{border-color:var(--discord-menu-text);border-bottom-color:transparent;background-color:var(--discord-menu)}.raid-post-edit[_ngcontent-%COMP%]   .form-floating[_ngcontent-%COMP%]   .form-control-plaintext[_ngcontent-%COMP%]{color:var(--discord-menu-text)}._class-image[_ngcontent-%COMP%]{line-height:0;max-height:3rem;opacity:.5}.filter-symbol[_ngcontent-%COMP%]{position:absolute;left:1rem;top:50%;transform:translateY(-50%);font-size:1.75rem;line-height:0}.edit-modal-header-top[_ngcontent-%COMP%]{position:relative;display:flex;flex-flow:row nowrap;align-items:center}.edit-modal-tablist[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;padding-left:1rem;padding-right:1rem;width:100%}.repeat-symbol[_ngcontent-%COMP%]{position:absolute;left:50%;transform:translate(-50%);font-size:2rem;line-height:0;animation:_ngcontent-%COMP%_spin 4s linear infinite}.loaClassImage[_ngcontent-%COMP%]{height:1.5rem}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}"]})}}return t})();var oe=class t extends Ve{static{this.url=`${Ue.loa()}/oauth`}constructor(){super(`${t.url}/url`,`${t.url}/tokens`,`${t.url}/refresh`)}isValid(){return this.http.get(`${t.url}/valid`)}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275prov=Te({token:t,factory:t.\u0275fac,providedIn:"root"})}};var lt=(t,d)=>{let e=v(M),i=v(he),o=v(oe),l=()=>(e.navigate(["/loa-assistant/login"]),d.url,Pe);return i.check("loa-tokens")?o.isValid().pipe(Fe(p=>p||l()),Oe((p,k)=>l())):l()};var Yt=(t,d)=>d.id;function Jt(t,d){if(t&1&&(r(0,"div",3)(1,"h5",1),a(2),n(),r(3,"div",5)(4,"p"),a(5),n()()()),t&2){let e=d.$implicit;s(2),h(e.name),s(3),h(e.statement)}}function Xt(t,d){t&1&&(r(0,"div",4)(1,"h5"),a(2,"No Current Announcements"),n()())}var dt=(()=>{class t{constructor(){this.announcements=[]}ngOnInit(){}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=C({type:t,selectors:[["announcements"]],inputs:{announcements:"announcements"},decls:7,vars:1,consts:[[1,"card","announcements"],[1,"card-header"],[1,"card-body","overflow-y-auto"],[1,"card","announcement"],[1,"text-center"],[1,"card-body"]],template:function(i,o){i&1&&(r(0,"div",0)(1,"h5",1),a(2,"Announcements"),n(),r(3,"div",2),y(4,Jt,6,2,"div",3,Yt,!1,Xt,3,0,"div",4),n()()),i&2&&(s(4),S(o.announcements))},styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;overflow:hidden}.announcements[_ngcontent-%COMP%]{flex:1;overflow:hidden}.announcements[_ngcontent-%COMP%] > .card-body[_ngcontent-%COMP%]{overflow-y:auto}.announcement[_ngcontent-%COMP%] > .card-body[_ngcontent-%COMP%] > p[_ngcontent-%COMP%]{white-space:pre-line}"]})}}return t})();var Kt=(t,d)=>d.id,Qt=()=>[import("./chunk-5N3FTQAW.js").then(t=>t.OrderByPipe),E],ei=t=>["raids",t];function ti(t,d){if(t&1&&c(0,"i"),t&2){let e=f().$implicit,i=f(2);Se("bi-arrow-clockwise repeat-symbol "+i.repeatColor(e))}}function ii(t,d){if(t&1&&(r(0,"div",10),c(1,"div"),r(2,"h5",12)(3,"span",13),a(4),n(),r(5,"span",14),a(6),n()(),r(7,"div",15)(8,"div",16),a(9),n(),_(10,ti,1,2,"i",17),n()()),t&2){let e=d.$implicit,i=f(2);m("routerLink",G(9,ei,e.id)),s(),Se("p-1 rounded "+i.raidColor(e)),s(2),m("title",e.name),s(),h(e.name),s(2),h(e.properties.loaRaid.name),s(2),m("title",i.raidTime(e.properties.startTime)),s(),h(i.raidTime(e.properties.startTime)),s(),H(e.type=="repeatingpost"?10:-1)}}function ri(t,d){t&1&&(r(0,"div",11)(1,"h5"),a(2,"You have no available raids"),n()())}function ni(t,d){if(t&1&&(y(0,ii,11,11,"div",10,Kt,!1,ri,3,0,"div",11),X(3,"orderBy")),t&2){let e=f();S(Z(3,1,e.upcomingRaids,e.sort))}}var ct=(()=>{class t{constructor(e){this.playerService=e,this.raidposts=[],this.subs=[],this.raidTime=ne,this.sort=xe,this.raidFilterForm=new D({raid:new g("Any"),server:new g("Any"),status:new g("Any")})}ngOnInit(){this.player||(this.player=this.playerService.me$())}ngOnDestroy(){for(let e of this.subs)e.unsubscribe()}get upcomingRaids(){let e=[...this.raidposts];for(let[i,o]of Object.entries(this.raidFilterForm.controls))if(o.value!="Any")switch(i){case"raid":e=e.filter(l=>l.properties.loaRaid.name==o.value||o.value==="");break;case"server":e=e.filter(l=>l.server.name==o.value||o.value==="");break;case"status":if(!this.player)break;o.value=="Not Signed Up"?e=e.filter(l=>!l.signups.find(p=>p.player.id==this.player?.id)):o.value=="Signed Up"&&(e=e.filter(l=>l.signups.find(p=>p.player.id==this.player?.id)));break}return e}inRaid(e){if(!this.player)return!1;for(let i of e.signups)if(i.player.id==this.player.id)return!0;return!1}inRepeat(e){if(!this.player)return!1;let i=e;for(let o of i?.repeatingSignups)if(o.player.id==this.player?.id)return!0;return!1}raidColor(e){if(this.player)return this.inRaid(e)?"bg-success":"bg-danger"}repeatColor(e){if(this.player)return this.inRepeat(e)?"text-success":"text-danger"}color(e){for(let i of e.signups)if(i.player.id===this.player?.id)return{"background-color":"yellowgreen"};return{"background-color":"lightcoral"}}static{this.\u0275fac=function(i){return new(i||t)(u(P))}}static{this.\u0275cmp=C({type:t,selectors:[["loa-upcoming-raids"]],inputs:{raidposts:"raidposts",player:"player"},decls:17,vars:2,consts:[[1,"card","loa-upcoming-raids"],[1,"card-header","d-flex"],[1,"m-0"],["id","upcomingRaidsFilter","title","Filter Upcoming Raids","data-bs-toggle","dropdown","data-bs-auto-close","outside","aria-expanded","false",1,"bi-filter","filter-symbol","_color-discord-menu-text"],[1,"dropdown","filter-dropdown"],["aria-labelledby","upcomingRaidsFilter",1,"dropdown-menu","w-20r","raid-filter"],[1,"dropdown-header"],[1,"raid-filter",3,"filterForm"],[1,"upcoming-raid-list","card-body","d-flex","flex-column","gap-2"],[1,"d-flex","gap-2"],[1,"card","loa-upcoming-raid",3,"routerLink"],[1,"text-center"],[1,"card-subtitle","d-flex","flex-nowrap","justify-content-between"],[1,"text-nowrap","text-truncate",3,"title"],[1,"fs-6","align-self-end","text-nowrap"],[1,"d-flex","flex-nowrap","justify-content-between"],[1,"fs-6","text-truncate",3,"title"],[3,"class"]],template:function(i,o){i&1&&(r(0,"div",0)(1,"div",1)(2,"h5",2),a(3,"Upcoming Raids"),n(),c(4,"i",3),r(5,"div",4)(6,"ul",5)(7,"li")(8,"h6",6),a(9,"Filter Raids"),n()(),r(10,"li"),c(11,"raid-filter",7),n()()()(),r(12,"div",8),_(13,ni,4,4),T(14,13,Qt),n(),c(16,"div",9),n()),i&2&&(s(11),m("filterForm",o.raidFilterForm),s(3),L(o.raidposts))},dependencies:[$,be],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;overflow:hidden}.upcoming-raid-list[_ngcontent-%COMP%]::-webkit-scrollbar{width:10px}.upcoming-raid-list[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent;margin:0}.upcoming-raid-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#888;background:var(--discord-menu-text);border-radius:3px}.upcoming-raid-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#555}.loa-upcoming-raids[_ngcontent-%COMP%]{flex:1;position:relative;overflow:hidden}.loa-upcoming-raids[_ngcontent-%COMP%] > .card-body[_ngcontent-%COMP%]{overflow-y:auto}.loa-upcoming-raid[_ngcontent-%COMP%]{position:relative;display:flex;flex-flow:column;gap:.5rem;padding:.5rem!important;color:var(--discord-content-text);border-radius:3px!important;background-color:var(--discord-content)}.loa-upcoming-raid[_ngcontent-%COMP%]:hover{cursor:pointer;scale:1.01;border:1px solid var(--discord-content-text);border-radius:3px}.filter-symbol[_ngcontent-%COMP%]{position:absolute;font-size:1.75rem;top:.45rem;right:.5rem;line-height:0}.filter-symbol[_ngcontent-%COMP%]:hover{cursor:pointer;scale:1.1}.repeat-symbol[_ngcontent-%COMP%]{font-size:1.5rem;align-self:center;line-height:0;animation:_ngcontent-%COMP%_spin 4s linear infinite}.raid-filter[_ngcontent-%COMP%]{background-color:var(--discord-menu)}.filter-dropdown[_ngcontent-%COMP%]{list-style-type:none!important}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}"]})}}return t})();var mt=(t,d)=>d.id,oi=()=>[E,import("./chunk-5N3FTQAW.js").then(t=>t.OrderByPipe),import("./chunk-PT4XS6NT.js").then(t=>t.LoaCharacterComponent)],ai=()=>[E,import("./chunk-5N3FTQAW.js").then(t=>t.OrderByPipe),import("./chunk-ZACHAMWK.js").then(t=>t.RaidPostComponent)],si=()=>["characters/add"],li=()=>["raids/add"],di=t=>["characters",t],ci=t=>["raids",t];function mi(t,d){if(t&1&&c(0,"loa-character",19),t&2){let e=d.$implicit;m("character",e)("routerLink",G(2,di,e.id))}}function pi(t,d){t&1&&(r(0,"div",20)(1,"h5"),a(2,"You have no characters"),n()())}function ui(t,d){if(t&1&&(r(0,"div",18),y(1,mi,1,4,"loa-character",19,mt,!1,pi,3,0,"div",20),X(4,"orderBy"),n()),t&2){let e=f();s(),S(Z(4,1,e.characters(),e.sortC))}}function fi(t,d){if(t&1&&c(0,"raid-post",21),t&2){let e=d.$implicit,i=f(2);m("raidpost",e)("player",i.player())("routerLink",G(3,ci,e.id))}}function hi(t,d){if(t&1&&(r(0,"div",20)(1,"h5"),a(2),n()()),t&2){let e=f(2);s(2),Ge("You have no available ",e.raids.length>0?"filtered":""," raids")}}function gi(t,d){if(t&1&&(r(0,"div",18),y(1,fi,1,5,"raid-post",21,mt,!1,hi,3,1,"div",20),X(4,"orderBy"),n()),t&2){let e=f();s(),S(Z(4,1,e.filteredRaids,e.sortRaids))}}var pt=(()=>{class t{sortC(e,i){return e.itemlevel-i.itemlevel}constructor(e,i,o,l,p){this.router=e,this.meService=i,this.characterService=o,this.raidService=l,this.toastService=p,this.colors=qe,this.testr=null,this.raidTime=ne,this.sortRaids=xe,this.subs=[],this.player=this.meService.me$,this.characters=this.meService.myCharacters$,this.servers=this.meService.myServers$,this.raids=this.meService.myRaids$,this.repeats=this.meService.myRepeats$,this.raidFilterForm=new D({raid:new g("Any"),server:new g("Any"),status:new g("Any")})}ngOnInit(){var e=this.characterService.characterChanges$.subscribe(l=>{let p=l?.character,k=l?.change;if(p==null)return;let w=this.characters();switch(k){case"add":w.push(p);break;case"edit":let ae=w.find(se=>se.id==p.id);ae!=null&&Object.assign(ae,p);break;case"delete":let ce=w.findIndex(se=>se.id==p.id);ce>-1&&w.splice(ce,1);break;case"signup":console.log("Signup");break}}),i=this.characterService.signupChanges$.subscribe(l=>{l.forEach(p=>{var k=this.raids().find(w=>w.id==p.id);if(k!=null&&k!==p){if(k.type=="repeatingpost"){let w=k,ae=p;w.repeatingSignups.length=0,Object.assign(w.repeatingSignups,ae.repeatingSignups)}k.signups.length=0,Object.assign(k.signups,p.signups)}})}),o=this.raidService.raidChanges$.subscribe(l=>{let p=l?.raidpost,k=l?.change;if(p==null)return;let w=this.raids();switch(k){case"add":w.push(p);break;case"edit":let ae=w.find(se=>se.id==p.id);ae!=null&&Object.assign(ae,p);break;case"delete":let ce=w.findIndex(se=>se.id==p.id);ce>-1&&w.splice(ce,1);break;case"signup":console.log("Signup");break}});this.subs.push(e,i,o)}ngOnDestroy(){for(let e of this.subs)e.unsubscribe();clearTimeout(this.expirationTimeout)}get filteredRaids(){let e=[...this.raids()];for(let[i,o]of Object.entries(this.raidFilterForm.controls))if(o.value!="Any")switch(i){case"raid":e=e.filter(l=>l.properties.loaRaid.name==o.value||o.value==="");break;case"server":e=e.filter(l=>l.server.name==o.value||o.value==="");break;case"status":if(!this.player)break;o.value=="Not Signed Up"?e=e.filter(l=>!l.signups.find(p=>p.player.id==this.player()?.id)):o.value=="Signed Up"&&(e=e.filter(l=>l.signups.find(p=>p.player.id==this.player()?.id)));break}return e}logout(){let e=this.player();e&&this.meService.logout(e).subscribe({next:i=>{i?this.router.navigate(["loa-assistant/login"]):this.toastService.show({header:"Error",body:"Failed to logout. Please try again.",type:"danger",source_feature:"loa-assistant",delay:7500})},error:i=>{console.log(i),this.toastService.show({header:"Error",body:"Failed to logout. Please try again.",type:"danger",source_feature:"loa-assistant",delay:7500})}})}static{this.\u0275fac=function(i){return new(i||t)(u(M),u(P),u(B),u(N),u(U))}}static{this.\u0275cmp=C({type:t,selectors:[["loa-home"]],decls:35,vars:13,consts:[[1,"d-flex","justify-content-between","_color-discord-menu-text"],[1,"logout-button",3,"click"],[1,"container-xxl","d-flex","flex-column","gap-5","pb-5","loa-home"],[1,"row","g-3r","g-2","_minh-20r"],[1,"col-12","col-lg-8","mh-25r","_minh-10r"],[1,"col-12","col-lg-4","mh-25r","_minh-10r",3,"raidposts","player"],[1,"d-flex","gap-3"],["text","Characters","type","h4",1,"flex-grow-1",3,"color","lc"],["type","button","title","Add Character","routerLinkActive","router-link-active",1,"btn","btn-sm","btn-secondary","h-50","align-self-center",3,"routerLink"],[1,"bi-plus-lg"],["text","Raids","type","h4",1,"flex-grow-1",3,"color","lc"],["type","button","title","Add Raid Post","routerLinkActive","router-link-active",1,"btn","btn-sm","btn-secondary","h-50","align-self-center",3,"routerLink"],["id","raidsFilter","type","button","title","Filter Raids","data-bs-toggle","dropdown","data-bs-auto-close","outside","aria-expanded","false",1,"btn","btn-sm","btn-secondary","h-50","align-self-center","filter-button"],[1,"bi-filter","filter-symbol"],[1,"dropdown","filter-dropdown"],["aria-labelledby","raidsFilter",1,"dropdown-menu","w-20r","raid-filter"],[1,"dropdown-header"],[1,"raid-filter",3,"filterForm"],[1,"d-flex","flex","flex-wrap","gap-3","justify-content-center"],[3,"character","routerLink"],[1,"text-center","_color-discord-content-text"],[3,"raidpost","player","routerLink"]],template:function(i,o){i&1&&(r(0,"div",0)(1,"span"),a(2,"Loa Assistant Home"),n(),r(3,"a",1),x("click",function(){return o.logout()}),a(4,"Log Out"),n()(),r(5,"div",2)(6,"section",3),c(7,"announcements",4)(8,"loa-upcoming-raids",5),n(),r(9,"section")(10,"div",6),c(11,"my-header",7),r(12,"button",8),c(13,"i",9),n()(),_(14,ui,5,4),T(15,14,oi),n(),r(17,"section")(18,"div",6),c(19,"my-header",10),r(20,"button",11),c(21,"i",9),n(),r(22,"button",12),c(23,"i",13),n(),r(24,"div",14)(25,"ul",15)(26,"li")(27,"h6",16),a(28,"Filter Raids"),n()(),r(29,"li"),c(30,"raid-filter",17),n()()()(),_(31,gi,5,4),T(32,31,ai),n()(),c(34,"router-outlet")),i&2&&(s(8),m("raidposts",o.raids())("player",o.player()),s(3),m("color",o.colors.discordContenttext)("lc",o.colors.discordMenuText),s(),m("routerLink",R(11,si)),s(3),L(o.characters),s(4),m("color",o.colors.discordContenttext)("lc",o.colors.discordMenuText),s(),m("routerLink",R(12,li)),s(10),m("filterForm",o.raidFilterForm),s(2),L(o.raids))},dependencies:[E,fe,A,We,be,ct,dt],styles:["loa-character[_ngcontent-%COMP%], raid-post[_ngcontent-%COMP%]{border:1px solid transparent}loa-character[_ngcontent-%COMP%]:hover, raid-post[_ngcontent-%COMP%]:hover{cursor:pointer;scale:1.05;border:1px solid var(--discord-content-text);border-radius:3px}.loa-home[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:transparent!important}.raid-filter[_ngcontent-%COMP%]{background-color:var(--discord-menu)}.filter-dropdown[_ngcontent-%COMP%]{list-style-type:none!important}.logout-button[_ngcontent-%COMP%]:hover{cursor:pointer}"]})}}return t})();var ut=(()=>{class t{constructor(){this.meService=v(P),this.characterService=v(B),this.raidService=v(N)}ngOnInit(){}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=C({type:t,selectors:[["loa-index"]],decls:1,vars:0,template:function(i,o){i&1&&c(0,"router-outlet")},dependencies:[$,fe],encapsulation:2})}}return t})();var ft=(()=>{class t{constructor(e,i,o,l){this.loaLogin=e,this.router=i,this.route=o,this.cookies=l,this.returnTo=o.snapshot.queryParams.returnTo;let p=e.tokensRecieved$.subscribe(k=>{p.unsubscribe(),l.set("loa-tokens",JSON.stringify(k)),this.redirect()})}ngOnInit(){}login(){this.loaLogin.login()}redirect(){this.returnTo?this.router.navigateByUrl(this.returnTo):this.router.navigate(["/loa-assistant/home"])}static{this.\u0275fac=function(i){return new(i||t)(u(oe),u(M),u(I),u(he))}}static{this.\u0275cmp=C({type:t,selectors:[["loa-login-page"]],decls:47,vars:0,consts:[[1,"text-center","_color-discord-content-text","pt-3"],[1,"_color-discord-menu-text","text-center","p-0","fs-5"],["href","https://discord.gg/ay7dvJFnwF"],[1,"text-center","p-5"],[1,"btn","btn-primary","btn-lg",3,"click"],[1,"_color-discord-menu-text"]],template:function(i,o){i&1&&(r(0,"div",0)(1,"h4"),a(2,"LoA Assistant"),n()(),r(3,"div")(4,"p",1),a(5," Demo Server: "),c(6,"br"),r(7,"a",2),a(8,"Join Demo Server"),n(),c(9,"br"),a(10," Join the Demo Server using a Discord account first, then login via Discord. "),c(11,"br"),a(12," (Unfortunately I cannot have a Demo Discord account as it requires email verification on logins from new locations) "),c(13,"br"),a(14," (Changes Reset Daily @ 07:00 UTC) "),n()(),r(15,"div",3)(16,"button",4),x("click",function(){return o.login()}),a(17,"Login via Discord"),n()(),r(18,"div")(19,"section",5),a(20," This application uses Discord as a means to identify and notify users. LoA-Assistant is a project made to assist in organizing raids for LostArk communities on Discord. "),c(21,"br"),r(22,"i"),a(23,"In order to make proper use of this application, both the User and application's Discord bot must be within the same Discord server."),n(),c(24,"br")(25,"br"),r(26,"b"),a(27,"Characters"),n(),c(28,"br"),r(29,"p"),a(30," Users may enter and update their LostArk character's information through the website or discord bot, including their name, class, and item level. These characters are used when a user wishes to sign up for a raid post. "),n(),c(31,"br")(32,"br"),r(33,"b"),a(34,"Raid Posts"),n(),c(35,"br"),r(36,"p"),a(37," Post managers, members of the Discord servers with a "),r(38,"u"),a(39,"specified role"),n(),a(40,", may create and edit posts for scheduling a LostArk raid. Each post will list the raid to be attempted as well as the starting time. Other members of the server can will be able to signup for the raid's post with the characters they entered into the application. "),n(),r(41,"p"),a(42," By default the application will automatically form groups consisting of one or more parties for the raid as characters are signed up. If there are enough characters then multiple groups may be formed. These groups are tenative and the characters that are assigned may change as the list of signups changes. "),r(43,"u"),a(44,"Alternatively"),n(),a(45,", managers may manually create the groups for these raids through the website. "),n(),a(46," When it time for the raid to start, if there are ample singups, the discord bot will @mention the participating users, and list the groups for the raid. "),n()())},styles:[".btn-container[_ngcontent-%COMP%]{text-align:center;margin:auto;padding:5rem 0rem}.login-btn[_ngcontent-%COMP%]{border-radius:.5rem}"]})}}return t})();function vi(t,d){t&1&&(r(0,"div"),a(1,"Awaiting Token Response..."),n())}function bi(t,d){t&1&&(r(0,"div"),a(1,"Tokens Recieved"),n())}function xi(t,d){t&1&&(r(0,"div"),a(1,"Failed to retrieve tokens"),n())}var ht=(()=>{class t{constructor(e,i){this.logLogin=e,this.route=i,this.succesfulTokenExchange=0}ngOnInit(){let e=this.route.snapshot.queryParams,i=e.code,o=e.state;i&&o&&this.logLogin.getTokens$(i).subscribe({next:l=>{window.opener.postMessage(l),this.succesfulTokenExchange=1,console.log(l),window.close()},error:()=>{this.succesfulTokenExchange=-1}})}static{this.\u0275fac=function(i){return new(i||t)(u(oe),u(I))}}static{this.\u0275cmp=C({type:t,selectors:[["loa-on-login"]],decls:4,vars:1,consts:[[1,"on-login"]],template:function(i,o){if(i&1&&(r(0,"div",0),_(1,vi,2,0,"div")(2,bi,2,0,"div")(3,xi,2,0,"div"),n()),i&2){let l;s(),H((l=o.succesfulTokenExchange)===0?1:l===1?2:l===-1?3:-1)}},styles:[".on-login[_ngcontent-%COMP%]{margin:5rem;padding:1rem;color:#c8c8c8}"]})}}return t})();var Ci=[{path:"characters/add",component:Ze},{path:"characters/:id",component:Qe},{path:"raids/add",component:nt},{path:"raids/:id",component:at}],_i=[{path:"home",component:pt,loadChildren:()=>Ci},{path:"raids/:id/edit/groups",component:tt},{path:"**",redirectTo:"home",pathMatch:"full"}],Mn=[{path:"login",component:ft},{path:"on-login",component:ht},{path:"",component:ut,loadChildren:()=>_i,canActivate:[lt]}];export{_i as contentRoutes,Ci as homeRoutes,Mn as loaRoutes};
